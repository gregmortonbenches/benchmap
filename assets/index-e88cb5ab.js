(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var Ew=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Iw={exports:{}},fd={},Pw={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ol=Symbol.for("react.element"),Y1=Symbol.for("react.portal"),X1=Symbol.for("react.fragment"),J1=Symbol.for("react.strict_mode"),tP=Symbol.for("react.profiler"),eP=Symbol.for("react.provider"),nP=Symbol.for("react.context"),iP=Symbol.for("react.forward_ref"),rP=Symbol.for("react.suspense"),sP=Symbol.for("react.memo"),oP=Symbol.for("react.lazy"),Fg=Symbol.iterator;function aP(n){return n===null||typeof n!="object"?null:(n=Fg&&n[Fg]||n["@@iterator"],typeof n=="function"?n:null)}var Sw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Aw=Object.assign,xw={};function Ea(n,t,e){this.props=n,this.context=t,this.refs=xw,this.updater=e||Sw}Ea.prototype.isReactComponent={};Ea.prototype.setState=function(n,t){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,t,"setState")};Ea.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Cw(){}Cw.prototype=Ea.prototype;function fm(n,t,e){this.props=n,this.context=t,this.refs=xw,this.updater=e||Sw}var pm=fm.prototype=new Cw;pm.constructor=fm;Aw(pm,Ea.prototype);pm.isPureReactComponent=!0;var Bg=Array.isArray,Rw=Object.prototype.hasOwnProperty,mm={current:null},Lw={key:!0,ref:!0,__self:!0,__source:!0};function kw(n,t,e){var i,r={},s=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Rw.call(t,i)&&!Lw.hasOwnProperty(i)&&(r[i]=t[i]);var l=arguments.length-2;if(l===1)r.children=e;else if(1<l){for(var h=Array(l),f=0;f<l;f++)h[f]=arguments[f+2];r.children=h}if(n&&n.defaultProps)for(i in l=n.defaultProps,l)r[i]===void 0&&(r[i]=l[i]);return{$$typeof:Ol,type:n,key:s,ref:a,props:r,_owner:mm.current}}function uP(n,t){return{$$typeof:Ol,type:n.type,key:t,ref:n.ref,props:n.props,_owner:n._owner}}function _m(n){return typeof n=="object"&&n!==null&&n.$$typeof===Ol}function lP(n){var t={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(e){return t[e]})}var zg=/\/+/g;function lf(n,t){return typeof n=="object"&&n!==null&&n.key!=null?lP(""+n.key):t.toString(36)}function oh(n,t,e,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case Ol:case Y1:a=!0}}if(a)return a=n,r=r(a),n=i===""?"."+lf(a,0):i,Bg(r)?(e="",n!=null&&(e=n.replace(zg,"$&/")+"/"),oh(r,t,e,"",function(f){return f})):r!=null&&(_m(r)&&(r=uP(r,e+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(zg,"$&/")+"/")+n)),t.push(r)),1;if(a=0,i=i===""?".":i+":",Bg(n))for(var l=0;l<n.length;l++){s=n[l];var h=i+lf(s,l);a+=oh(s,t,e,h,r)}else if(h=aP(n),typeof h=="function")for(n=h.call(n),l=0;!(s=n.next()).done;)s=s.value,h=i+lf(s,l++),a+=oh(s,t,e,h,r);else if(s==="object")throw t=String(n),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Nc(n,t,e){if(n==null)return n;var i=[],r=0;return oh(n,i,"","",function(s){return t.call(e,s,r++)}),i}function cP(n){if(n._status===-1){var t=n._result;t=t(),t.then(function(e){(n._status===0||n._status===-1)&&(n._status=1,n._result=e)},function(e){(n._status===0||n._status===-1)&&(n._status=2,n._result=e)}),n._status===-1&&(n._status=0,n._result=t)}if(n._status===1)return n._result.default;throw n._result}var sn={current:null},ah={transition:null},hP={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:ah,ReactCurrentOwner:mm};function bw(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:Nc,forEach:function(n,t,e){Nc(n,function(){t.apply(this,arguments)},e)},count:function(n){var t=0;return Nc(n,function(){t++}),t},toArray:function(n){return Nc(n,function(t){return t})||[]},only:function(n){if(!_m(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};It.Component=Ea;It.Fragment=X1;It.Profiler=tP;It.PureComponent=fm;It.StrictMode=J1;It.Suspense=rP;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hP;It.act=bw;It.cloneElement=function(n,t,e){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=Aw({},n.props),r=n.key,s=n.ref,a=n._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=mm.current),t.key!==void 0&&(r=""+t.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(h in t)Rw.call(t,h)&&!Lw.hasOwnProperty(h)&&(i[h]=t[h]===void 0&&l!==void 0?l[h]:t[h])}var h=arguments.length-2;if(h===1)i.children=e;else if(1<h){l=Array(h);for(var f=0;f<h;f++)l[f]=arguments[f+2];i.children=l}return{$$typeof:Ol,type:n.type,key:r,ref:s,props:i,_owner:a}};It.createContext=function(n){return n={$$typeof:nP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:eP,_context:n},n.Consumer=n};It.createElement=kw;It.createFactory=function(n){var t=kw.bind(null,n);return t.type=n,t};It.createRef=function(){return{current:null}};It.forwardRef=function(n){return{$$typeof:iP,render:n}};It.isValidElement=_m;It.lazy=function(n){return{$$typeof:oP,_payload:{_status:-1,_result:n},_init:cP}};It.memo=function(n,t){return{$$typeof:sP,type:n,compare:t===void 0?null:t}};It.startTransition=function(n){var t=ah.transition;ah.transition={};try{n()}finally{ah.transition=t}};It.unstable_act=bw;It.useCallback=function(n,t){return sn.current.useCallback(n,t)};It.useContext=function(n){return sn.current.useContext(n)};It.useDebugValue=function(){};It.useDeferredValue=function(n){return sn.current.useDeferredValue(n)};It.useEffect=function(n,t){return sn.current.useEffect(n,t)};It.useId=function(){return sn.current.useId()};It.useImperativeHandle=function(n,t,e){return sn.current.useImperativeHandle(n,t,e)};It.useInsertionEffect=function(n,t){return sn.current.useInsertionEffect(n,t)};It.useLayoutEffect=function(n,t){return sn.current.useLayoutEffect(n,t)};It.useMemo=function(n,t){return sn.current.useMemo(n,t)};It.useReducer=function(n,t,e){return sn.current.useReducer(n,t,e)};It.useRef=function(n){return sn.current.useRef(n)};It.useState=function(n){return sn.current.useState(n)};It.useSyncExternalStore=function(n,t,e){return sn.current.useSyncExternalStore(n,t,e)};It.useTransition=function(){return sn.current.useTransition()};It.version="18.3.1";Pw.exports=It;var Vi=Pw.exports;const dP=Tw(Vi);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fP=Vi,pP=Symbol.for("react.element"),mP=Symbol.for("react.fragment"),_P=Object.prototype.hasOwnProperty,gP=fP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yP={key:!0,ref:!0,__self:!0,__source:!0};function Dw(n,t,e){var i,r={},s=null,a=null;e!==void 0&&(s=""+e),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)_P.call(t,i)&&!yP.hasOwnProperty(i)&&(r[i]=t[i]);if(n&&n.defaultProps)for(i in t=n.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:pP,type:n,key:s,ref:a,props:r,_owner:gP.current}}fd.Fragment=mP;fd.jsx=Dw;fd.jsxs=Dw;Iw.exports=fd;var Ni=Iw.exports,Wf={},Vw={exports:{}},Pn={},Mw={exports:{}},Nw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function t(W,lt){var J=W.length;W.push(lt);t:for(;0<J;){var ct=J-1>>>1,dt=W[ct];if(0<r(dt,lt))W[ct]=lt,W[J]=dt,J=ct;else break t}}function e(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var lt=W[0],J=W.pop();if(J!==lt){W[0]=J;t:for(var ct=0,dt=W.length,vt=dt>>>1;ct<vt;){var bt=2*(ct+1)-1,wt=W[bt],pt=bt+1,de=W[pt];if(0>r(wt,J))pt<dt&&0>r(de,wt)?(W[ct]=de,W[pt]=J,ct=pt):(W[ct]=wt,W[bt]=J,ct=bt);else if(pt<dt&&0>r(de,J))W[ct]=de,W[pt]=J,ct=pt;else break t}}return lt}function r(W,lt){var J=W.sortIndex-lt.sortIndex;return J!==0?J:W.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var h=[],f=[],_=1,g=null,w=3,E=!1,x=!1,R=!1,z=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(W){for(var lt=e(f);lt!==null;){if(lt.callback===null)i(f);else if(lt.startTime<=W)i(f),lt.sortIndex=lt.expirationTime,t(h,lt);else break;lt=e(f)}}function j(W){if(R=!1,C(W),!x)if(e(h)!==null)x=!0,re(H);else{var lt=e(f);lt!==null&&Se(j,lt.startTime-W)}}function H(W,lt){x=!1,R&&(R=!1,A(P),P=-1),E=!0;var J=w;try{for(C(lt),g=e(h);g!==null&&(!(g.expirationTime>lt)||W&&!N());){var ct=g.callback;if(typeof ct=="function"){g.callback=null,w=g.priorityLevel;var dt=ct(g.expirationTime<=lt);lt=n.unstable_now(),typeof dt=="function"?g.callback=dt:g===e(h)&&i(h),C(lt)}else i(h);g=e(h)}if(g!==null)var vt=!0;else{var bt=e(f);bt!==null&&Se(j,bt.startTime-lt),vt=!1}return vt}finally{g=null,w=J,E=!1}}var Y=!1,k=null,P=-1,b=5,V=-1;function N(){return!(n.unstable_now()-V<b)}function O(){if(k!==null){var W=n.unstable_now();V=W;var lt=!0;try{lt=k(!0,W)}finally{lt?D():(Y=!1,k=null)}}else Y=!1}var D;if(typeof S=="function")D=function(){S(O)};else if(typeof MessageChannel<"u"){var Ft=new MessageChannel,An=Ft.port2;Ft.port1.onmessage=O,D=function(){An.postMessage(null)}}else D=function(){z(O,0)};function re(W){k=W,Y||(Y=!0,D())}function Se(W,lt){P=z(function(){W(n.unstable_now())},lt)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){x||E||(x=!0,re(H))},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_getFirstCallbackNode=function(){return e(h)},n.unstable_next=function(W){switch(w){case 1:case 2:case 3:var lt=3;break;default:lt=w}var J=w;w=lt;try{return W()}finally{w=J}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,lt){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var J=w;w=W;try{return lt()}finally{w=J}},n.unstable_scheduleCallback=function(W,lt,J){var ct=n.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ct+J:ct):J=ct,W){case 1:var dt=-1;break;case 2:dt=250;break;case 5:dt=1073741823;break;case 4:dt=1e4;break;default:dt=5e3}return dt=J+dt,W={id:_++,callback:lt,priorityLevel:W,startTime:J,expirationTime:dt,sortIndex:-1},J>ct?(W.sortIndex=J,t(f,W),e(h)===null&&W===e(f)&&(R?(A(P),P=-1):R=!0,Se(j,J-ct))):(W.sortIndex=dt,t(h,W),x||E||(x=!0,re(H))),W},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(W){var lt=w;return function(){var J=w;w=lt;try{return W.apply(this,arguments)}finally{w=J}}}})(Nw);Mw.exports=Nw;var vP=Mw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wP=Vi,Tn=vP;function X(n){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+n,e=1;e<arguments.length;e++)t+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+n+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ow=new Set,el={};function Gs(n,t){Xo(n,t),Xo(n+"Capture",t)}function Xo(n,t){for(el[n]=t,n=0;n<t.length;n++)Ow.add(t[n])}var ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hf=Object.prototype.hasOwnProperty,EP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ug={},jg={};function TP(n){return Hf.call(jg,n)?!0:Hf.call(Ug,n)?!1:EP.test(n)?jg[n]=!0:(Ug[n]=!0,!1)}function IP(n,t,e,i){if(e!==null&&e.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:e!==null?!e.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function PP(n,t,e,i){if(t===null||typeof t>"u"||IP(n,t,e,i))return!0;if(i)return!1;if(e!==null)switch(e.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function on(n,t,e,i,r,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=e,this.propertyName=n,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ze[n]=new on(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var t=n[0];ze[t]=new on(t,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ze[n]=new on(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ze[n]=new on(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ze[n]=new on(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ze[n]=new on(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ze[n]=new on(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ze[n]=new on(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ze[n]=new on(n,5,!1,n.toLowerCase(),null,!1,!1)});var gm=/[\-:]([a-z])/g;function ym(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var t=n.replace(gm,ym);ze[t]=new on(t,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var t=n.replace(gm,ym);ze[t]=new on(t,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var t=n.replace(gm,ym);ze[t]=new on(t,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ze[n]=new on(n,1,!1,n.toLowerCase(),null,!1,!1)});ze.xlinkHref=new on("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ze[n]=new on(n,1,!1,n.toLowerCase(),null,!0,!0)});function vm(n,t,e,i){var r=ze.hasOwnProperty(t)?ze[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(PP(t,e,r,i)&&(e=null),i||r===null?TP(t)&&(e===null?n.removeAttribute(t):n.setAttribute(t,""+e)):r.mustUseProperty?n[r.propertyName]=e===null?r.type===3?!1:"":e:(t=r.attributeName,i=r.attributeNamespace,e===null?n.removeAttribute(t):(r=r.type,e=r===3||r===4&&e===!0?"":""+e,i?n.setAttributeNS(i,t,e):n.setAttribute(t,e))))}var Zi=wP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oc=Symbol.for("react.element"),bo=Symbol.for("react.portal"),Do=Symbol.for("react.fragment"),wm=Symbol.for("react.strict_mode"),Kf=Symbol.for("react.profiler"),Fw=Symbol.for("react.provider"),Bw=Symbol.for("react.context"),Em=Symbol.for("react.forward_ref"),Zf=Symbol.for("react.suspense"),Qf=Symbol.for("react.suspense_list"),Tm=Symbol.for("react.memo"),_r=Symbol.for("react.lazy"),zw=Symbol.for("react.offscreen"),$g=Symbol.iterator;function vu(n){return n===null||typeof n!="object"?null:(n=$g&&n[$g]||n["@@iterator"],typeof n=="function"?n:null)}var ie=Object.assign,cf;function bu(n){if(cf===void 0)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);cf=t&&t[1]||""}return`
`+cf+n}var hf=!1;function df(n,t){if(!n||hf)return"";hf=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var i=f}Reflect.construct(n,[],t)}else{try{t.call()}catch(f){i=f}n.call(t.prototype)}else{try{throw Error()}catch(f){i=f}n()}}catch(f){if(f&&i&&typeof f.stack=="string"){for(var r=f.stack.split(`
`),s=i.stack.split(`
`),a=r.length-1,l=s.length-1;1<=a&&0<=l&&r[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(r[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||r[a]!==s[l]){var h=`
`+r[a].replace(" at new "," at ");return n.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",n.displayName)),h}while(1<=a&&0<=l);break}}}finally{hf=!1,Error.prepareStackTrace=e}return(n=n?n.displayName||n.name:"")?bu(n):""}function SP(n){switch(n.tag){case 5:return bu(n.type);case 16:return bu("Lazy");case 13:return bu("Suspense");case 19:return bu("SuspenseList");case 0:case 2:case 15:return n=df(n.type,!1),n;case 11:return n=df(n.type.render,!1),n;case 1:return n=df(n.type,!0),n;default:return""}}function Yf(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Do:return"Fragment";case bo:return"Portal";case Kf:return"Profiler";case wm:return"StrictMode";case Zf:return"Suspense";case Qf:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Bw:return(n.displayName||"Context")+".Consumer";case Fw:return(n._context.displayName||"Context")+".Provider";case Em:var t=n.render;return n=n.displayName,n||(n=t.displayName||t.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Tm:return t=n.displayName||null,t!==null?t:Yf(n.type)||"Memo";case _r:t=n._payload,n=n._init;try{return Yf(n(t))}catch{}}return null}function AP(n){var t=n.type;switch(n.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=t.render,n=n.displayName||n.name||"",t.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yf(t);case 8:return t===wm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Mr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Uw(n){var t=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xP(n){var t=Uw(n)?"checked":"value",e=Object.getOwnPropertyDescriptor(n.constructor.prototype,t),i=""+n[t];if(!n.hasOwnProperty(t)&&typeof e<"u"&&typeof e.get=="function"&&typeof e.set=="function"){var r=e.get,s=e.set;return Object.defineProperty(n,t,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(n,t,{enumerable:e.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){n._valueTracker=null,delete n[t]}}}}function Fc(n){n._valueTracker||(n._valueTracker=xP(n))}function jw(n){if(!n)return!1;var t=n._valueTracker;if(!t)return!0;var e=t.getValue(),i="";return n&&(i=Uw(n)?n.checked?"true":"false":n.value),n=i,n!==e?(t.setValue(n),!0):!1}function Ah(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Xf(n,t){var e=t.checked;return ie({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:e??n._wrapperState.initialChecked})}function qg(n,t){var e=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;e=Mr(t.value!=null?t.value:e),n._wrapperState={initialChecked:i,initialValue:e,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $w(n,t){t=t.checked,t!=null&&vm(n,"checked",t,!1)}function Jf(n,t){$w(n,t);var e=Mr(t.value),i=t.type;if(e!=null)i==="number"?(e===0&&n.value===""||n.value!=e)&&(n.value=""+e):n.value!==""+e&&(n.value=""+e);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}t.hasOwnProperty("value")?tp(n,t.type,e):t.hasOwnProperty("defaultValue")&&tp(n,t.type,Mr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(n.defaultChecked=!!t.defaultChecked)}function Gg(n,t,e){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+n._wrapperState.initialValue,e||t===n.value||(n.value=t),n.defaultValue=t}e=n.name,e!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,e!==""&&(n.name=e)}function tp(n,t,e){(t!=="number"||Ah(n.ownerDocument)!==n)&&(e==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+e&&(n.defaultValue=""+e))}var Du=Array.isArray;function qo(n,t,e,i){if(n=n.options,t){t={};for(var r=0;r<e.length;r++)t["$"+e[r]]=!0;for(e=0;e<n.length;e++)r=t.hasOwnProperty("$"+n[e].value),n[e].selected!==r&&(n[e].selected=r),r&&i&&(n[e].defaultSelected=!0)}else{for(e=""+Mr(e),t=null,r=0;r<n.length;r++){if(n[r].value===e){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}t!==null||n[r].disabled||(t=n[r])}t!==null&&(t.selected=!0)}}function ep(n,t){if(t.dangerouslySetInnerHTML!=null)throw Error(X(91));return ie({},t,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Wg(n,t){var e=t.value;if(e==null){if(e=t.children,t=t.defaultValue,e!=null){if(t!=null)throw Error(X(92));if(Du(e)){if(1<e.length)throw Error(X(93));e=e[0]}t=e}t==null&&(t=""),e=t}n._wrapperState={initialValue:Mr(e)}}function qw(n,t){var e=Mr(t.value),i=Mr(t.defaultValue);e!=null&&(e=""+e,e!==n.value&&(n.value=e),t.defaultValue==null&&n.defaultValue!==e&&(n.defaultValue=e)),i!=null&&(n.defaultValue=""+i)}function Hg(n){var t=n.textContent;t===n._wrapperState.initialValue&&t!==""&&t!==null&&(n.value=t)}function Gw(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function np(n,t){return n==null||n==="http://www.w3.org/1999/xhtml"?Gw(t):n==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Bc,Ww=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,e,i,r){MSApp.execUnsafeLocalFunction(function(){return n(t,e,i,r)})}:n}(function(n,t){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=t;else{for(Bc=Bc||document.createElement("div"),Bc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Bc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;t.firstChild;)n.appendChild(t.firstChild)}});function nl(n,t){if(t){var e=n.firstChild;if(e&&e===n.lastChild&&e.nodeType===3){e.nodeValue=t;return}}n.textContent=t}var zu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CP=["Webkit","ms","Moz","O"];Object.keys(zu).forEach(function(n){CP.forEach(function(t){t=t+n.charAt(0).toUpperCase()+n.substring(1),zu[t]=zu[n]})});function Hw(n,t,e){return t==null||typeof t=="boolean"||t===""?"":e||typeof t!="number"||t===0||zu.hasOwnProperty(n)&&zu[n]?(""+t).trim():t+"px"}function Kw(n,t){n=n.style;for(var e in t)if(t.hasOwnProperty(e)){var i=e.indexOf("--")===0,r=Hw(e,t[e],i);e==="float"&&(e="cssFloat"),i?n.setProperty(e,r):n[e]=r}}var RP=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ip(n,t){if(t){if(RP[n]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(X(137,n));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(X(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(X(61))}if(t.style!=null&&typeof t.style!="object")throw Error(X(62))}}function rp(n,t){if(n.indexOf("-")===-1)return typeof t.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sp=null;function Im(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var op=null,Go=null,Wo=null;function Kg(n){if(n=zl(n)){if(typeof op!="function")throw Error(X(280));var t=n.stateNode;t&&(t=yd(t),op(n.stateNode,n.type,t))}}function Zw(n){Go?Wo?Wo.push(n):Wo=[n]:Go=n}function Qw(){if(Go){var n=Go,t=Wo;if(Wo=Go=null,Kg(n),t)for(n=0;n<t.length;n++)Kg(t[n])}}function Yw(n,t){return n(t)}function Xw(){}var ff=!1;function Jw(n,t,e){if(ff)return n(t,e);ff=!0;try{return Yw(n,t,e)}finally{ff=!1,(Go!==null||Wo!==null)&&(Xw(),Qw())}}function il(n,t){var e=n.stateNode;if(e===null)return null;var i=yd(e);if(i===null)return null;e=i[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break t;default:n=!1}if(n)return null;if(e&&typeof e!="function")throw Error(X(231,t,typeof e));return e}var ap=!1;if(ji)try{var wu={};Object.defineProperty(wu,"passive",{get:function(){ap=!0}}),window.addEventListener("test",wu,wu),window.removeEventListener("test",wu,wu)}catch{ap=!1}function LP(n,t,e,i,r,s,a,l,h){var f=Array.prototype.slice.call(arguments,3);try{t.apply(e,f)}catch(_){this.onError(_)}}var Uu=!1,xh=null,Ch=!1,up=null,kP={onError:function(n){Uu=!0,xh=n}};function bP(n,t,e,i,r,s,a,l,h){Uu=!1,xh=null,LP.apply(kP,arguments)}function DP(n,t,e,i,r,s,a,l,h){if(bP.apply(this,arguments),Uu){if(Uu){var f=xh;Uu=!1,xh=null}else throw Error(X(198));Ch||(Ch=!0,up=f)}}function Ws(n){var t=n,e=n;if(n.alternate)for(;t.return;)t=t.return;else{n=t;do t=n,t.flags&4098&&(e=t.return),n=t.return;while(n)}return t.tag===3?e:null}function t0(n){if(n.tag===13){var t=n.memoizedState;if(t===null&&(n=n.alternate,n!==null&&(t=n.memoizedState)),t!==null)return t.dehydrated}return null}function Zg(n){if(Ws(n)!==n)throw Error(X(188))}function VP(n){var t=n.alternate;if(!t){if(t=Ws(n),t===null)throw Error(X(188));return t!==n?null:n}for(var e=n,i=t;;){var r=e.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){e=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===e)return Zg(r),n;if(s===i)return Zg(r),t;s=s.sibling}throw Error(X(188))}if(e.return!==i.return)e=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===e){a=!0,e=r,i=s;break}if(l===i){a=!0,i=r,e=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===e){a=!0,e=s,i=r;break}if(l===i){a=!0,i=s,e=r;break}l=l.sibling}if(!a)throw Error(X(189))}}if(e.alternate!==i)throw Error(X(190))}if(e.tag!==3)throw Error(X(188));return e.stateNode.current===e?n:t}function e0(n){return n=VP(n),n!==null?n0(n):null}function n0(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var t=n0(n);if(t!==null)return t;n=n.sibling}return null}var i0=Tn.unstable_scheduleCallback,Qg=Tn.unstable_cancelCallback,MP=Tn.unstable_shouldYield,NP=Tn.unstable_requestPaint,ue=Tn.unstable_now,OP=Tn.unstable_getCurrentPriorityLevel,Pm=Tn.unstable_ImmediatePriority,r0=Tn.unstable_UserBlockingPriority,Rh=Tn.unstable_NormalPriority,FP=Tn.unstable_LowPriority,s0=Tn.unstable_IdlePriority,pd=null,hi=null;function BP(n){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(pd,n,void 0,(n.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:jP,zP=Math.log,UP=Math.LN2;function jP(n){return n>>>=0,n===0?32:31-(zP(n)/UP|0)|0}var zc=64,Uc=4194304;function Vu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Lh(n,t){var e=n.pendingLanes;if(e===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,a=e&268435455;if(a!==0){var l=a&~r;l!==0?i=Vu(l):(s&=a,s!==0&&(i=Vu(s)))}else a=e&~r,a!==0?i=Vu(a):s!==0&&(i=Vu(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(i&4&&(i|=e&16),t=n.entangledLanes,t!==0)for(n=n.entanglements,t&=i;0<t;)e=31-Qn(t),r=1<<e,i|=n[e],t&=~r;return i}function $P(n,t){switch(n){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qP(n,t){for(var e=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-Qn(s),l=1<<a,h=r[a];h===-1?(!(l&e)||l&i)&&(r[a]=$P(l,t)):h<=t&&(n.expiredLanes|=l),s&=~l}}function lp(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function o0(){var n=zc;return zc<<=1,!(zc&4194240)&&(zc=64),n}function pf(n){for(var t=[],e=0;31>e;e++)t.push(n);return t}function Fl(n,t,e){n.pendingLanes|=t,t!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,t=31-Qn(t),n[t]=e}function GP(n,t){var e=n.pendingLanes&~t;n.pendingLanes=t,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=t,n.mutableReadLanes&=t,n.entangledLanes&=t,t=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<e;){var r=31-Qn(e),s=1<<r;t[r]=0,i[r]=-1,n[r]=-1,e&=~s}}function Sm(n,t){var e=n.entangledLanes|=t;for(n=n.entanglements;e;){var i=31-Qn(e),r=1<<i;r&t|n[i]&t&&(n[i]|=t),e&=~r}}var Mt=0;function a0(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var u0,Am,l0,c0,h0,cp=!1,jc=[],Sr=null,Ar=null,xr=null,rl=new Map,sl=new Map,yr=[],WP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yg(n,t){switch(n){case"focusin":case"focusout":Sr=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":xr=null;break;case"pointerover":case"pointerout":rl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":sl.delete(t.pointerId)}}function Eu(n,t,e,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:t,domEventName:e,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},t!==null&&(t=zl(t),t!==null&&Am(t)),n):(n.eventSystemFlags|=i,t=n.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),n)}function HP(n,t,e,i,r){switch(t){case"focusin":return Sr=Eu(Sr,n,t,e,i,r),!0;case"dragenter":return Ar=Eu(Ar,n,t,e,i,r),!0;case"mouseover":return xr=Eu(xr,n,t,e,i,r),!0;case"pointerover":var s=r.pointerId;return rl.set(s,Eu(rl.get(s)||null,n,t,e,i,r)),!0;case"gotpointercapture":return s=r.pointerId,sl.set(s,Eu(sl.get(s)||null,n,t,e,i,r)),!0}return!1}function d0(n){var t=Ts(n.target);if(t!==null){var e=Ws(t);if(e!==null){if(t=e.tag,t===13){if(t=t0(e),t!==null){n.blockedOn=t,h0(n.priority,function(){l0(e)});return}}else if(t===3&&e.stateNode.current.memoizedState.isDehydrated){n.blockedOn=e.tag===3?e.stateNode.containerInfo:null;return}}}n.blockedOn=null}function uh(n){if(n.blockedOn!==null)return!1;for(var t=n.targetContainers;0<t.length;){var e=hp(n.domEventName,n.eventSystemFlags,t[0],n.nativeEvent);if(e===null){e=n.nativeEvent;var i=new e.constructor(e.type,e);sp=i,e.target.dispatchEvent(i),sp=null}else return t=zl(e),t!==null&&Am(t),n.blockedOn=e,!1;t.shift()}return!0}function Xg(n,t,e){uh(n)&&e.delete(t)}function KP(){cp=!1,Sr!==null&&uh(Sr)&&(Sr=null),Ar!==null&&uh(Ar)&&(Ar=null),xr!==null&&uh(xr)&&(xr=null),rl.forEach(Xg),sl.forEach(Xg)}function Tu(n,t){n.blockedOn===t&&(n.blockedOn=null,cp||(cp=!0,Tn.unstable_scheduleCallback(Tn.unstable_NormalPriority,KP)))}function ol(n){function t(r){return Tu(r,n)}if(0<jc.length){Tu(jc[0],n);for(var e=1;e<jc.length;e++){var i=jc[e];i.blockedOn===n&&(i.blockedOn=null)}}for(Sr!==null&&Tu(Sr,n),Ar!==null&&Tu(Ar,n),xr!==null&&Tu(xr,n),rl.forEach(t),sl.forEach(t),e=0;e<yr.length;e++)i=yr[e],i.blockedOn===n&&(i.blockedOn=null);for(;0<yr.length&&(e=yr[0],e.blockedOn===null);)d0(e),e.blockedOn===null&&yr.shift()}var Ho=Zi.ReactCurrentBatchConfig,kh=!0;function ZP(n,t,e,i){var r=Mt,s=Ho.transition;Ho.transition=null;try{Mt=1,xm(n,t,e,i)}finally{Mt=r,Ho.transition=s}}function QP(n,t,e,i){var r=Mt,s=Ho.transition;Ho.transition=null;try{Mt=4,xm(n,t,e,i)}finally{Mt=r,Ho.transition=s}}function xm(n,t,e,i){if(kh){var r=hp(n,t,e,i);if(r===null)Pf(n,t,i,bh,e),Yg(n,i);else if(HP(r,n,t,e,i))i.stopPropagation();else if(Yg(n,i),t&4&&-1<WP.indexOf(n)){for(;r!==null;){var s=zl(r);if(s!==null&&u0(s),s=hp(n,t,e,i),s===null&&Pf(n,t,i,bh,e),s===r)break;r=s}r!==null&&i.stopPropagation()}else Pf(n,t,i,null,e)}}var bh=null;function hp(n,t,e,i){if(bh=null,n=Im(i),n=Ts(n),n!==null)if(t=Ws(n),t===null)n=null;else if(e=t.tag,e===13){if(n=t0(t),n!==null)return n;n=null}else if(e===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;n=null}else t!==n&&(n=null);return bh=n,null}function f0(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OP()){case Pm:return 1;case r0:return 4;case Rh:case FP:return 16;case s0:return 536870912;default:return 16}default:return 16}}var Tr=null,Cm=null,lh=null;function p0(){if(lh)return lh;var n,t=Cm,e=t.length,i,r="value"in Tr?Tr.value:Tr.textContent,s=r.length;for(n=0;n<e&&t[n]===r[n];n++);var a=e-n;for(i=1;i<=a&&t[e-i]===r[s-i];i++);return lh=r.slice(n,1<i?1-i:void 0)}function ch(n){var t=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&t===13&&(n=13)):n=t,n===10&&(n=13),32<=n||n===13?n:0}function $c(){return!0}function Jg(){return!1}function Sn(n){function t(e,i,r,s,a){this._reactName=e,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(e=n[l],this[l]=e?e(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?$c:Jg,this.isPropagationStopped=Jg,this}return ie(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!="unknown"&&(e.returnValue=!1),this.isDefaultPrevented=$c)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!="unknown"&&(e.cancelBubble=!0),this.isPropagationStopped=$c)},persist:function(){},isPersistent:$c}),t}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rm=Sn(Ta),Bl=ie({},Ta,{view:0,detail:0}),YP=Sn(Bl),mf,_f,Iu,md=ie({},Bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lm,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Iu&&(Iu&&n.type==="mousemove"?(mf=n.screenX-Iu.screenX,_f=n.screenY-Iu.screenY):_f=mf=0,Iu=n),mf)},movementY:function(n){return"movementY"in n?n.movementY:_f}}),ty=Sn(md),XP=ie({},md,{dataTransfer:0}),JP=Sn(XP),tS=ie({},Bl,{relatedTarget:0}),gf=Sn(tS),eS=ie({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),nS=Sn(eS),iS=ie({},Ta,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),rS=Sn(iS),sS=ie({},Ta,{data:0}),ey=Sn(sS),oS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lS(n){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(n):(n=uS[n])?!!t[n]:!1}function Lm(){return lS}var cS=ie({},Bl,{key:function(n){if(n.key){var t=oS[n.key]||n.key;if(t!=="Unidentified")return t}return n.type==="keypress"?(n=ch(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?aS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lm,charCode:function(n){return n.type==="keypress"?ch(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ch(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hS=Sn(cS),dS=ie({},md,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ny=Sn(dS),fS=ie({},Bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lm}),pS=Sn(fS),mS=ie({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),_S=Sn(mS),gS=ie({},md,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yS=Sn(gS),vS=[9,13,27,32],km=ji&&"CompositionEvent"in window,ju=null;ji&&"documentMode"in document&&(ju=document.documentMode);var wS=ji&&"TextEvent"in window&&!ju,m0=ji&&(!km||ju&&8<ju&&11>=ju),iy=String.fromCharCode(32),ry=!1;function _0(n,t){switch(n){case"keyup":return vS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g0(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Vo=!1;function ES(n,t){switch(n){case"compositionend":return g0(t);case"keypress":return t.which!==32?null:(ry=!0,iy);case"textInput":return n=t.data,n===iy&&ry?null:n;default:return null}}function TS(n,t){if(Vo)return n==="compositionend"||!km&&_0(n,t)?(n=p0(),lh=Cm=Tr=null,Vo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return m0&&t.locale!=="ko"?null:t.data;default:return null}}var IS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sy(n){var t=n&&n.nodeName&&n.nodeName.toLowerCase();return t==="input"?!!IS[n.type]:t==="textarea"}function y0(n,t,e,i){Zw(i),t=Dh(t,"onChange"),0<t.length&&(e=new Rm("onChange","change",null,e,i),n.push({event:e,listeners:t}))}var $u=null,al=null;function PS(n){R0(n,0)}function _d(n){var t=Oo(n);if(jw(t))return n}function SS(n,t){if(n==="change")return t}var v0=!1;if(ji){var yf;if(ji){var vf="oninput"in document;if(!vf){var oy=document.createElement("div");oy.setAttribute("oninput","return;"),vf=typeof oy.oninput=="function"}yf=vf}else yf=!1;v0=yf&&(!document.documentMode||9<document.documentMode)}function ay(){$u&&($u.detachEvent("onpropertychange",w0),al=$u=null)}function w0(n){if(n.propertyName==="value"&&_d(al)){var t=[];y0(t,al,n,Im(n)),Jw(PS,t)}}function AS(n,t,e){n==="focusin"?(ay(),$u=t,al=e,$u.attachEvent("onpropertychange",w0)):n==="focusout"&&ay()}function xS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _d(al)}function CS(n,t){if(n==="click")return _d(t)}function RS(n,t){if(n==="input"||n==="change")return _d(t)}function LS(n,t){return n===t&&(n!==0||1/n===1/t)||n!==n&&t!==t}var Xn=typeof Object.is=="function"?Object.is:LS;function ul(n,t){if(Xn(n,t))return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;var e=Object.keys(n),i=Object.keys(t);if(e.length!==i.length)return!1;for(i=0;i<e.length;i++){var r=e[i];if(!Hf.call(t,r)||!Xn(n[r],t[r]))return!1}return!0}function uy(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function ly(n,t){var e=uy(n);n=0;for(var i;e;){if(e.nodeType===3){if(i=n+e.textContent.length,n<=t&&i>=t)return{node:e,offset:t-n};n=i}t:{for(;e;){if(e.nextSibling){e=e.nextSibling;break t}e=e.parentNode}e=void 0}e=uy(e)}}function E0(n,t){return n&&t?n===t?!0:n&&n.nodeType===3?!1:t&&t.nodeType===3?E0(n,t.parentNode):"contains"in n?n.contains(t):n.compareDocumentPosition?!!(n.compareDocumentPosition(t)&16):!1:!1}function T0(){for(var n=window,t=Ah();t instanceof n.HTMLIFrameElement;){try{var e=typeof t.contentWindow.location.href=="string"}catch{e=!1}if(e)n=t.contentWindow;else break;t=Ah(n.document)}return t}function bm(n){var t=n&&n.nodeName&&n.nodeName.toLowerCase();return t&&(t==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||t==="textarea"||n.contentEditable==="true")}function kS(n){var t=T0(),e=n.focusedElem,i=n.selectionRange;if(t!==e&&e&&e.ownerDocument&&E0(e.ownerDocument.documentElement,e)){if(i!==null&&bm(e)){if(t=i.start,n=i.end,n===void 0&&(n=t),"selectionStart"in e)e.selectionStart=t,e.selectionEnd=Math.min(n,e.value.length);else if(n=(t=e.ownerDocument||document)&&t.defaultView||window,n.getSelection){n=n.getSelection();var r=e.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=ly(e,s);var a=ly(e,i);r&&a&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(t),n.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),n.addRange(t)))}}for(t=[],n=e;n=n.parentNode;)n.nodeType===1&&t.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof e.focus=="function"&&e.focus(),e=0;e<t.length;e++)n=t[e],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var bS=ji&&"documentMode"in document&&11>=document.documentMode,Mo=null,dp=null,qu=null,fp=!1;function cy(n,t,e){var i=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;fp||Mo==null||Mo!==Ah(i)||(i=Mo,"selectionStart"in i&&bm(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),qu&&ul(qu,i)||(qu=i,i=Dh(dp,"onSelect"),0<i.length&&(t=new Rm("onSelect","select",null,t,e),n.push({event:t,listeners:i}),t.target=Mo)))}function qc(n,t){var e={};return e[n.toLowerCase()]=t.toLowerCase(),e["Webkit"+n]="webkit"+t,e["Moz"+n]="moz"+t,e}var No={animationend:qc("Animation","AnimationEnd"),animationiteration:qc("Animation","AnimationIteration"),animationstart:qc("Animation","AnimationStart"),transitionend:qc("Transition","TransitionEnd")},wf={},I0={};ji&&(I0=document.createElement("div").style,"AnimationEvent"in window||(delete No.animationend.animation,delete No.animationiteration.animation,delete No.animationstart.animation),"TransitionEvent"in window||delete No.transitionend.transition);function gd(n){if(wf[n])return wf[n];if(!No[n])return n;var t=No[n],e;for(e in t)if(t.hasOwnProperty(e)&&e in I0)return wf[n]=t[e];return n}var P0=gd("animationend"),S0=gd("animationiteration"),A0=gd("animationstart"),x0=gd("transitionend"),C0=new Map,hy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hr(n,t){C0.set(n,t),Gs(t,[n])}for(var Ef=0;Ef<hy.length;Ef++){var Tf=hy[Ef],DS=Tf.toLowerCase(),VS=Tf[0].toUpperCase()+Tf.slice(1);Hr(DS,"on"+VS)}Hr(P0,"onAnimationEnd");Hr(S0,"onAnimationIteration");Hr(A0,"onAnimationStart");Hr("dblclick","onDoubleClick");Hr("focusin","onFocus");Hr("focusout","onBlur");Hr(x0,"onTransitionEnd");Xo("onMouseEnter",["mouseout","mouseover"]);Xo("onMouseLeave",["mouseout","mouseover"]);Xo("onPointerEnter",["pointerout","pointerover"]);Xo("onPointerLeave",["pointerout","pointerover"]);Gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mu));function dy(n,t,e){var i=n.type||"unknown-event";n.currentTarget=e,DP(i,t,void 0,n),n.currentTarget=null}function R0(n,t){t=(t&4)!==0;for(var e=0;e<n.length;e++){var i=n[e],r=i.event;i=i.listeners;t:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var l=i[a],h=l.instance,f=l.currentTarget;if(l=l.listener,h!==s&&r.isPropagationStopped())break t;dy(r,l,f),s=h}else for(a=0;a<i.length;a++){if(l=i[a],h=l.instance,f=l.currentTarget,l=l.listener,h!==s&&r.isPropagationStopped())break t;dy(r,l,f),s=h}}}if(Ch)throw n=up,Ch=!1,up=null,n}function $t(n,t){var e=t[yp];e===void 0&&(e=t[yp]=new Set);var i=n+"__bubble";e.has(i)||(L0(t,n,2,!1),e.add(i))}function If(n,t,e){var i=0;t&&(i|=4),L0(e,n,i,t)}var Gc="_reactListening"+Math.random().toString(36).slice(2);function ll(n){if(!n[Gc]){n[Gc]=!0,Ow.forEach(function(e){e!=="selectionchange"&&(MS.has(e)||If(e,!1,n),If(e,!0,n))});var t=n.nodeType===9?n:n.ownerDocument;t===null||t[Gc]||(t[Gc]=!0,If("selectionchange",!1,t))}}function L0(n,t,e,i){switch(f0(t)){case 1:var r=ZP;break;case 4:r=QP;break;default:r=xm}e=r.bind(null,t,e,n),r=void 0,!ap||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(t,e,{capture:!0,passive:r}):n.addEventListener(t,e,!0):r!==void 0?n.addEventListener(t,e,{passive:r}):n.addEventListener(t,e,!1)}function Pf(n,t,e,i,r){var s=i;if(!(t&1)&&!(t&2)&&i!==null)t:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var l=i.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===r||h.nodeType===8&&h.parentNode===r))return;a=a.return}for(;l!==null;){if(a=Ts(l),a===null)return;if(h=a.tag,h===5||h===6){i=s=a;continue t}l=l.parentNode}}i=i.return}Jw(function(){var f=s,_=Im(e),g=[];t:{var w=C0.get(n);if(w!==void 0){var E=Rm,x=n;switch(n){case"keypress":if(ch(e)===0)break t;case"keydown":case"keyup":E=hS;break;case"focusin":x="focus",E=gf;break;case"focusout":x="blur",E=gf;break;case"beforeblur":case"afterblur":E=gf;break;case"click":if(e.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=ty;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=JP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=pS;break;case P0:case S0:case A0:E=nS;break;case x0:E=_S;break;case"scroll":E=YP;break;case"wheel":E=yS;break;case"copy":case"cut":case"paste":E=rS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=ny}var R=(t&4)!==0,z=!R&&n==="scroll",A=R?w!==null?w+"Capture":null:w;R=[];for(var S=f,C;S!==null;){C=S;var j=C.stateNode;if(C.tag===5&&j!==null&&(C=j,A!==null&&(j=il(S,A),j!=null&&R.push(cl(S,j,C)))),z)break;S=S.return}0<R.length&&(w=new E(w,x,null,e,_),g.push({event:w,listeners:R}))}}if(!(t&7)){t:{if(w=n==="mouseover"||n==="pointerover",E=n==="mouseout"||n==="pointerout",w&&e!==sp&&(x=e.relatedTarget||e.fromElement)&&(Ts(x)||x[$i]))break t;if((E||w)&&(w=_.window===_?_:(w=_.ownerDocument)?w.defaultView||w.parentWindow:window,E?(x=e.relatedTarget||e.toElement,E=f,x=x?Ts(x):null,x!==null&&(z=Ws(x),x!==z||x.tag!==5&&x.tag!==6)&&(x=null)):(E=null,x=f),E!==x)){if(R=ty,j="onMouseLeave",A="onMouseEnter",S="mouse",(n==="pointerout"||n==="pointerover")&&(R=ny,j="onPointerLeave",A="onPointerEnter",S="pointer"),z=E==null?w:Oo(E),C=x==null?w:Oo(x),w=new R(j,S+"leave",E,e,_),w.target=z,w.relatedTarget=C,j=null,Ts(_)===f&&(R=new R(A,S+"enter",x,e,_),R.target=C,R.relatedTarget=z,j=R),z=j,E&&x)e:{for(R=E,A=x,S=0,C=R;C;C=To(C))S++;for(C=0,j=A;j;j=To(j))C++;for(;0<S-C;)R=To(R),S--;for(;0<C-S;)A=To(A),C--;for(;S--;){if(R===A||A!==null&&R===A.alternate)break e;R=To(R),A=To(A)}R=null}else R=null;E!==null&&fy(g,w,E,R,!1),x!==null&&z!==null&&fy(g,z,x,R,!0)}}t:{if(w=f?Oo(f):window,E=w.nodeName&&w.nodeName.toLowerCase(),E==="select"||E==="input"&&w.type==="file")var H=SS;else if(sy(w))if(v0)H=RS;else{H=xS;var Y=AS}else(E=w.nodeName)&&E.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(H=CS);if(H&&(H=H(n,f))){y0(g,H,e,_);break t}Y&&Y(n,w,f),n==="focusout"&&(Y=w._wrapperState)&&Y.controlled&&w.type==="number"&&tp(w,"number",w.value)}switch(Y=f?Oo(f):window,n){case"focusin":(sy(Y)||Y.contentEditable==="true")&&(Mo=Y,dp=f,qu=null);break;case"focusout":qu=dp=Mo=null;break;case"mousedown":fp=!0;break;case"contextmenu":case"mouseup":case"dragend":fp=!1,cy(g,e,_);break;case"selectionchange":if(bS)break;case"keydown":case"keyup":cy(g,e,_)}var k;if(km)t:{switch(n){case"compositionstart":var P="onCompositionStart";break t;case"compositionend":P="onCompositionEnd";break t;case"compositionupdate":P="onCompositionUpdate";break t}P=void 0}else Vo?_0(n,e)&&(P="onCompositionEnd"):n==="keydown"&&e.keyCode===229&&(P="onCompositionStart");P&&(m0&&e.locale!=="ko"&&(Vo||P!=="onCompositionStart"?P==="onCompositionEnd"&&Vo&&(k=p0()):(Tr=_,Cm="value"in Tr?Tr.value:Tr.textContent,Vo=!0)),Y=Dh(f,P),0<Y.length&&(P=new ey(P,n,null,e,_),g.push({event:P,listeners:Y}),k?P.data=k:(k=g0(e),k!==null&&(P.data=k)))),(k=wS?ES(n,e):TS(n,e))&&(f=Dh(f,"onBeforeInput"),0<f.length&&(_=new ey("onBeforeInput","beforeinput",null,e,_),g.push({event:_,listeners:f}),_.data=k))}R0(g,t)})}function cl(n,t,e){return{instance:n,listener:t,currentTarget:e}}function Dh(n,t){for(var e=t+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=il(n,e),s!=null&&i.unshift(cl(n,s,r)),s=il(n,t),s!=null&&i.push(cl(n,s,r))),n=n.return}return i}function To(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function fy(n,t,e,i,r){for(var s=t._reactName,a=[];e!==null&&e!==i;){var l=e,h=l.alternate,f=l.stateNode;if(h!==null&&h===i)break;l.tag===5&&f!==null&&(l=f,r?(h=il(e,s),h!=null&&a.unshift(cl(e,h,l))):r||(h=il(e,s),h!=null&&a.push(cl(e,h,l)))),e=e.return}a.length!==0&&n.push({event:t,listeners:a})}var NS=/\r\n?/g,OS=/\u0000|\uFFFD/g;function py(n){return(typeof n=="string"?n:""+n).replace(NS,`
`).replace(OS,"")}function Wc(n,t,e){if(t=py(t),py(n)!==t&&e)throw Error(X(425))}function Vh(){}var pp=null,mp=null;function _p(n,t){return n==="textarea"||n==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gp=typeof setTimeout=="function"?setTimeout:void 0,FS=typeof clearTimeout=="function"?clearTimeout:void 0,my=typeof Promise=="function"?Promise:void 0,BS=typeof queueMicrotask=="function"?queueMicrotask:typeof my<"u"?function(n){return my.resolve(null).then(n).catch(zS)}:gp;function zS(n){setTimeout(function(){throw n})}function Sf(n,t){var e=t,i=0;do{var r=e.nextSibling;if(n.removeChild(e),r&&r.nodeType===8)if(e=r.data,e==="/$"){if(i===0){n.removeChild(r),ol(t);return}i--}else e!=="$"&&e!=="$?"&&e!=="$!"||i++;e=r}while(e);ol(t)}function Cr(n){for(;n!=null;n=n.nextSibling){var t=n.nodeType;if(t===1||t===3)break;if(t===8){if(t=n.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return n}function _y(n){n=n.previousSibling;for(var t=0;n;){if(n.nodeType===8){var e=n.data;if(e==="$"||e==="$!"||e==="$?"){if(t===0)return n;t--}else e==="/$"&&t++}n=n.previousSibling}return null}var Ia=Math.random().toString(36).slice(2),ui="__reactFiber$"+Ia,hl="__reactProps$"+Ia,$i="__reactContainer$"+Ia,yp="__reactEvents$"+Ia,US="__reactListeners$"+Ia,jS="__reactHandles$"+Ia;function Ts(n){var t=n[ui];if(t)return t;for(var e=n.parentNode;e;){if(t=e[$i]||e[ui]){if(e=t.alternate,t.child!==null||e!==null&&e.child!==null)for(n=_y(n);n!==null;){if(e=n[ui])return e;n=_y(n)}return t}n=e,e=n.parentNode}return null}function zl(n){return n=n[ui]||n[$i],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Oo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(X(33))}function yd(n){return n[hl]||null}var vp=[],Fo=-1;function Kr(n){return{current:n}}function Gt(n){0>Fo||(n.current=vp[Fo],vp[Fo]=null,Fo--)}function zt(n,t){Fo++,vp[Fo]=n.current,n.current=t}var Nr={},Ke=Kr(Nr),pn=Kr(!1),Ls=Nr;function Jo(n,t){var e=n.type.contextTypes;if(!e)return Nr;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in e)r[s]=t[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=t,n.__reactInternalMemoizedMaskedChildContext=r),r}function mn(n){return n=n.childContextTypes,n!=null}function Mh(){Gt(pn),Gt(Ke)}function gy(n,t,e){if(Ke.current!==Nr)throw Error(X(168));zt(Ke,t),zt(pn,e)}function k0(n,t,e){var i=n.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return e;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(X(108,AP(n)||"Unknown",r));return ie({},e,i)}function Nh(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Nr,Ls=Ke.current,zt(Ke,n),zt(pn,pn.current),!0}function yy(n,t,e){var i=n.stateNode;if(!i)throw Error(X(169));e?(n=k0(n,t,Ls),i.__reactInternalMemoizedMergedChildContext=n,Gt(pn),Gt(Ke),zt(Ke,n)):Gt(pn),zt(pn,e)}var Mi=null,vd=!1,Af=!1;function b0(n){Mi===null?Mi=[n]:Mi.push(n)}function $S(n){vd=!0,b0(n)}function Zr(){if(!Af&&Mi!==null){Af=!0;var n=0,t=Mt;try{var e=Mi;for(Mt=1;n<e.length;n++){var i=e[n];do i=i(!0);while(i!==null)}Mi=null,vd=!1}catch(r){throw Mi!==null&&(Mi=Mi.slice(n+1)),i0(Pm,Zr),r}finally{Mt=t,Af=!1}}return null}var Bo=[],zo=0,Oh=null,Fh=0,bn=[],Dn=0,ks=null,Oi=1,Fi="";function fs(n,t){Bo[zo++]=Fh,Bo[zo++]=Oh,Oh=n,Fh=t}function D0(n,t,e){bn[Dn++]=Oi,bn[Dn++]=Fi,bn[Dn++]=ks,ks=n;var i=Oi;n=Fi;var r=32-Qn(i)-1;i&=~(1<<r),e+=1;var s=32-Qn(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Oi=1<<32-Qn(t)+r|e<<r|i,Fi=s+n}else Oi=1<<s|e<<r|i,Fi=n}function Dm(n){n.return!==null&&(fs(n,1),D0(n,1,0))}function Vm(n){for(;n===Oh;)Oh=Bo[--zo],Bo[zo]=null,Fh=Bo[--zo],Bo[zo]=null;for(;n===ks;)ks=bn[--Dn],bn[Dn]=null,Fi=bn[--Dn],bn[Dn]=null,Oi=bn[--Dn],bn[Dn]=null}var En=null,wn=null,Kt=!1,Zn=null;function V0(n,t){var e=Vn(5,null,null,0);e.elementType="DELETED",e.stateNode=t,e.return=n,t=n.deletions,t===null?(n.deletions=[e],n.flags|=16):t.push(e)}function vy(n,t){switch(n.tag){case 5:var e=n.type;return t=t.nodeType!==1||e.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(n.stateNode=t,En=n,wn=Cr(t.firstChild),!0):!1;case 6:return t=n.pendingProps===""||t.nodeType!==3?null:t,t!==null?(n.stateNode=t,En=n,wn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(e=ks!==null?{id:Oi,overflow:Fi}:null,n.memoizedState={dehydrated:t,treeContext:e,retryLane:1073741824},e=Vn(18,null,null,0),e.stateNode=t,e.return=n,n.child=e,En=n,wn=null,!0):!1;default:return!1}}function wp(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Ep(n){if(Kt){var t=wn;if(t){var e=t;if(!vy(n,t)){if(wp(n))throw Error(X(418));t=Cr(e.nextSibling);var i=En;t&&vy(n,t)?V0(i,e):(n.flags=n.flags&-4097|2,Kt=!1,En=n)}}else{if(wp(n))throw Error(X(418));n.flags=n.flags&-4097|2,Kt=!1,En=n}}}function wy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;En=n}function Hc(n){if(n!==En)return!1;if(!Kt)return wy(n),Kt=!0,!1;var t;if((t=n.tag!==3)&&!(t=n.tag!==5)&&(t=n.type,t=t!=="head"&&t!=="body"&&!_p(n.type,n.memoizedProps)),t&&(t=wn)){if(wp(n))throw M0(),Error(X(418));for(;t;)V0(n,t),t=Cr(t.nextSibling)}if(wy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(X(317));t:{for(n=n.nextSibling,t=0;n;){if(n.nodeType===8){var e=n.data;if(e==="/$"){if(t===0){wn=Cr(n.nextSibling);break t}t--}else e!=="$"&&e!=="$!"&&e!=="$?"||t++}n=n.nextSibling}wn=null}}else wn=En?Cr(n.stateNode.nextSibling):null;return!0}function M0(){for(var n=wn;n;)n=Cr(n.nextSibling)}function ta(){wn=En=null,Kt=!1}function Mm(n){Zn===null?Zn=[n]:Zn.push(n)}var qS=Zi.ReactCurrentBatchConfig;function Pu(n,t,e){if(n=e.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(e._owner){if(e=e._owner,e){if(e.tag!==1)throw Error(X(309));var i=e.stateNode}if(!i)throw Error(X(147,n));var r=i,s=""+n;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var l=r.refs;a===null?delete l[s]:l[s]=a},t._stringRef=s,t)}if(typeof n!="string")throw Error(X(284));if(!e._owner)throw Error(X(290,n))}return n}function Kc(n,t){throw n=Object.prototype.toString.call(t),Error(X(31,n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n))}function Ey(n){var t=n._init;return t(n._payload)}function N0(n){function t(A,S){if(n){var C=A.deletions;C===null?(A.deletions=[S],A.flags|=16):C.push(S)}}function e(A,S){if(!n)return null;for(;S!==null;)t(A,S),S=S.sibling;return null}function i(A,S){for(A=new Map;S!==null;)S.key!==null?A.set(S.key,S):A.set(S.index,S),S=S.sibling;return A}function r(A,S){return A=br(A,S),A.index=0,A.sibling=null,A}function s(A,S,C){return A.index=C,n?(C=A.alternate,C!==null?(C=C.index,C<S?(A.flags|=2,S):C):(A.flags|=2,S)):(A.flags|=1048576,S)}function a(A){return n&&A.alternate===null&&(A.flags|=2),A}function l(A,S,C,j){return S===null||S.tag!==6?(S=Df(C,A.mode,j),S.return=A,S):(S=r(S,C),S.return=A,S)}function h(A,S,C,j){var H=C.type;return H===Do?_(A,S,C.props.children,j,C.key):S!==null&&(S.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===_r&&Ey(H)===S.type)?(j=r(S,C.props),j.ref=Pu(A,S,C),j.return=A,j):(j=gh(C.type,C.key,C.props,null,A.mode,j),j.ref=Pu(A,S,C),j.return=A,j)}function f(A,S,C,j){return S===null||S.tag!==4||S.stateNode.containerInfo!==C.containerInfo||S.stateNode.implementation!==C.implementation?(S=Vf(C,A.mode,j),S.return=A,S):(S=r(S,C.children||[]),S.return=A,S)}function _(A,S,C,j,H){return S===null||S.tag!==7?(S=Cs(C,A.mode,j,H),S.return=A,S):(S=r(S,C),S.return=A,S)}function g(A,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Df(""+S,A.mode,C),S.return=A,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Oc:return C=gh(S.type,S.key,S.props,null,A.mode,C),C.ref=Pu(A,null,S),C.return=A,C;case bo:return S=Vf(S,A.mode,C),S.return=A,S;case _r:var j=S._init;return g(A,j(S._payload),C)}if(Du(S)||vu(S))return S=Cs(S,A.mode,C,null),S.return=A,S;Kc(A,S)}return null}function w(A,S,C,j){var H=S!==null?S.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return H!==null?null:l(A,S,""+C,j);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Oc:return C.key===H?h(A,S,C,j):null;case bo:return C.key===H?f(A,S,C,j):null;case _r:return H=C._init,w(A,S,H(C._payload),j)}if(Du(C)||vu(C))return H!==null?null:_(A,S,C,j,null);Kc(A,C)}return null}function E(A,S,C,j,H){if(typeof j=="string"&&j!==""||typeof j=="number")return A=A.get(C)||null,l(S,A,""+j,H);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Oc:return A=A.get(j.key===null?C:j.key)||null,h(S,A,j,H);case bo:return A=A.get(j.key===null?C:j.key)||null,f(S,A,j,H);case _r:var Y=j._init;return E(A,S,C,Y(j._payload),H)}if(Du(j)||vu(j))return A=A.get(C)||null,_(S,A,j,H,null);Kc(S,j)}return null}function x(A,S,C,j){for(var H=null,Y=null,k=S,P=S=0,b=null;k!==null&&P<C.length;P++){k.index>P?(b=k,k=null):b=k.sibling;var V=w(A,k,C[P],j);if(V===null){k===null&&(k=b);break}n&&k&&V.alternate===null&&t(A,k),S=s(V,S,P),Y===null?H=V:Y.sibling=V,Y=V,k=b}if(P===C.length)return e(A,k),Kt&&fs(A,P),H;if(k===null){for(;P<C.length;P++)k=g(A,C[P],j),k!==null&&(S=s(k,S,P),Y===null?H=k:Y.sibling=k,Y=k);return Kt&&fs(A,P),H}for(k=i(A,k);P<C.length;P++)b=E(k,A,P,C[P],j),b!==null&&(n&&b.alternate!==null&&k.delete(b.key===null?P:b.key),S=s(b,S,P),Y===null?H=b:Y.sibling=b,Y=b);return n&&k.forEach(function(N){return t(A,N)}),Kt&&fs(A,P),H}function R(A,S,C,j){var H=vu(C);if(typeof H!="function")throw Error(X(150));if(C=H.call(C),C==null)throw Error(X(151));for(var Y=H=null,k=S,P=S=0,b=null,V=C.next();k!==null&&!V.done;P++,V=C.next()){k.index>P?(b=k,k=null):b=k.sibling;var N=w(A,k,V.value,j);if(N===null){k===null&&(k=b);break}n&&k&&N.alternate===null&&t(A,k),S=s(N,S,P),Y===null?H=N:Y.sibling=N,Y=N,k=b}if(V.done)return e(A,k),Kt&&fs(A,P),H;if(k===null){for(;!V.done;P++,V=C.next())V=g(A,V.value,j),V!==null&&(S=s(V,S,P),Y===null?H=V:Y.sibling=V,Y=V);return Kt&&fs(A,P),H}for(k=i(A,k);!V.done;P++,V=C.next())V=E(k,A,P,V.value,j),V!==null&&(n&&V.alternate!==null&&k.delete(V.key===null?P:V.key),S=s(V,S,P),Y===null?H=V:Y.sibling=V,Y=V);return n&&k.forEach(function(O){return t(A,O)}),Kt&&fs(A,P),H}function z(A,S,C,j){if(typeof C=="object"&&C!==null&&C.type===Do&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Oc:t:{for(var H=C.key,Y=S;Y!==null;){if(Y.key===H){if(H=C.type,H===Do){if(Y.tag===7){e(A,Y.sibling),S=r(Y,C.props.children),S.return=A,A=S;break t}}else if(Y.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===_r&&Ey(H)===Y.type){e(A,Y.sibling),S=r(Y,C.props),S.ref=Pu(A,Y,C),S.return=A,A=S;break t}e(A,Y);break}else t(A,Y);Y=Y.sibling}C.type===Do?(S=Cs(C.props.children,A.mode,j,C.key),S.return=A,A=S):(j=gh(C.type,C.key,C.props,null,A.mode,j),j.ref=Pu(A,S,C),j.return=A,A=j)}return a(A);case bo:t:{for(Y=C.key;S!==null;){if(S.key===Y)if(S.tag===4&&S.stateNode.containerInfo===C.containerInfo&&S.stateNode.implementation===C.implementation){e(A,S.sibling),S=r(S,C.children||[]),S.return=A,A=S;break t}else{e(A,S);break}else t(A,S);S=S.sibling}S=Vf(C,A.mode,j),S.return=A,A=S}return a(A);case _r:return Y=C._init,z(A,S,Y(C._payload),j)}if(Du(C))return x(A,S,C,j);if(vu(C))return R(A,S,C,j);Kc(A,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,S!==null&&S.tag===6?(e(A,S.sibling),S=r(S,C),S.return=A,A=S):(e(A,S),S=Df(C,A.mode,j),S.return=A,A=S),a(A)):e(A,S)}return z}var ea=N0(!0),O0=N0(!1),Bh=Kr(null),zh=null,Uo=null,Nm=null;function Om(){Nm=Uo=zh=null}function Fm(n){var t=Bh.current;Gt(Bh),n._currentValue=t}function Tp(n,t,e){for(;n!==null;){var i=n.alternate;if((n.childLanes&t)!==t?(n.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),n===e)break;n=n.return}}function Ko(n,t){zh=n,Nm=Uo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&t&&(cn=!0),n.firstContext=null)}function Fn(n){var t=n._currentValue;if(Nm!==n)if(n={context:n,memoizedValue:t,next:null},Uo===null){if(zh===null)throw Error(X(308));Uo=n,zh.dependencies={lanes:0,firstContext:n}}else Uo=Uo.next=n;return t}var Is=null;function Bm(n){Is===null?Is=[n]:Is.push(n)}function F0(n,t,e,i){var r=t.interleaved;return r===null?(e.next=e,Bm(t)):(e.next=r.next,r.next=e),t.interleaved=e,qi(n,i)}function qi(n,t){n.lanes|=t;var e=n.alternate;for(e!==null&&(e.lanes|=t),e=n,n=n.return;n!==null;)n.childLanes|=t,e=n.alternate,e!==null&&(e.childLanes|=t),e=n,n=n.return;return e.tag===3?e.stateNode:null}var gr=!1;function zm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function B0(n,t){n=n.updateQueue,t.updateQueue===n&&(t.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function zi(n,t){return{eventTime:n,lane:t,tag:0,payload:null,callback:null,next:null}}function Rr(n,t,e){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Lt&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,qi(n,e)}return r=i.interleaved,r===null?(t.next=t,Bm(i)):(t.next=r.next,r.next=t),i.interleaved=t,qi(n,e)}function hh(n,t,e){if(t=t.updateQueue,t!==null&&(t=t.shared,(e&4194240)!==0)){var i=t.lanes;i&=n.pendingLanes,e|=i,t.lanes=e,Sm(n,e)}}function Ty(n,t){var e=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,e===i)){var r=null,s=null;if(e=e.firstBaseUpdate,e!==null){do{var a={eventTime:e.eventTime,lane:e.lane,tag:e.tag,payload:e.payload,callback:e.callback,next:null};s===null?r=s=a:s=s.next=a,e=e.next}while(e!==null);s===null?r=s=t:s=s.next=t}else r=s=t;e={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=e;return}n=e.lastBaseUpdate,n===null?e.firstBaseUpdate=t:n.next=t,e.lastBaseUpdate=t}function Uh(n,t,e,i){var r=n.updateQueue;gr=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var h=l,f=h.next;h.next=null,a===null?s=f:a.next=f,a=h;var _=n.alternate;_!==null&&(_=_.updateQueue,l=_.lastBaseUpdate,l!==a&&(l===null?_.firstBaseUpdate=f:l.next=f,_.lastBaseUpdate=h))}if(s!==null){var g=r.baseState;a=0,_=f=h=null,l=s;do{var w=l.lane,E=l.eventTime;if((i&w)===w){_!==null&&(_=_.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});t:{var x=n,R=l;switch(w=t,E=e,R.tag){case 1:if(x=R.payload,typeof x=="function"){g=x.call(E,g,w);break t}g=x;break t;case 3:x.flags=x.flags&-65537|128;case 0:if(x=R.payload,w=typeof x=="function"?x.call(E,g,w):x,w==null)break t;g=ie({},g,w);break t;case 2:gr=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,w=r.effects,w===null?r.effects=[l]:w.push(l))}else E={eventTime:E,lane:w,tag:l.tag,payload:l.payload,callback:l.callback,next:null},_===null?(f=_=E,h=g):_=_.next=E,a|=w;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;w=l,l=w.next,w.next=null,r.lastBaseUpdate=w,r.shared.pending=null}}while(1);if(_===null&&(h=g),r.baseState=h,r.firstBaseUpdate=f,r.lastBaseUpdate=_,t=r.shared.interleaved,t!==null){r=t;do a|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);Ds|=a,n.lanes=a,n.memoizedState=g}}function Iy(n,t,e){if(n=t.effects,t.effects=null,n!==null)for(t=0;t<n.length;t++){var i=n[t],r=i.callback;if(r!==null){if(i.callback=null,i=e,typeof r!="function")throw Error(X(191,r));r.call(i)}}}var Ul={},di=Kr(Ul),dl=Kr(Ul),fl=Kr(Ul);function Ps(n){if(n===Ul)throw Error(X(174));return n}function Um(n,t){switch(zt(fl,t),zt(dl,n),zt(di,Ul),n=t.nodeType,n){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:np(null,"");break;default:n=n===8?t.parentNode:t,t=n.namespaceURI||null,n=n.tagName,t=np(t,n)}Gt(di),zt(di,t)}function na(){Gt(di),Gt(dl),Gt(fl)}function z0(n){Ps(fl.current);var t=Ps(di.current),e=np(t,n.type);t!==e&&(zt(dl,n),zt(di,e))}function jm(n){dl.current===n&&(Gt(di),Gt(dl))}var te=Kr(0);function jh(n){for(var t=n;t!==null;){if(t.tag===13){var e=t.memoizedState;if(e!==null&&(e=e.dehydrated,e===null||e.data==="$?"||e.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break;for(;t.sibling===null;){if(t.return===null||t.return===n)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xf=[];function $m(){for(var n=0;n<xf.length;n++)xf[n]._workInProgressVersionPrimary=null;xf.length=0}var dh=Zi.ReactCurrentDispatcher,Cf=Zi.ReactCurrentBatchConfig,bs=0,ee=null,Te=null,Le=null,$h=!1,Gu=!1,pl=0,GS=0;function qe(){throw Error(X(321))}function qm(n,t){if(t===null)return!1;for(var e=0;e<t.length&&e<n.length;e++)if(!Xn(n[e],t[e]))return!1;return!0}function Gm(n,t,e,i,r,s){if(bs=s,ee=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,dh.current=n===null||n.memoizedState===null?ZS:QS,n=e(i,r),Gu){s=0;do{if(Gu=!1,pl=0,25<=s)throw Error(X(301));s+=1,Le=Te=null,t.updateQueue=null,dh.current=YS,n=e(i,r)}while(Gu)}if(dh.current=qh,t=Te!==null&&Te.next!==null,bs=0,Le=Te=ee=null,$h=!1,t)throw Error(X(300));return n}function Wm(){var n=pl!==0;return pl=0,n}function ai(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Le===null?ee.memoizedState=Le=n:Le=Le.next=n,Le}function Bn(){if(Te===null){var n=ee.alternate;n=n!==null?n.memoizedState:null}else n=Te.next;var t=Le===null?ee.memoizedState:Le.next;if(t!==null)Le=t,Te=n;else{if(n===null)throw Error(X(310));Te=n,n={memoizedState:Te.memoizedState,baseState:Te.baseState,baseQueue:Te.baseQueue,queue:Te.queue,next:null},Le===null?ee.memoizedState=Le=n:Le=Le.next=n}return Le}function ml(n,t){return typeof t=="function"?t(n):t}function Rf(n){var t=Bn(),e=t.queue;if(e===null)throw Error(X(311));e.lastRenderedReducer=n;var i=Te,r=i.baseQueue,s=e.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,e.pending=null}if(r!==null){s=r.next,i=i.baseState;var l=a=null,h=null,f=s;do{var _=f.lane;if((bs&_)===_)h!==null&&(h=h.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),i=f.hasEagerState?f.eagerState:n(i,f.action);else{var g={lane:_,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};h===null?(l=h=g,a=i):h=h.next=g,ee.lanes|=_,Ds|=_}f=f.next}while(f!==null&&f!==s);h===null?a=i:h.next=l,Xn(i,t.memoizedState)||(cn=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=h,e.lastRenderedState=i}if(n=e.interleaved,n!==null){r=n;do s=r.lane,ee.lanes|=s,Ds|=s,r=r.next;while(r!==n)}else r===null&&(e.lanes=0);return[t.memoizedState,e.dispatch]}function Lf(n){var t=Bn(),e=t.queue;if(e===null)throw Error(X(311));e.lastRenderedReducer=n;var i=e.dispatch,r=e.pending,s=t.memoizedState;if(r!==null){e.pending=null;var a=r=r.next;do s=n(s,a.action),a=a.next;while(a!==r);Xn(s,t.memoizedState)||(cn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),e.lastRenderedState=s}return[s,i]}function U0(){}function j0(n,t){var e=ee,i=Bn(),r=t(),s=!Xn(i.memoizedState,r);if(s&&(i.memoizedState=r,cn=!0),i=i.queue,Hm(G0.bind(null,e,i,n),[n]),i.getSnapshot!==t||s||Le!==null&&Le.memoizedState.tag&1){if(e.flags|=2048,_l(9,q0.bind(null,e,i,r,t),void 0,null),be===null)throw Error(X(349));bs&30||$0(e,t,r)}return r}function $0(n,t,e){n.flags|=16384,n={getSnapshot:t,value:e},t=ee.updateQueue,t===null?(t={lastEffect:null,stores:null},ee.updateQueue=t,t.stores=[n]):(e=t.stores,e===null?t.stores=[n]:e.push(n))}function q0(n,t,e,i){t.value=e,t.getSnapshot=i,W0(t)&&H0(n)}function G0(n,t,e){return e(function(){W0(t)&&H0(n)})}function W0(n){var t=n.getSnapshot;n=n.value;try{var e=t();return!Xn(n,e)}catch{return!0}}function H0(n){var t=qi(n,1);t!==null&&Yn(t,n,1,-1)}function Py(n){var t=ai();return typeof n=="function"&&(n=n()),t.memoizedState=t.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:n},t.queue=n,n=n.dispatch=KS.bind(null,ee,n),[t.memoizedState,n]}function _l(n,t,e,i){return n={tag:n,create:t,destroy:e,deps:i,next:null},t=ee.updateQueue,t===null?(t={lastEffect:null,stores:null},ee.updateQueue=t,t.lastEffect=n.next=n):(e=t.lastEffect,e===null?t.lastEffect=n.next=n:(i=e.next,e.next=n,n.next=i,t.lastEffect=n)),n}function K0(){return Bn().memoizedState}function fh(n,t,e,i){var r=ai();ee.flags|=n,r.memoizedState=_l(1|t,e,void 0,i===void 0?null:i)}function wd(n,t,e,i){var r=Bn();i=i===void 0?null:i;var s=void 0;if(Te!==null){var a=Te.memoizedState;if(s=a.destroy,i!==null&&qm(i,a.deps)){r.memoizedState=_l(t,e,s,i);return}}ee.flags|=n,r.memoizedState=_l(1|t,e,s,i)}function Sy(n,t){return fh(8390656,8,n,t)}function Hm(n,t){return wd(2048,8,n,t)}function Z0(n,t){return wd(4,2,n,t)}function Q0(n,t){return wd(4,4,n,t)}function Y0(n,t){if(typeof t=="function")return n=n(),t(n),function(){t(null)};if(t!=null)return n=n(),t.current=n,function(){t.current=null}}function X0(n,t,e){return e=e!=null?e.concat([n]):null,wd(4,4,Y0.bind(null,t,n),e)}function Km(){}function J0(n,t){var e=Bn();t=t===void 0?null:t;var i=e.memoizedState;return i!==null&&t!==null&&qm(t,i[1])?i[0]:(e.memoizedState=[n,t],n)}function tE(n,t){var e=Bn();t=t===void 0?null:t;var i=e.memoizedState;return i!==null&&t!==null&&qm(t,i[1])?i[0]:(n=n(),e.memoizedState=[n,t],n)}function eE(n,t,e){return bs&21?(Xn(e,t)||(e=o0(),ee.lanes|=e,Ds|=e,n.baseState=!0),t):(n.baseState&&(n.baseState=!1,cn=!0),n.memoizedState=e)}function WS(n,t){var e=Mt;Mt=e!==0&&4>e?e:4,n(!0);var i=Cf.transition;Cf.transition={};try{n(!1),t()}finally{Mt=e,Cf.transition=i}}function nE(){return Bn().memoizedState}function HS(n,t,e){var i=kr(n);if(e={lane:i,action:e,hasEagerState:!1,eagerState:null,next:null},iE(n))rE(t,e);else if(e=F0(n,t,e,i),e!==null){var r=tn();Yn(e,n,i,r),sE(e,t,i)}}function KS(n,t,e){var i=kr(n),r={lane:i,action:e,hasEagerState:!1,eagerState:null,next:null};if(iE(n))rE(t,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,l=s(a,e);if(r.hasEagerState=!0,r.eagerState=l,Xn(l,a)){var h=t.interleaved;h===null?(r.next=r,Bm(t)):(r.next=h.next,h.next=r),t.interleaved=r;return}}catch{}finally{}e=F0(n,t,r,i),e!==null&&(r=tn(),Yn(e,n,i,r),sE(e,t,i))}}function iE(n){var t=n.alternate;return n===ee||t!==null&&t===ee}function rE(n,t){Gu=$h=!0;var e=n.pending;e===null?t.next=t:(t.next=e.next,e.next=t),n.pending=t}function sE(n,t,e){if(e&4194240){var i=t.lanes;i&=n.pendingLanes,e|=i,t.lanes=e,Sm(n,e)}}var qh={readContext:Fn,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useInsertionEffect:qe,useLayoutEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useMutableSource:qe,useSyncExternalStore:qe,useId:qe,unstable_isNewReconciler:!1},ZS={readContext:Fn,useCallback:function(n,t){return ai().memoizedState=[n,t===void 0?null:t],n},useContext:Fn,useEffect:Sy,useImperativeHandle:function(n,t,e){return e=e!=null?e.concat([n]):null,fh(4194308,4,Y0.bind(null,t,n),e)},useLayoutEffect:function(n,t){return fh(4194308,4,n,t)},useInsertionEffect:function(n,t){return fh(4,2,n,t)},useMemo:function(n,t){var e=ai();return t=t===void 0?null:t,n=n(),e.memoizedState=[n,t],n},useReducer:function(n,t,e){var i=ai();return t=e!==void 0?e(t):t,i.memoizedState=i.baseState=t,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:t},i.queue=n,n=n.dispatch=HS.bind(null,ee,n),[i.memoizedState,n]},useRef:function(n){var t=ai();return n={current:n},t.memoizedState=n},useState:Py,useDebugValue:Km,useDeferredValue:function(n){return ai().memoizedState=n},useTransition:function(){var n=Py(!1),t=n[0];return n=WS.bind(null,n[1]),ai().memoizedState=n,[t,n]},useMutableSource:function(){},useSyncExternalStore:function(n,t,e){var i=ee,r=ai();if(Kt){if(e===void 0)throw Error(X(407));e=e()}else{if(e=t(),be===null)throw Error(X(349));bs&30||$0(i,t,e)}r.memoizedState=e;var s={value:e,getSnapshot:t};return r.queue=s,Sy(G0.bind(null,i,s,n),[n]),i.flags|=2048,_l(9,q0.bind(null,i,s,e,t),void 0,null),e},useId:function(){var n=ai(),t=be.identifierPrefix;if(Kt){var e=Fi,i=Oi;e=(i&~(1<<32-Qn(i)-1)).toString(32)+e,t=":"+t+"R"+e,e=pl++,0<e&&(t+="H"+e.toString(32)),t+=":"}else e=GS++,t=":"+t+"r"+e.toString(32)+":";return n.memoizedState=t},unstable_isNewReconciler:!1},QS={readContext:Fn,useCallback:J0,useContext:Fn,useEffect:Hm,useImperativeHandle:X0,useInsertionEffect:Z0,useLayoutEffect:Q0,useMemo:tE,useReducer:Rf,useRef:K0,useState:function(){return Rf(ml)},useDebugValue:Km,useDeferredValue:function(n){var t=Bn();return eE(t,Te.memoizedState,n)},useTransition:function(){var n=Rf(ml)[0],t=Bn().memoizedState;return[n,t]},useMutableSource:U0,useSyncExternalStore:j0,useId:nE,unstable_isNewReconciler:!1},YS={readContext:Fn,useCallback:J0,useContext:Fn,useEffect:Hm,useImperativeHandle:X0,useInsertionEffect:Z0,useLayoutEffect:Q0,useMemo:tE,useReducer:Lf,useRef:K0,useState:function(){return Lf(ml)},useDebugValue:Km,useDeferredValue:function(n){var t=Bn();return Te===null?t.memoizedState=n:eE(t,Te.memoizedState,n)},useTransition:function(){var n=Lf(ml)[0],t=Bn().memoizedState;return[n,t]},useMutableSource:U0,useSyncExternalStore:j0,useId:nE,unstable_isNewReconciler:!1};function Hn(n,t){if(n&&n.defaultProps){t=ie({},t),n=n.defaultProps;for(var e in n)t[e]===void 0&&(t[e]=n[e]);return t}return t}function Ip(n,t,e,i){t=n.memoizedState,e=e(i,t),e=e==null?t:ie({},t,e),n.memoizedState=e,n.lanes===0&&(n.updateQueue.baseState=e)}var Ed={isMounted:function(n){return(n=n._reactInternals)?Ws(n)===n:!1},enqueueSetState:function(n,t,e){n=n._reactInternals;var i=tn(),r=kr(n),s=zi(i,r);s.payload=t,e!=null&&(s.callback=e),t=Rr(n,s,r),t!==null&&(Yn(t,n,r,i),hh(t,n,r))},enqueueReplaceState:function(n,t,e){n=n._reactInternals;var i=tn(),r=kr(n),s=zi(i,r);s.tag=1,s.payload=t,e!=null&&(s.callback=e),t=Rr(n,s,r),t!==null&&(Yn(t,n,r,i),hh(t,n,r))},enqueueForceUpdate:function(n,t){n=n._reactInternals;var e=tn(),i=kr(n),r=zi(e,i);r.tag=2,t!=null&&(r.callback=t),t=Rr(n,r,i),t!==null&&(Yn(t,n,i,e),hh(t,n,i))}};function Ay(n,t,e,i,r,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,a):t.prototype&&t.prototype.isPureReactComponent?!ul(e,i)||!ul(r,s):!0}function oE(n,t,e){var i=!1,r=Nr,s=t.contextType;return typeof s=="object"&&s!==null?s=Fn(s):(r=mn(t)?Ls:Ke.current,i=t.contextTypes,s=(i=i!=null)?Jo(n,r):Nr),t=new t(e,s),n.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ed,n.stateNode=t,t._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),t}function xy(n,t,e,i){n=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(e,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(e,i),t.state!==n&&Ed.enqueueReplaceState(t,t.state,null)}function Pp(n,t,e,i){var r=n.stateNode;r.props=e,r.state=n.memoizedState,r.refs={},zm(n);var s=t.contextType;typeof s=="object"&&s!==null?r.context=Fn(s):(s=mn(t)?Ls:Ke.current,r.context=Jo(n,s)),r.state=n.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ip(n,t,s,e),r.state=n.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Ed.enqueueReplaceState(r,r.state,null),Uh(n,e,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function ia(n,t){try{var e="",i=t;do e+=SP(i),i=i.return;while(i);var r=e}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:t,stack:r,digest:null}}function kf(n,t,e){return{value:n,source:null,stack:e??null,digest:t??null}}function Sp(n,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var XS=typeof WeakMap=="function"?WeakMap:Map;function aE(n,t,e){e=zi(-1,e),e.tag=3,e.payload={element:null};var i=t.value;return e.callback=function(){Wh||(Wh=!0,Mp=i),Sp(n,t)},e}function uE(n,t,e){e=zi(-1,e),e.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;e.payload=function(){return i(r)},e.callback=function(){Sp(n,t)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(e.callback=function(){Sp(n,t),typeof i!="function"&&(Lr===null?Lr=new Set([this]):Lr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),e}function Cy(n,t,e){var i=n.pingCache;if(i===null){i=n.pingCache=new XS;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(e)||(r.add(e),n=dA.bind(null,n,t,e),t.then(n,n))}function Ry(n){do{var t;if((t=n.tag===13)&&(t=n.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return n;n=n.return}while(n!==null);return null}function Ly(n,t,e,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===t?n.flags|=65536:(n.flags|=128,e.flags|=131072,e.flags&=-52805,e.tag===1&&(e.alternate===null?e.tag=17:(t=zi(-1,1),t.tag=2,Rr(e,t,1))),e.lanes|=1),n)}var JS=Zi.ReactCurrentOwner,cn=!1;function Ye(n,t,e,i){t.child=n===null?O0(t,null,e,i):ea(t,n.child,e,i)}function ky(n,t,e,i,r){e=e.render;var s=t.ref;return Ko(t,r),i=Gm(n,t,e,i,s,r),e=Wm(),n!==null&&!cn?(t.updateQueue=n.updateQueue,t.flags&=-2053,n.lanes&=~r,Gi(n,t,r)):(Kt&&e&&Dm(t),t.flags|=1,Ye(n,t,i,r),t.child)}function by(n,t,e,i,r){if(n===null){var s=e.type;return typeof s=="function"&&!n_(s)&&s.defaultProps===void 0&&e.compare===null&&e.defaultProps===void 0?(t.tag=15,t.type=s,lE(n,t,s,i,r)):(n=gh(e.type,null,i,t,t.mode,r),n.ref=t.ref,n.return=t,t.child=n)}if(s=n.child,!(n.lanes&r)){var a=s.memoizedProps;if(e=e.compare,e=e!==null?e:ul,e(a,i)&&n.ref===t.ref)return Gi(n,t,r)}return t.flags|=1,n=br(s,i),n.ref=t.ref,n.return=t,t.child=n}function lE(n,t,e,i,r){if(n!==null){var s=n.memoizedProps;if(ul(s,i)&&n.ref===t.ref)if(cn=!1,t.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(cn=!0);else return t.lanes=n.lanes,Gi(n,t,r)}return Ap(n,t,e,i,r)}function cE(n,t,e){var i=t.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},zt($o,vn),vn|=e;else{if(!(e&1073741824))return n=s!==null?s.baseLanes|e:e,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:n,cachePool:null,transitions:null},t.updateQueue=null,zt($o,vn),vn|=n,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:e,zt($o,vn),vn|=i}else s!==null?(i=s.baseLanes|e,t.memoizedState=null):i=e,zt($o,vn),vn|=i;return Ye(n,t,r,e),t.child}function hE(n,t){var e=t.ref;(n===null&&e!==null||n!==null&&n.ref!==e)&&(t.flags|=512,t.flags|=2097152)}function Ap(n,t,e,i,r){var s=mn(e)?Ls:Ke.current;return s=Jo(t,s),Ko(t,r),e=Gm(n,t,e,i,s,r),i=Wm(),n!==null&&!cn?(t.updateQueue=n.updateQueue,t.flags&=-2053,n.lanes&=~r,Gi(n,t,r)):(Kt&&i&&Dm(t),t.flags|=1,Ye(n,t,e,r),t.child)}function Dy(n,t,e,i,r){if(mn(e)){var s=!0;Nh(t)}else s=!1;if(Ko(t,r),t.stateNode===null)ph(n,t),oE(t,e,i),Pp(t,e,i,r),i=!0;else if(n===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var h=a.context,f=e.contextType;typeof f=="object"&&f!==null?f=Fn(f):(f=mn(e)?Ls:Ke.current,f=Jo(t,f));var _=e.getDerivedStateFromProps,g=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==i||h!==f)&&xy(t,a,i,f),gr=!1;var w=t.memoizedState;a.state=w,Uh(t,i,a,r),h=t.memoizedState,l!==i||w!==h||pn.current||gr?(typeof _=="function"&&(Ip(t,e,_,i),h=t.memoizedState),(l=gr||Ay(t,e,l,i,w,h,f))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=h),a.props=i,a.state=h,a.context=f,i=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,B0(n,t),l=t.memoizedProps,f=t.type===t.elementType?l:Hn(t.type,l),a.props=f,g=t.pendingProps,w=a.context,h=e.contextType,typeof h=="object"&&h!==null?h=Fn(h):(h=mn(e)?Ls:Ke.current,h=Jo(t,h));var E=e.getDerivedStateFromProps;(_=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||w!==h)&&xy(t,a,i,h),gr=!1,w=t.memoizedState,a.state=w,Uh(t,i,a,r);var x=t.memoizedState;l!==g||w!==x||pn.current||gr?(typeof E=="function"&&(Ip(t,e,E,i),x=t.memoizedState),(f=gr||Ay(t,e,f,i,w,x,h)||!1)?(_||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,x,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,x,h)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&w===n.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&w===n.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=x),a.props=i,a.state=x,a.context=h,i=f):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&w===n.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&w===n.memoizedState||(t.flags|=1024),i=!1)}return xp(n,t,e,i,s,r)}function xp(n,t,e,i,r,s){hE(n,t);var a=(t.flags&128)!==0;if(!i&&!a)return r&&yy(t,e,!1),Gi(n,t,s);i=t.stateNode,JS.current=t;var l=a&&typeof e.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,n!==null&&a?(t.child=ea(t,n.child,null,s),t.child=ea(t,null,l,s)):Ye(n,t,l,s),t.memoizedState=i.state,r&&yy(t,e,!0),t.child}function dE(n){var t=n.stateNode;t.pendingContext?gy(n,t.pendingContext,t.pendingContext!==t.context):t.context&&gy(n,t.context,!1),Um(n,t.containerInfo)}function Vy(n,t,e,i,r){return ta(),Mm(r),t.flags|=256,Ye(n,t,e,i),t.child}var Cp={dehydrated:null,treeContext:null,retryLane:0};function Rp(n){return{baseLanes:n,cachePool:null,transitions:null}}function fE(n,t,e){var i=t.pendingProps,r=te.current,s=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=n!==null&&n.memoizedState===null?!1:(r&2)!==0),l?(s=!0,t.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),zt(te,r&1),n===null)return Ep(t),n=t.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(t.mode&1?n.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,n=i.fallback,s?(i=t.mode,s=t.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Pd(a,i,0,null),n=Cs(n,i,e,null),s.return=t,n.return=t,s.sibling=n,t.child=s,t.child.memoizedState=Rp(e),t.memoizedState=Cp,n):Zm(t,a));if(r=n.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return tA(n,t,a,i,l,r,e);if(s){s=i.fallback,a=t.mode,r=n.child,l=r.sibling;var h={mode:"hidden",children:i.children};return!(a&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=h,t.deletions=null):(i=br(r,h),i.subtreeFlags=r.subtreeFlags&14680064),l!==null?s=br(l,s):(s=Cs(s,a,e,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=n.child.memoizedState,a=a===null?Rp(e):{baseLanes:a.baseLanes|e,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~e,t.memoizedState=Cp,i}return s=n.child,n=s.sibling,i=br(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=e),i.return=t,i.sibling=null,n!==null&&(e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)),t.child=i,t.memoizedState=null,i}function Zm(n,t){return t=Pd({mode:"visible",children:t},n.mode,0,null),t.return=n,n.child=t}function Zc(n,t,e,i){return i!==null&&Mm(i),ea(t,n.child,null,e),n=Zm(t,t.pendingProps.children),n.flags|=2,t.memoizedState=null,n}function tA(n,t,e,i,r,s,a){if(e)return t.flags&256?(t.flags&=-257,i=kf(Error(X(422))),Zc(n,t,a,i)):t.memoizedState!==null?(t.child=n.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=Pd({mode:"visible",children:i.children},r,0,null),s=Cs(s,r,a,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&ea(t,n.child,null,a),t.child.memoizedState=Rp(a),t.memoizedState=Cp,s);if(!(t.mode&1))return Zc(n,t,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var l=i.dgst;return i=l,s=Error(X(419)),i=kf(s,i,void 0),Zc(n,t,a,i)}if(l=(a&n.childLanes)!==0,cn||l){if(i=be,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,qi(n,r),Yn(i,n,r,-1))}return e_(),i=kf(Error(X(421))),Zc(n,t,a,i)}return r.data==="$?"?(t.flags|=128,t.child=n.child,t=fA.bind(null,n),r._reactRetry=t,null):(n=s.treeContext,wn=Cr(r.nextSibling),En=t,Kt=!0,Zn=null,n!==null&&(bn[Dn++]=Oi,bn[Dn++]=Fi,bn[Dn++]=ks,Oi=n.id,Fi=n.overflow,ks=t),t=Zm(t,i.children),t.flags|=4096,t)}function My(n,t,e){n.lanes|=t;var i=n.alternate;i!==null&&(i.lanes|=t),Tp(n.return,t,e)}function bf(n,t,e,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:e,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=e,s.tailMode=r)}function pE(n,t,e){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Ye(n,t,i.children,e),i=te.current,i&2)i=i&1|2,t.flags|=128;else{if(n!==null&&n.flags&128)t:for(n=t.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&My(n,e,t);else if(n.tag===19)My(n,e,t);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break t;for(;n.sibling===null;){if(n.return===null||n.return===t)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(zt(te,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(e=t.child,r=null;e!==null;)n=e.alternate,n!==null&&jh(n)===null&&(r=e),e=e.sibling;e=r,e===null?(r=t.child,t.child=null):(r=e.sibling,e.sibling=null),bf(t,!1,r,e,s);break;case"backwards":for(e=null,r=t.child,t.child=null;r!==null;){if(n=r.alternate,n!==null&&jh(n)===null){t.child=r;break}n=r.sibling,r.sibling=e,e=r,r=n}bf(t,!0,e,null,s);break;case"together":bf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ph(n,t){!(t.mode&1)&&n!==null&&(n.alternate=null,t.alternate=null,t.flags|=2)}function Gi(n,t,e){if(n!==null&&(t.dependencies=n.dependencies),Ds|=t.lanes,!(e&t.childLanes))return null;if(n!==null&&t.child!==n.child)throw Error(X(153));if(t.child!==null){for(n=t.child,e=br(n,n.pendingProps),t.child=e,e.return=t;n.sibling!==null;)n=n.sibling,e=e.sibling=br(n,n.pendingProps),e.return=t;e.sibling=null}return t.child}function eA(n,t,e){switch(t.tag){case 3:dE(t),ta();break;case 5:z0(t);break;case 1:mn(t.type)&&Nh(t);break;case 4:Um(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;zt(Bh,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(zt(te,te.current&1),t.flags|=128,null):e&t.child.childLanes?fE(n,t,e):(zt(te,te.current&1),n=Gi(n,t,e),n!==null?n.sibling:null);zt(te,te.current&1);break;case 19:if(i=(e&t.childLanes)!==0,n.flags&128){if(i)return pE(n,t,e);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),zt(te,te.current),i)break;return null;case 22:case 23:return t.lanes=0,cE(n,t,e)}return Gi(n,t,e)}var mE,Lp,_E,gE;mE=function(n,t){for(var e=t.child;e!==null;){if(e.tag===5||e.tag===6)n.appendChild(e.stateNode);else if(e.tag!==4&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return;e=e.return}e.sibling.return=e.return,e=e.sibling}};Lp=function(){};_E=function(n,t,e,i){var r=n.memoizedProps;if(r!==i){n=t.stateNode,Ps(di.current);var s=null;switch(e){case"input":r=Xf(n,r),i=Xf(n,i),s=[];break;case"select":r=ie({},r,{value:void 0}),i=ie({},i,{value:void 0}),s=[];break;case"textarea":r=ep(n,r),i=ep(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Vh)}ip(e,i);var a;e=null;for(f in r)if(!i.hasOwnProperty(f)&&r.hasOwnProperty(f)&&r[f]!=null)if(f==="style"){var l=r[f];for(a in l)l.hasOwnProperty(a)&&(e||(e={}),e[a]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(el.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in i){var h=i[f];if(l=r!=null?r[f]:void 0,i.hasOwnProperty(f)&&h!==l&&(h!=null||l!=null))if(f==="style")if(l){for(a in l)!l.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(e||(e={}),e[a]="");for(a in h)h.hasOwnProperty(a)&&l[a]!==h[a]&&(e||(e={}),e[a]=h[a])}else e||(s||(s=[]),s.push(f,e)),e=h;else f==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,l=l?l.__html:void 0,h!=null&&l!==h&&(s=s||[]).push(f,h)):f==="children"?typeof h!="string"&&typeof h!="number"||(s=s||[]).push(f,""+h):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(el.hasOwnProperty(f)?(h!=null&&f==="onScroll"&&$t("scroll",n),s||l===h||(s=[])):(s=s||[]).push(f,h))}e&&(s=s||[]).push("style",e);var f=s;(t.updateQueue=f)&&(t.flags|=4)}};gE=function(n,t,e,i){e!==i&&(t.flags|=4)};function Su(n,t){if(!Kt)switch(n.tailMode){case"hidden":t=n.tail;for(var e=null;t!==null;)t.alternate!==null&&(e=t),t=t.sibling;e===null?n.tail=null:e.sibling=null;break;case"collapsed":e=n.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Ge(n){var t=n.alternate!==null&&n.alternate.child===n.child,e=0,i=0;if(t)for(var r=n.child;r!==null;)e|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)e|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=e,t}function nA(n,t,e){var i=t.pendingProps;switch(Vm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ge(t),null;case 1:return mn(t.type)&&Mh(),Ge(t),null;case 3:return i=t.stateNode,na(),Gt(pn),Gt(Ke),$m(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Hc(t)?t.flags|=4:n===null||n.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zn!==null&&(Fp(Zn),Zn=null))),Lp(n,t),Ge(t),null;case 5:jm(t);var r=Ps(fl.current);if(e=t.type,n!==null&&t.stateNode!=null)_E(n,t,e,i,r),n.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(X(166));return Ge(t),null}if(n=Ps(di.current),Hc(t)){i=t.stateNode,e=t.type;var s=t.memoizedProps;switch(i[ui]=t,i[hl]=s,n=(t.mode&1)!==0,e){case"dialog":$t("cancel",i),$t("close",i);break;case"iframe":case"object":case"embed":$t("load",i);break;case"video":case"audio":for(r=0;r<Mu.length;r++)$t(Mu[r],i);break;case"source":$t("error",i);break;case"img":case"image":case"link":$t("error",i),$t("load",i);break;case"details":$t("toggle",i);break;case"input":qg(i,s),$t("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},$t("invalid",i);break;case"textarea":Wg(i,s),$t("invalid",i)}ip(e,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?i.textContent!==l&&(s.suppressHydrationWarning!==!0&&Wc(i.textContent,l,n),r=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Wc(i.textContent,l,n),r=["children",""+l]):el.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&$t("scroll",i)}switch(e){case"input":Fc(i),Gg(i,s,!0);break;case"textarea":Fc(i),Hg(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Vh)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Gw(e)),n==="http://www.w3.org/1999/xhtml"?e==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=a.createElement(e,{is:i.is}):(n=a.createElement(e),e==="select"&&(a=n,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):n=a.createElementNS(n,e),n[ui]=t,n[hl]=i,mE(n,t,!1,!1),t.stateNode=n;t:{switch(a=rp(e,i),e){case"dialog":$t("cancel",n),$t("close",n),r=i;break;case"iframe":case"object":case"embed":$t("load",n),r=i;break;case"video":case"audio":for(r=0;r<Mu.length;r++)$t(Mu[r],n);r=i;break;case"source":$t("error",n),r=i;break;case"img":case"image":case"link":$t("error",n),$t("load",n),r=i;break;case"details":$t("toggle",n),r=i;break;case"input":qg(n,i),r=Xf(n,i),$t("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=ie({},i,{value:void 0}),$t("invalid",n);break;case"textarea":Wg(n,i),r=ep(n,i),$t("invalid",n);break;default:r=i}ip(e,r),l=r;for(s in l)if(l.hasOwnProperty(s)){var h=l[s];s==="style"?Kw(n,h):s==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&Ww(n,h)):s==="children"?typeof h=="string"?(e!=="textarea"||h!=="")&&nl(n,h):typeof h=="number"&&nl(n,""+h):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(el.hasOwnProperty(s)?h!=null&&s==="onScroll"&&$t("scroll",n):h!=null&&vm(n,s,h,a))}switch(e){case"input":Fc(n),Gg(n,i,!1);break;case"textarea":Fc(n),Hg(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Mr(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?qo(n,!!i.multiple,s,!1):i.defaultValue!=null&&qo(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=Vh)}switch(e){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ge(t),null;case 6:if(n&&t.stateNode!=null)gE(n,t,n.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(X(166));if(e=Ps(fl.current),Ps(di.current),Hc(t)){if(i=t.stateNode,e=t.memoizedProps,i[ui]=t,(s=i.nodeValue!==e)&&(n=En,n!==null))switch(n.tag){case 3:Wc(i.nodeValue,e,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Wc(i.nodeValue,e,(n.mode&1)!==0)}s&&(t.flags|=4)}else i=(e.nodeType===9?e:e.ownerDocument).createTextNode(i),i[ui]=t,t.stateNode=i}return Ge(t),null;case 13:if(Gt(te),i=t.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Kt&&wn!==null&&t.mode&1&&!(t.flags&128))M0(),ta(),t.flags|=98560,s=!1;else if(s=Hc(t),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(X(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(X(317));s[ui]=t}else ta(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ge(t),s=!1}else Zn!==null&&(Fp(Zn),Zn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=e,t):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(n===null||te.current&1?Ie===0&&(Ie=3):e_())),t.updateQueue!==null&&(t.flags|=4),Ge(t),null);case 4:return na(),Lp(n,t),n===null&&ll(t.stateNode.containerInfo),Ge(t),null;case 10:return Fm(t.type._context),Ge(t),null;case 17:return mn(t.type)&&Mh(),Ge(t),null;case 19:if(Gt(te),s=t.memoizedState,s===null)return Ge(t),null;if(i=(t.flags&128)!==0,a=s.rendering,a===null)if(i)Su(s,!1);else{if(Ie!==0||n!==null&&n.flags&128)for(n=t.child;n!==null;){if(a=jh(n),a!==null){for(t.flags|=128,Su(s,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=e,e=t.child;e!==null;)s=e,n=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e=e.sibling;return zt(te,te.current&1|2),t.child}n=n.sibling}s.tail!==null&&ue()>ra&&(t.flags|=128,i=!0,Su(s,!1),t.lanes=4194304)}else{if(!i)if(n=jh(a),n!==null){if(t.flags|=128,i=!0,e=n.updateQueue,e!==null&&(t.updateQueue=e,t.flags|=4),Su(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Kt)return Ge(t),null}else 2*ue()-s.renderingStartTime>ra&&e!==1073741824&&(t.flags|=128,i=!0,Su(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(e=s.last,e!==null?e.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ue(),t.sibling=null,e=te.current,zt(te,i?e&1|2:e&1),t):(Ge(t),null);case 22:case 23:return t_(),i=t.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?vn&1073741824&&(Ge(t),t.subtreeFlags&6&&(t.flags|=8192)):Ge(t),null;case 24:return null;case 25:return null}throw Error(X(156,t.tag))}function iA(n,t){switch(Vm(t),t.tag){case 1:return mn(t.type)&&Mh(),n=t.flags,n&65536?(t.flags=n&-65537|128,t):null;case 3:return na(),Gt(pn),Gt(Ke),$m(),n=t.flags,n&65536&&!(n&128)?(t.flags=n&-65537|128,t):null;case 5:return jm(t),null;case 13:if(Gt(te),n=t.memoizedState,n!==null&&n.dehydrated!==null){if(t.alternate===null)throw Error(X(340));ta()}return n=t.flags,n&65536?(t.flags=n&-65537|128,t):null;case 19:return Gt(te),null;case 4:return na(),null;case 10:return Fm(t.type._context),null;case 22:case 23:return t_(),null;case 24:return null;default:return null}}var Qc=!1,He=!1,rA=typeof WeakSet=="function"?WeakSet:Set,st=null;function jo(n,t){var e=n.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(i){se(n,t,i)}else e.current=null}function kp(n,t,e){try{e()}catch(i){se(n,t,i)}}var Ny=!1;function sA(n,t){if(pp=kh,n=T0(),bm(n)){if("selectionStart"in n)var e={start:n.selectionStart,end:n.selectionEnd};else t:{e=(e=n.ownerDocument)&&e.defaultView||window;var i=e.getSelection&&e.getSelection();if(i&&i.rangeCount!==0){e=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{e.nodeType,s.nodeType}catch{e=null;break t}var a=0,l=-1,h=-1,f=0,_=0,g=n,w=null;e:for(;;){for(var E;g!==e||r!==0&&g.nodeType!==3||(l=a+r),g!==s||i!==0&&g.nodeType!==3||(h=a+i),g.nodeType===3&&(a+=g.nodeValue.length),(E=g.firstChild)!==null;)w=g,g=E;for(;;){if(g===n)break e;if(w===e&&++f===r&&(l=a),w===s&&++_===i&&(h=a),(E=g.nextSibling)!==null)break;g=w,w=g.parentNode}g=E}e=l===-1||h===-1?null:{start:l,end:h}}else e=null}e=e||{start:0,end:0}}else e=null;for(mp={focusedElem:n,selectionRange:e},kh=!1,st=t;st!==null;)if(t=st,n=t.child,(t.subtreeFlags&1028)!==0&&n!==null)n.return=t,st=n;else for(;st!==null;){t=st;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var R=x.memoizedProps,z=x.memoizedState,A=t.stateNode,S=A.getSnapshotBeforeUpdate(t.elementType===t.type?R:Hn(t.type,R),z);A.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var C=t.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(j){se(t,t.return,j)}if(n=t.sibling,n!==null){n.return=t.return,st=n;break}st=t.return}return x=Ny,Ny=!1,x}function Wu(n,t,e){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&kp(t,e,s)}r=r.next}while(r!==i)}}function Td(n,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var e=t=t.next;do{if((e.tag&n)===n){var i=e.create;e.destroy=i()}e=e.next}while(e!==t)}}function bp(n){var t=n.ref;if(t!==null){var e=n.stateNode;switch(n.tag){case 5:n=e;break;default:n=e}typeof t=="function"?t(n):t.current=n}}function yE(n){var t=n.alternate;t!==null&&(n.alternate=null,yE(t)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(t=n.stateNode,t!==null&&(delete t[ui],delete t[hl],delete t[yp],delete t[US],delete t[jS])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function vE(n){return n.tag===5||n.tag===3||n.tag===4}function Oy(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||vE(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Dp(n,t,e){var i=n.tag;if(i===5||i===6)n=n.stateNode,t?e.nodeType===8?e.parentNode.insertBefore(n,t):e.insertBefore(n,t):(e.nodeType===8?(t=e.parentNode,t.insertBefore(n,e)):(t=e,t.appendChild(n)),e=e._reactRootContainer,e!=null||t.onclick!==null||(t.onclick=Vh));else if(i!==4&&(n=n.child,n!==null))for(Dp(n,t,e),n=n.sibling;n!==null;)Dp(n,t,e),n=n.sibling}function Vp(n,t,e){var i=n.tag;if(i===5||i===6)n=n.stateNode,t?e.insertBefore(n,t):e.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Vp(n,t,e),n=n.sibling;n!==null;)Vp(n,t,e),n=n.sibling}var Me=null,Kn=!1;function dr(n,t,e){for(e=e.child;e!==null;)wE(n,t,e),e=e.sibling}function wE(n,t,e){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(pd,e)}catch{}switch(e.tag){case 5:He||jo(e,t);case 6:var i=Me,r=Kn;Me=null,dr(n,t,e),Me=i,Kn=r,Me!==null&&(Kn?(n=Me,e=e.stateNode,n.nodeType===8?n.parentNode.removeChild(e):n.removeChild(e)):Me.removeChild(e.stateNode));break;case 18:Me!==null&&(Kn?(n=Me,e=e.stateNode,n.nodeType===8?Sf(n.parentNode,e):n.nodeType===1&&Sf(n,e),ol(n)):Sf(Me,e.stateNode));break;case 4:i=Me,r=Kn,Me=e.stateNode.containerInfo,Kn=!0,dr(n,t,e),Me=i,Kn=r;break;case 0:case 11:case 14:case 15:if(!He&&(i=e.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&kp(e,t,a),r=r.next}while(r!==i)}dr(n,t,e);break;case 1:if(!He&&(jo(e,t),i=e.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=e.memoizedProps,i.state=e.memoizedState,i.componentWillUnmount()}catch(l){se(e,t,l)}dr(n,t,e);break;case 21:dr(n,t,e);break;case 22:e.mode&1?(He=(i=He)||e.memoizedState!==null,dr(n,t,e),He=i):dr(n,t,e);break;default:dr(n,t,e)}}function Fy(n){var t=n.updateQueue;if(t!==null){n.updateQueue=null;var e=n.stateNode;e===null&&(e=n.stateNode=new rA),t.forEach(function(i){var r=pA.bind(null,n,i);e.has(i)||(e.add(i),i.then(r,r))})}}function Wn(n,t){var e=t.deletions;if(e!==null)for(var i=0;i<e.length;i++){var r=e[i];try{var s=n,a=t,l=a;t:for(;l!==null;){switch(l.tag){case 5:Me=l.stateNode,Kn=!1;break t;case 3:Me=l.stateNode.containerInfo,Kn=!0;break t;case 4:Me=l.stateNode.containerInfo,Kn=!0;break t}l=l.return}if(Me===null)throw Error(X(160));wE(s,a,r),Me=null,Kn=!1;var h=r.alternate;h!==null&&(h.return=null),r.return=null}catch(f){se(r,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)EE(t,n),t=t.sibling}function EE(n,t){var e=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Wn(t,n),oi(n),i&4){try{Wu(3,n,n.return),Td(3,n)}catch(R){se(n,n.return,R)}try{Wu(5,n,n.return)}catch(R){se(n,n.return,R)}}break;case 1:Wn(t,n),oi(n),i&512&&e!==null&&jo(e,e.return);break;case 5:if(Wn(t,n),oi(n),i&512&&e!==null&&jo(e,e.return),n.flags&32){var r=n.stateNode;try{nl(r,"")}catch(R){se(n,n.return,R)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,a=e!==null?e.memoizedProps:s,l=n.type,h=n.updateQueue;if(n.updateQueue=null,h!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&$w(r,s),rp(l,a);var f=rp(l,s);for(a=0;a<h.length;a+=2){var _=h[a],g=h[a+1];_==="style"?Kw(r,g):_==="dangerouslySetInnerHTML"?Ww(r,g):_==="children"?nl(r,g):vm(r,_,g,f)}switch(l){case"input":Jf(r,s);break;case"textarea":qw(r,s);break;case"select":var w=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?qo(r,!!s.multiple,E,!1):w!==!!s.multiple&&(s.defaultValue!=null?qo(r,!!s.multiple,s.defaultValue,!0):qo(r,!!s.multiple,s.multiple?[]:"",!1))}r[hl]=s}catch(R){se(n,n.return,R)}}break;case 6:if(Wn(t,n),oi(n),i&4){if(n.stateNode===null)throw Error(X(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(R){se(n,n.return,R)}}break;case 3:if(Wn(t,n),oi(n),i&4&&e!==null&&e.memoizedState.isDehydrated)try{ol(t.containerInfo)}catch(R){se(n,n.return,R)}break;case 4:Wn(t,n),oi(n);break;case 13:Wn(t,n),oi(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(Xm=ue())),i&4&&Fy(n);break;case 22:if(_=e!==null&&e.memoizedState!==null,n.mode&1?(He=(f=He)||_,Wn(t,n),He=f):Wn(t,n),oi(n),i&8192){if(f=n.memoizedState!==null,(n.stateNode.isHidden=f)&&!_&&n.mode&1)for(st=n,_=n.child;_!==null;){for(g=st=_;st!==null;){switch(w=st,E=w.child,w.tag){case 0:case 11:case 14:case 15:Wu(4,w,w.return);break;case 1:jo(w,w.return);var x=w.stateNode;if(typeof x.componentWillUnmount=="function"){i=w,e=w.return;try{t=i,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(R){se(i,e,R)}}break;case 5:jo(w,w.return);break;case 22:if(w.memoizedState!==null){zy(g);continue}}E!==null?(E.return=w,st=E):zy(g)}_=_.sibling}t:for(_=null,g=n;;){if(g.tag===5){if(_===null){_=g;try{r=g.stateNode,f?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=g.stateNode,h=g.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,l.style.display=Hw("display",a))}catch(R){se(n,n.return,R)}}}else if(g.tag===6){if(_===null)try{g.stateNode.nodeValue=f?"":g.memoizedProps}catch(R){se(n,n.return,R)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===n)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===n)break t;for(;g.sibling===null;){if(g.return===null||g.return===n)break t;_===g&&(_=null),g=g.return}_===g&&(_=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Wn(t,n),oi(n),i&4&&Fy(n);break;case 21:break;default:Wn(t,n),oi(n)}}function oi(n){var t=n.flags;if(t&2){try{t:{for(var e=n.return;e!==null;){if(vE(e)){var i=e;break t}e=e.return}throw Error(X(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(nl(r,""),i.flags&=-33);var s=Oy(n);Vp(n,s,r);break;case 3:case 4:var a=i.stateNode.containerInfo,l=Oy(n);Dp(n,l,a);break;default:throw Error(X(161))}}catch(h){se(n,n.return,h)}n.flags&=-3}t&4096&&(n.flags&=-4097)}function oA(n,t,e){st=n,TE(n)}function TE(n,t,e){for(var i=(n.mode&1)!==0;st!==null;){var r=st,s=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||Qc;if(!a){var l=r.alternate,h=l!==null&&l.memoizedState!==null||He;l=Qc;var f=He;if(Qc=a,(He=h)&&!f)for(st=r;st!==null;)a=st,h=a.child,a.tag===22&&a.memoizedState!==null?Uy(r):h!==null?(h.return=a,st=h):Uy(r);for(;s!==null;)st=s,TE(s),s=s.sibling;st=r,Qc=l,He=f}By(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,st=s):By(n)}}function By(n){for(;st!==null;){var t=st;if(t.flags&8772){var e=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:He||Td(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!He)if(e===null)i.componentDidMount();else{var r=t.elementType===t.type?e.memoizedProps:Hn(t.type,e.memoizedProps);i.componentDidUpdate(r,e.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Iy(t,s,i);break;case 3:var a=t.updateQueue;if(a!==null){if(e=null,t.child!==null)switch(t.child.tag){case 5:e=t.child.stateNode;break;case 1:e=t.child.stateNode}Iy(t,a,e)}break;case 5:var l=t.stateNode;if(e===null&&t.flags&4){e=l;var h=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&e.focus();break;case"img":h.src&&(e.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var _=f.memoizedState;if(_!==null){var g=_.dehydrated;g!==null&&ol(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}He||t.flags&512&&bp(t)}catch(w){se(t,t.return,w)}}if(t===n){st=null;break}if(e=t.sibling,e!==null){e.return=t.return,st=e;break}st=t.return}}function zy(n){for(;st!==null;){var t=st;if(t===n){st=null;break}var e=t.sibling;if(e!==null){e.return=t.return,st=e;break}st=t.return}}function Uy(n){for(;st!==null;){var t=st;try{switch(t.tag){case 0:case 11:case 15:var e=t.return;try{Td(4,t)}catch(h){se(t,e,h)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(h){se(t,r,h)}}var s=t.return;try{bp(t)}catch(h){se(t,s,h)}break;case 5:var a=t.return;try{bp(t)}catch(h){se(t,a,h)}}}catch(h){se(t,t.return,h)}if(t===n){st=null;break}var l=t.sibling;if(l!==null){l.return=t.return,st=l;break}st=t.return}}var aA=Math.ceil,Gh=Zi.ReactCurrentDispatcher,Qm=Zi.ReactCurrentOwner,Nn=Zi.ReactCurrentBatchConfig,Lt=0,be=null,ge=null,Fe=0,vn=0,$o=Kr(0),Ie=0,gl=null,Ds=0,Id=0,Ym=0,Hu=null,ln=null,Xm=0,ra=1/0,Di=null,Wh=!1,Mp=null,Lr=null,Yc=!1,Ir=null,Hh=0,Ku=0,Np=null,mh=-1,_h=0;function tn(){return Lt&6?ue():mh!==-1?mh:mh=ue()}function kr(n){return n.mode&1?Lt&2&&Fe!==0?Fe&-Fe:qS.transition!==null?(_h===0&&(_h=o0()),_h):(n=Mt,n!==0||(n=window.event,n=n===void 0?16:f0(n.type)),n):1}function Yn(n,t,e,i){if(50<Ku)throw Ku=0,Np=null,Error(X(185));Fl(n,e,i),(!(Lt&2)||n!==be)&&(n===be&&(!(Lt&2)&&(Id|=e),Ie===4&&vr(n,Fe)),_n(n,i),e===1&&Lt===0&&!(t.mode&1)&&(ra=ue()+500,vd&&Zr()))}function _n(n,t){var e=n.callbackNode;qP(n,t);var i=Lh(n,n===be?Fe:0);if(i===0)e!==null&&Qg(e),n.callbackNode=null,n.callbackPriority=0;else if(t=i&-i,n.callbackPriority!==t){if(e!=null&&Qg(e),t===1)n.tag===0?$S(jy.bind(null,n)):b0(jy.bind(null,n)),BS(function(){!(Lt&6)&&Zr()}),e=null;else{switch(a0(i)){case 1:e=Pm;break;case 4:e=r0;break;case 16:e=Rh;break;case 536870912:e=s0;break;default:e=Rh}e=LE(e,IE.bind(null,n))}n.callbackPriority=t,n.callbackNode=e}}function IE(n,t){if(mh=-1,_h=0,Lt&6)throw Error(X(327));var e=n.callbackNode;if(Zo()&&n.callbackNode!==e)return null;var i=Lh(n,n===be?Fe:0);if(i===0)return null;if(i&30||i&n.expiredLanes||t)t=Kh(n,i);else{t=i;var r=Lt;Lt|=2;var s=SE();(be!==n||Fe!==t)&&(Di=null,ra=ue()+500,xs(n,t));do try{cA();break}catch(l){PE(n,l)}while(1);Om(),Gh.current=s,Lt=r,ge!==null?t=0:(be=null,Fe=0,t=Ie)}if(t!==0){if(t===2&&(r=lp(n),r!==0&&(i=r,t=Op(n,r))),t===1)throw e=gl,xs(n,0),vr(n,i),_n(n,ue()),e;if(t===6)vr(n,i);else{if(r=n.current.alternate,!(i&30)&&!uA(r)&&(t=Kh(n,i),t===2&&(s=lp(n),s!==0&&(i=s,t=Op(n,s))),t===1))throw e=gl,xs(n,0),vr(n,i),_n(n,ue()),e;switch(n.finishedWork=r,n.finishedLanes=i,t){case 0:case 1:throw Error(X(345));case 2:ps(n,ln,Di);break;case 3:if(vr(n,i),(i&130023424)===i&&(t=Xm+500-ue(),10<t)){if(Lh(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){tn(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=gp(ps.bind(null,n,ln,Di),t);break}ps(n,ln,Di);break;case 4:if(vr(n,i),(i&4194240)===i)break;for(t=n.eventTimes,r=-1;0<i;){var a=31-Qn(i);s=1<<a,a=t[a],a>r&&(r=a),i&=~s}if(i=r,i=ue()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*aA(i/1960))-i,10<i){n.timeoutHandle=gp(ps.bind(null,n,ln,Di),i);break}ps(n,ln,Di);break;case 5:ps(n,ln,Di);break;default:throw Error(X(329))}}}return _n(n,ue()),n.callbackNode===e?IE.bind(null,n):null}function Op(n,t){var e=Hu;return n.current.memoizedState.isDehydrated&&(xs(n,t).flags|=256),n=Kh(n,t),n!==2&&(t=ln,ln=e,t!==null&&Fp(t)),n}function Fp(n){ln===null?ln=n:ln.push.apply(ln,n)}function uA(n){for(var t=n;;){if(t.flags&16384){var e=t.updateQueue;if(e!==null&&(e=e.stores,e!==null))for(var i=0;i<e.length;i++){var r=e[i],s=r.getSnapshot;r=r.value;try{if(!Xn(s(),r))return!1}catch{return!1}}}if(e=t.child,t.subtreeFlags&16384&&e!==null)e.return=t,t=e;else{if(t===n)break;for(;t.sibling===null;){if(t.return===null||t.return===n)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function vr(n,t){for(t&=~Ym,t&=~Id,n.suspendedLanes|=t,n.pingedLanes&=~t,n=n.expirationTimes;0<t;){var e=31-Qn(t),i=1<<e;n[e]=-1,t&=~i}}function jy(n){if(Lt&6)throw Error(X(327));Zo();var t=Lh(n,0);if(!(t&1))return _n(n,ue()),null;var e=Kh(n,t);if(n.tag!==0&&e===2){var i=lp(n);i!==0&&(t=i,e=Op(n,i))}if(e===1)throw e=gl,xs(n,0),vr(n,t),_n(n,ue()),e;if(e===6)throw Error(X(345));return n.finishedWork=n.current.alternate,n.finishedLanes=t,ps(n,ln,Di),_n(n,ue()),null}function Jm(n,t){var e=Lt;Lt|=1;try{return n(t)}finally{Lt=e,Lt===0&&(ra=ue()+500,vd&&Zr())}}function Vs(n){Ir!==null&&Ir.tag===0&&!(Lt&6)&&Zo();var t=Lt;Lt|=1;var e=Nn.transition,i=Mt;try{if(Nn.transition=null,Mt=1,n)return n()}finally{Mt=i,Nn.transition=e,Lt=t,!(Lt&6)&&Zr()}}function t_(){vn=$o.current,Gt($o)}function xs(n,t){n.finishedWork=null,n.finishedLanes=0;var e=n.timeoutHandle;if(e!==-1&&(n.timeoutHandle=-1,FS(e)),ge!==null)for(e=ge.return;e!==null;){var i=e;switch(Vm(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Mh();break;case 3:na(),Gt(pn),Gt(Ke),$m();break;case 5:jm(i);break;case 4:na();break;case 13:Gt(te);break;case 19:Gt(te);break;case 10:Fm(i.type._context);break;case 22:case 23:t_()}e=e.return}if(be=n,ge=n=br(n.current,null),Fe=vn=t,Ie=0,gl=null,Ym=Id=Ds=0,ln=Hu=null,Is!==null){for(t=0;t<Is.length;t++)if(e=Is[t],i=e.interleaved,i!==null){e.interleaved=null;var r=i.next,s=e.pending;if(s!==null){var a=s.next;s.next=r,i.next=a}e.pending=i}Is=null}return n}function PE(n,t){do{var e=ge;try{if(Om(),dh.current=qh,$h){for(var i=ee.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}$h=!1}if(bs=0,Le=Te=ee=null,Gu=!1,pl=0,Qm.current=null,e===null||e.return===null){Ie=1,gl=t,ge=null;break}t:{var s=n,a=e.return,l=e,h=t;if(t=Fe,l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var f=h,_=l,g=_.tag;if(!(_.mode&1)&&(g===0||g===11||g===15)){var w=_.alternate;w?(_.updateQueue=w.updateQueue,_.memoizedState=w.memoizedState,_.lanes=w.lanes):(_.updateQueue=null,_.memoizedState=null)}var E=Ry(a);if(E!==null){E.flags&=-257,Ly(E,a,l,s,t),E.mode&1&&Cy(s,f,t),t=E,h=f;var x=t.updateQueue;if(x===null){var R=new Set;R.add(h),t.updateQueue=R}else x.add(h);break t}else{if(!(t&1)){Cy(s,f,t),e_();break t}h=Error(X(426))}}else if(Kt&&l.mode&1){var z=Ry(a);if(z!==null){!(z.flags&65536)&&(z.flags|=256),Ly(z,a,l,s,t),Mm(ia(h,l));break t}}s=h=ia(h,l),Ie!==4&&(Ie=2),Hu===null?Hu=[s]:Hu.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var A=aE(s,h,t);Ty(s,A);break t;case 1:l=h;var S=s.type,C=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Lr===null||!Lr.has(C)))){s.flags|=65536,t&=-t,s.lanes|=t;var j=uE(s,l,t);Ty(s,j);break t}}s=s.return}while(s!==null)}xE(e)}catch(H){t=H,ge===e&&e!==null&&(ge=e=e.return);continue}break}while(1)}function SE(){var n=Gh.current;return Gh.current=qh,n===null?qh:n}function e_(){(Ie===0||Ie===3||Ie===2)&&(Ie=4),be===null||!(Ds&268435455)&&!(Id&268435455)||vr(be,Fe)}function Kh(n,t){var e=Lt;Lt|=2;var i=SE();(be!==n||Fe!==t)&&(Di=null,xs(n,t));do try{lA();break}catch(r){PE(n,r)}while(1);if(Om(),Lt=e,Gh.current=i,ge!==null)throw Error(X(261));return be=null,Fe=0,Ie}function lA(){for(;ge!==null;)AE(ge)}function cA(){for(;ge!==null&&!MP();)AE(ge)}function AE(n){var t=RE(n.alternate,n,vn);n.memoizedProps=n.pendingProps,t===null?xE(n):ge=t,Qm.current=null}function xE(n){var t=n;do{var e=t.alternate;if(n=t.return,t.flags&32768){if(e=iA(e,t),e!==null){e.flags&=32767,ge=e;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ie=6,ge=null;return}}else if(e=nA(e,t,vn),e!==null){ge=e;return}if(t=t.sibling,t!==null){ge=t;return}ge=t=n}while(t!==null);Ie===0&&(Ie=5)}function ps(n,t,e){var i=Mt,r=Nn.transition;try{Nn.transition=null,Mt=1,hA(n,t,e,i)}finally{Nn.transition=r,Mt=i}return null}function hA(n,t,e,i){do Zo();while(Ir!==null);if(Lt&6)throw Error(X(327));e=n.finishedWork;var r=n.finishedLanes;if(e===null)return null;if(n.finishedWork=null,n.finishedLanes=0,e===n.current)throw Error(X(177));n.callbackNode=null,n.callbackPriority=0;var s=e.lanes|e.childLanes;if(GP(n,s),n===be&&(ge=be=null,Fe=0),!(e.subtreeFlags&2064)&&!(e.flags&2064)||Yc||(Yc=!0,LE(Rh,function(){return Zo(),null})),s=(e.flags&15990)!==0,e.subtreeFlags&15990||s){s=Nn.transition,Nn.transition=null;var a=Mt;Mt=1;var l=Lt;Lt|=4,Qm.current=null,sA(n,e),EE(e,n),kS(mp),kh=!!pp,mp=pp=null,n.current=e,oA(e),NP(),Lt=l,Mt=a,Nn.transition=s}else n.current=e;if(Yc&&(Yc=!1,Ir=n,Hh=r),s=n.pendingLanes,s===0&&(Lr=null),BP(e.stateNode),_n(n,ue()),t!==null)for(i=n.onRecoverableError,e=0;e<t.length;e++)r=t[e],i(r.value,{componentStack:r.stack,digest:r.digest});if(Wh)throw Wh=!1,n=Mp,Mp=null,n;return Hh&1&&n.tag!==0&&Zo(),s=n.pendingLanes,s&1?n===Np?Ku++:(Ku=0,Np=n):Ku=0,Zr(),null}function Zo(){if(Ir!==null){var n=a0(Hh),t=Nn.transition,e=Mt;try{if(Nn.transition=null,Mt=16>n?16:n,Ir===null)var i=!1;else{if(n=Ir,Ir=null,Hh=0,Lt&6)throw Error(X(331));var r=Lt;for(Lt|=4,st=n.current;st!==null;){var s=st,a=s.child;if(st.flags&16){var l=s.deletions;if(l!==null){for(var h=0;h<l.length;h++){var f=l[h];for(st=f;st!==null;){var _=st;switch(_.tag){case 0:case 11:case 15:Wu(8,_,s)}var g=_.child;if(g!==null)g.return=_,st=g;else for(;st!==null;){_=st;var w=_.sibling,E=_.return;if(yE(_),_===f){st=null;break}if(w!==null){w.return=E,st=w;break}st=E}}}var x=s.alternate;if(x!==null){var R=x.child;if(R!==null){x.child=null;do{var z=R.sibling;R.sibling=null,R=z}while(R!==null)}}st=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,st=a;else t:for(;st!==null;){if(s=st,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wu(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,st=A;break t}st=s.return}}var S=n.current;for(st=S;st!==null;){a=st;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,st=C;else t:for(a=S;st!==null;){if(l=st,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Td(9,l)}}catch(H){se(l,l.return,H)}if(l===a){st=null;break t}var j=l.sibling;if(j!==null){j.return=l.return,st=j;break t}st=l.return}}if(Lt=r,Zr(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(pd,n)}catch{}i=!0}return i}finally{Mt=e,Nn.transition=t}}return!1}function $y(n,t,e){t=ia(e,t),t=aE(n,t,1),n=Rr(n,t,1),t=tn(),n!==null&&(Fl(n,1,t),_n(n,t))}function se(n,t,e){if(n.tag===3)$y(n,n,e);else for(;t!==null;){if(t.tag===3){$y(t,n,e);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Lr===null||!Lr.has(i))){n=ia(e,n),n=uE(t,n,1),t=Rr(t,n,1),n=tn(),t!==null&&(Fl(t,1,n),_n(t,n));break}}t=t.return}}function dA(n,t,e){var i=n.pingCache;i!==null&&i.delete(t),t=tn(),n.pingedLanes|=n.suspendedLanes&e,be===n&&(Fe&e)===e&&(Ie===4||Ie===3&&(Fe&130023424)===Fe&&500>ue()-Xm?xs(n,0):Ym|=e),_n(n,t)}function CE(n,t){t===0&&(n.mode&1?(t=Uc,Uc<<=1,!(Uc&130023424)&&(Uc=4194304)):t=1);var e=tn();n=qi(n,t),n!==null&&(Fl(n,t,e),_n(n,e))}function fA(n){var t=n.memoizedState,e=0;t!==null&&(e=t.retryLane),CE(n,e)}function pA(n,t){var e=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(e=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(X(314))}i!==null&&i.delete(t),CE(n,e)}var RE;RE=function(n,t,e){if(n!==null)if(n.memoizedProps!==t.pendingProps||pn.current)cn=!0;else{if(!(n.lanes&e)&&!(t.flags&128))return cn=!1,eA(n,t,e);cn=!!(n.flags&131072)}else cn=!1,Kt&&t.flags&1048576&&D0(t,Fh,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;ph(n,t),n=t.pendingProps;var r=Jo(t,Ke.current);Ko(t,e),r=Gm(null,t,i,n,r,e);var s=Wm();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mn(i)?(s=!0,Nh(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,zm(t),r.updater=Ed,t.stateNode=r,r._reactInternals=t,Pp(t,i,n,e),t=xp(null,t,i,!0,s,e)):(t.tag=0,Kt&&s&&Dm(t),Ye(null,t,r,e),t=t.child),t;case 16:i=t.elementType;t:{switch(ph(n,t),n=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=_A(i),n=Hn(i,n),r){case 0:t=Ap(null,t,i,n,e);break t;case 1:t=Dy(null,t,i,n,e);break t;case 11:t=ky(null,t,i,n,e);break t;case 14:t=by(null,t,i,Hn(i.type,n),e);break t}throw Error(X(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Hn(i,r),Ap(n,t,i,r,e);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Hn(i,r),Dy(n,t,i,r,e);case 3:t:{if(dE(t),n===null)throw Error(X(387));i=t.pendingProps,s=t.memoizedState,r=s.element,B0(n,t),Uh(t,i,null,e);var a=t.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=ia(Error(X(423)),t),t=Vy(n,t,i,e,r);break t}else if(i!==r){r=ia(Error(X(424)),t),t=Vy(n,t,i,e,r);break t}else for(wn=Cr(t.stateNode.containerInfo.firstChild),En=t,Kt=!0,Zn=null,e=O0(t,null,i,e),t.child=e;e;)e.flags=e.flags&-3|4096,e=e.sibling;else{if(ta(),i===r){t=Gi(n,t,e);break t}Ye(n,t,i,e)}t=t.child}return t;case 5:return z0(t),n===null&&Ep(t),i=t.type,r=t.pendingProps,s=n!==null?n.memoizedProps:null,a=r.children,_p(i,r)?a=null:s!==null&&_p(i,s)&&(t.flags|=32),hE(n,t),Ye(n,t,a,e),t.child;case 6:return n===null&&Ep(t),null;case 13:return fE(n,t,e);case 4:return Um(t,t.stateNode.containerInfo),i=t.pendingProps,n===null?t.child=ea(t,null,i,e):Ye(n,t,i,e),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Hn(i,r),ky(n,t,i,r,e);case 7:return Ye(n,t,t.pendingProps,e),t.child;case 8:return Ye(n,t,t.pendingProps.children,e),t.child;case 12:return Ye(n,t,t.pendingProps.children,e),t.child;case 10:t:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,zt(Bh,i._currentValue),i._currentValue=a,s!==null)if(Xn(s.value,a)){if(s.children===r.children&&!pn.current){t=Gi(n,t,e);break t}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var h=l.firstContext;h!==null;){if(h.context===i){if(s.tag===1){h=zi(-1,e&-e),h.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var _=f.pending;_===null?h.next=h:(h.next=_.next,_.next=h),f.pending=h}}s.lanes|=e,h=s.alternate,h!==null&&(h.lanes|=e),Tp(s.return,e,t),l.lanes|=e;break}h=h.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(X(341));a.lanes|=e,l=a.alternate,l!==null&&(l.lanes|=e),Tp(a,e,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ye(n,t,r.children,e),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ko(t,e),r=Fn(r),i=i(r),t.flags|=1,Ye(n,t,i,e),t.child;case 14:return i=t.type,r=Hn(i,t.pendingProps),r=Hn(i.type,r),by(n,t,i,r,e);case 15:return lE(n,t,t.type,t.pendingProps,e);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Hn(i,r),ph(n,t),t.tag=1,mn(i)?(n=!0,Nh(t)):n=!1,Ko(t,e),oE(t,i,r),Pp(t,i,r,e),xp(null,t,i,!0,n,e);case 19:return pE(n,t,e);case 22:return cE(n,t,e)}throw Error(X(156,t.tag))};function LE(n,t){return i0(n,t)}function mA(n,t,e,i){this.tag=n,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(n,t,e,i){return new mA(n,t,e,i)}function n_(n){return n=n.prototype,!(!n||!n.isReactComponent)}function _A(n){if(typeof n=="function")return n_(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Em)return 11;if(n===Tm)return 14}return 2}function br(n,t){var e=n.alternate;return e===null?(e=Vn(n.tag,t,n.key,n.mode),e.elementType=n.elementType,e.type=n.type,e.stateNode=n.stateNode,e.alternate=n,n.alternate=e):(e.pendingProps=t,e.type=n.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=n.flags&14680064,e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},e.sibling=n.sibling,e.index=n.index,e.ref=n.ref,e}function gh(n,t,e,i,r,s){var a=2;if(i=n,typeof n=="function")n_(n)&&(a=1);else if(typeof n=="string")a=5;else t:switch(n){case Do:return Cs(e.children,r,s,t);case wm:a=8,r|=8;break;case Kf:return n=Vn(12,e,t,r|2),n.elementType=Kf,n.lanes=s,n;case Zf:return n=Vn(13,e,t,r),n.elementType=Zf,n.lanes=s,n;case Qf:return n=Vn(19,e,t,r),n.elementType=Qf,n.lanes=s,n;case zw:return Pd(e,r,s,t);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Fw:a=10;break t;case Bw:a=9;break t;case Em:a=11;break t;case Tm:a=14;break t;case _r:a=16,i=null;break t}throw Error(X(130,n==null?n:typeof n,""))}return t=Vn(a,e,t,r),t.elementType=n,t.type=i,t.lanes=s,t}function Cs(n,t,e,i){return n=Vn(7,n,i,t),n.lanes=e,n}function Pd(n,t,e,i){return n=Vn(22,n,i,t),n.elementType=zw,n.lanes=e,n.stateNode={isHidden:!1},n}function Df(n,t,e){return n=Vn(6,n,null,t),n.lanes=e,n}function Vf(n,t,e){return t=Vn(4,n.children!==null?n.children:[],n.key,t),t.lanes=e,t.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},t}function gA(n,t,e,i,r){this.tag=t,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pf(0),this.expirationTimes=pf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pf(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function i_(n,t,e,i,r,s,a,l,h){return n=new gA(n,t,e,l,h),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Vn(3,null,null,t),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},zm(s),n}function yA(n,t,e){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bo,key:i==null?null:""+i,children:n,containerInfo:t,implementation:e}}function kE(n){if(!n)return Nr;n=n._reactInternals;t:{if(Ws(n)!==n||n.tag!==1)throw Error(X(170));var t=n;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(mn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(X(171))}if(n.tag===1){var e=n.type;if(mn(e))return k0(n,e,t)}return t}function bE(n,t,e,i,r,s,a,l,h){return n=i_(e,i,!0,n,r,s,a,l,h),n.context=kE(null),e=n.current,i=tn(),r=kr(e),s=zi(i,r),s.callback=t??null,Rr(e,s,r),n.current.lanes=r,Fl(n,r,i),_n(n,i),n}function Sd(n,t,e,i){var r=t.current,s=tn(),a=kr(r);return e=kE(e),t.context===null?t.context=e:t.pendingContext=e,t=zi(s,a),t.payload={element:n},i=i===void 0?null:i,i!==null&&(t.callback=i),n=Rr(r,t,a),n!==null&&(Yn(n,r,a,s),hh(n,r,a)),a}function Zh(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function qy(n,t){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var e=n.retryLane;n.retryLane=e!==0&&e<t?e:t}}function r_(n,t){qy(n,t),(n=n.alternate)&&qy(n,t)}function vA(){return null}var DE=typeof reportError=="function"?reportError:function(n){console.error(n)};function s_(n){this._internalRoot=n}Ad.prototype.render=s_.prototype.render=function(n){var t=this._internalRoot;if(t===null)throw Error(X(409));Sd(n,t,null,null)};Ad.prototype.unmount=s_.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var t=n.containerInfo;Vs(function(){Sd(null,n,null,null)}),t[$i]=null}};function Ad(n){this._internalRoot=n}Ad.prototype.unstable_scheduleHydration=function(n){if(n){var t=c0();n={blockedOn:null,target:n,priority:t};for(var e=0;e<yr.length&&t!==0&&t<yr[e].priority;e++);yr.splice(e,0,n),e===0&&d0(n)}};function o_(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function xd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Gy(){}function wA(n,t,e,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var f=Zh(a);s.call(f)}}var a=bE(t,i,n,0,null,!1,!1,"",Gy);return n._reactRootContainer=a,n[$i]=a.current,ll(n.nodeType===8?n.parentNode:n),Vs(),a}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var l=i;i=function(){var f=Zh(h);l.call(f)}}var h=i_(n,0,!1,null,null,!1,!1,"",Gy);return n._reactRootContainer=h,n[$i]=h.current,ll(n.nodeType===8?n.parentNode:n),Vs(function(){Sd(t,h,e,i)}),h}function Cd(n,t,e,i,r){var s=e._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var l=r;r=function(){var h=Zh(a);l.call(h)}}Sd(t,a,n,r)}else a=wA(e,t,n,r,i);return Zh(a)}u0=function(n){switch(n.tag){case 3:var t=n.stateNode;if(t.current.memoizedState.isDehydrated){var e=Vu(t.pendingLanes);e!==0&&(Sm(t,e|1),_n(t,ue()),!(Lt&6)&&(ra=ue()+500,Zr()))}break;case 13:Vs(function(){var i=qi(n,1);if(i!==null){var r=tn();Yn(i,n,1,r)}}),r_(n,1)}};Am=function(n){if(n.tag===13){var t=qi(n,134217728);if(t!==null){var e=tn();Yn(t,n,134217728,e)}r_(n,134217728)}};l0=function(n){if(n.tag===13){var t=kr(n),e=qi(n,t);if(e!==null){var i=tn();Yn(e,n,t,i)}r_(n,t)}};c0=function(){return Mt};h0=function(n,t){var e=Mt;try{return Mt=n,t()}finally{Mt=e}};op=function(n,t,e){switch(t){case"input":if(Jf(n,e),t=e.name,e.type==="radio"&&t!=null){for(e=n;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<e.length;t++){var i=e[t];if(i!==n&&i.form===n.form){var r=yd(i);if(!r)throw Error(X(90));jw(i),Jf(i,r)}}}break;case"textarea":qw(n,e);break;case"select":t=e.value,t!=null&&qo(n,!!e.multiple,t,!1)}};Yw=Jm;Xw=Vs;var EA={usingClientEntryPoint:!1,Events:[zl,Oo,yd,Zw,Qw,Jm]},Au={findFiberByHostInstance:Ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TA={bundleType:Au.bundleType,version:Au.version,rendererPackageName:Au.rendererPackageName,rendererConfig:Au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=e0(n),n===null?null:n.stateNode},findFiberByHostInstance:Au.findFiberByHostInstance||vA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xc.isDisabled&&Xc.supportsFiber)try{pd=Xc.inject(TA),hi=Xc}catch{}}Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EA;Pn.createPortal=function(n,t){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o_(t))throw Error(X(200));return yA(n,t,null,e)};Pn.createRoot=function(n,t){if(!o_(n))throw Error(X(299));var e=!1,i="",r=DE;return t!=null&&(t.unstable_strictMode===!0&&(e=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=i_(n,1,!1,null,null,e,!1,i,r),n[$i]=t.current,ll(n.nodeType===8?n.parentNode:n),new s_(t)};Pn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var t=n._reactInternals;if(t===void 0)throw typeof n.render=="function"?Error(X(188)):(n=Object.keys(n).join(","),Error(X(268,n)));return n=e0(t),n=n===null?null:n.stateNode,n};Pn.flushSync=function(n){return Vs(n)};Pn.hydrate=function(n,t,e){if(!xd(t))throw Error(X(200));return Cd(null,n,t,!0,e)};Pn.hydrateRoot=function(n,t,e){if(!o_(n))throw Error(X(405));var i=e!=null&&e.hydratedSources||null,r=!1,s="",a=DE;if(e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),t=bE(t,null,n,1,e??null,r,!1,s,a),n[$i]=t.current,ll(n),i)for(n=0;n<i.length;n++)e=i[n],r=e._getVersion,r=r(e._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[e,r]:t.mutableSourceEagerHydrationData.push(e,r);return new Ad(t)};Pn.render=function(n,t,e){if(!xd(t))throw Error(X(200));return Cd(null,n,t,!1,e)};Pn.unmountComponentAtNode=function(n){if(!xd(n))throw Error(X(40));return n._reactRootContainer?(Vs(function(){Cd(null,null,n,!1,function(){n._reactRootContainer=null,n[$i]=null})}),!0):!1};Pn.unstable_batchedUpdates=Jm;Pn.unstable_renderSubtreeIntoContainer=function(n,t,e,i){if(!xd(e))throw Error(X(200));if(n==null||n._reactInternals===void 0)throw Error(X(38));return Cd(n,t,e,!1,i)};Pn.version="18.3.1-next-f1338f8080-20240426";function VE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(VE)}catch(n){console.error(n)}}VE(),Vw.exports=Pn;var IA=Vw.exports,Wy=IA;Wf.createRoot=Wy.createRoot,Wf.hydrateRoot=Wy.hydrateRoot;var Bp={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,t){(function(e,i){i(t)})(Ew,function(e){var i="1.9.4";function r(o){var u,d,p,y;for(d=1,p=arguments.length;d<p;d++){y=arguments[d];for(u in y)o[u]=y[u]}return o}var s=Object.create||function(){function o(){}return function(u){return o.prototype=u,new o}}();function a(o,u){var d=Array.prototype.slice;if(o.bind)return o.bind.apply(o,d.call(arguments,1));var p=d.call(arguments,2);return function(){return o.apply(u,p.length?p.concat(d.call(arguments)):arguments)}}var l=0;function h(o){return"_leaflet_id"in o||(o._leaflet_id=++l),o._leaflet_id}function f(o,u,d){var p,y,T,M;return M=function(){p=!1,y&&(T.apply(d,y),y=!1)},T=function(){p?y=arguments:(o.apply(d,arguments),setTimeout(M,u),p=!0)},T}function _(o,u,d){var p=u[1],y=u[0],T=p-y;return o===p&&d?o:((o-y)%T+T)%T+y}function g(){return!1}function w(o,u){if(u===!1)return o;var d=Math.pow(10,u===void 0?6:u);return Math.round(o*d)/d}function E(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function x(o){return E(o).split(/\s+/)}function R(o,u){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?s(o.options):{});for(var d in u)o.options[d]=u[d];return o.options}function z(o,u,d){var p=[];for(var y in o)p.push(encodeURIComponent(d?y.toUpperCase():y)+"="+encodeURIComponent(o[y]));return(!u||u.indexOf("?")===-1?"?":"&")+p.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function S(o,u){return o.replace(A,function(d,p){var y=u[p];if(y===void 0)throw new Error("No value provided for variable "+d);return typeof y=="function"&&(y=y(u)),y})}var C=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function j(o,u){for(var d=0;d<o.length;d++)if(o[d]===u)return d;return-1}var H="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var k=0;function P(o){var u=+new Date,d=Math.max(0,16-(u-k));return k=u+d,window.setTimeout(o,d)}var b=window.requestAnimationFrame||Y("RequestAnimationFrame")||P,V=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function N(o,u,d){if(d&&b===P)o.call(u);else return b.call(window,a(o,u))}function O(o){o&&V.call(window,o)}var D={__proto__:null,extend:r,create:s,bind:a,get lastId(){return l},stamp:h,throttle:f,wrapNum:_,falseFn:g,formatNum:w,trim:E,splitWords:x,setOptions:R,getParamString:z,template:S,isArray:C,indexOf:j,emptyImageUrl:H,requestFn:b,cancelFn:V,requestAnimFrame:N,cancelAnimFrame:O};function Ft(){}Ft.extend=function(o){var u=function(){R(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=u.__super__=this.prototype,p=s(d);p.constructor=u,u.prototype=p;for(var y in this)Object.prototype.hasOwnProperty.call(this,y)&&y!=="prototype"&&y!=="__super__"&&(u[y]=this[y]);return o.statics&&r(u,o.statics),o.includes&&(An(o.includes),r.apply(null,[p].concat(o.includes))),r(p,o),delete p.statics,delete p.includes,p.options&&(p.options=d.options?s(d.options):{},r(p.options,o.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var T=0,M=p._initHooks.length;T<M;T++)p._initHooks[T].call(this)}},u},Ft.include=function(o){var u=this.prototype.options;return r(this.prototype,o),o.options&&(this.prototype.options=u,this.mergeOptions(o.options)),this},Ft.mergeOptions=function(o){return r(this.prototype.options,o),this},Ft.addInitHook=function(o){var u=Array.prototype.slice.call(arguments,1),d=typeof o=="function"?o:function(){this[o].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function An(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=C(o)?o:[o];for(var u=0;u<o.length;u++)o[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var re={on:function(o,u,d){if(typeof o=="object")for(var p in o)this._on(p,o[p],u);else{o=x(o);for(var y=0,T=o.length;y<T;y++)this._on(o[y],u,d)}return this},off:function(o,u,d){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var p in o)this._off(p,o[p],u);else{o=x(o);for(var y=arguments.length===1,T=0,M=o.length;T<M;T++)y?this._off(o[T]):this._off(o[T],u,d)}return this},_on:function(o,u,d,p){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(o,u,d)===!1){d===this&&(d=void 0);var y={fn:u,ctx:d};p&&(y.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(y)}},_off:function(o,u,d){var p,y,T;if(this._events&&(p=this._events[o],!!p)){if(arguments.length===1){if(this._firingCount)for(y=0,T=p.length;y<T;y++)p[y].fn=g;delete this._events[o];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var M=this._listens(o,u,d);if(M!==!1){var B=p[M];this._firingCount&&(B.fn=g,this._events[o]=p=p.slice()),p.splice(M,1)}}},fire:function(o,u,d){if(!this.listens(o,d))return this;var p=r({},u,{type:o,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var y=this._events[o];if(y){this._firingCount=this._firingCount+1||1;for(var T=0,M=y.length;T<M;T++){var B=y[T],$=B.fn;B.once&&this.off(o,$,B.ctx),$.call(B.ctx||this,p)}this._firingCount--}}return d&&this._propagateEvent(p),this},listens:function(o,u,d,p){typeof o!="string"&&console.warn('"string" type argument expected');var y=u;typeof u!="function"&&(p=!!u,y=void 0,d=void 0);var T=this._events&&this._events[o];if(T&&T.length&&this._listens(o,y,d)!==!1)return!0;if(p){for(var M in this._eventParents)if(this._eventParents[M].listens(o,u,d,p))return!0}return!1},_listens:function(o,u,d){if(!this._events)return!1;var p=this._events[o]||[];if(!u)return!!p.length;d===this&&(d=void 0);for(var y=0,T=p.length;y<T;y++)if(p[y].fn===u&&p[y].ctx===d)return y;return!1},once:function(o,u,d){if(typeof o=="object")for(var p in o)this._on(p,o[p],u,!0);else{o=x(o);for(var y=0,T=o.length;y<T;y++)this._on(o[y],u,d,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[h(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[h(o)],this},_propagateEvent:function(o){for(var u in this._eventParents)this._eventParents[u].fire(o.type,r({layer:o.target,propagatedFrom:o.target},o),!0)}};re.addEventListener=re.on,re.removeEventListener=re.clearAllEventListeners=re.off,re.addOneTimeEventListener=re.once,re.fireEvent=re.fire,re.hasEventListeners=re.listens;var Se=Ft.extend(re);function W(o,u,d){this.x=d?Math.round(o):o,this.y=d?Math.round(u):u}var lt=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(o){return this.clone()._add(J(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(J(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new W(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new W(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=lt(this.x),this.y=lt(this.y),this},distanceTo:function(o){o=J(o);var u=o.x-this.x,d=o.y-this.y;return Math.sqrt(u*u+d*d)},equals:function(o){return o=J(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=J(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function J(o,u,d){return o instanceof W?o:C(o)?new W(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new W(o.x,o.y):new W(o,u,d)}function ct(o,u){if(o)for(var d=u?[o,u]:o,p=0,y=d.length;p<y;p++)this.extend(d[p])}ct.prototype={extend:function(o){var u,d;if(!o)return this;if(o instanceof W||typeof o[0]=="number"||"x"in o)u=d=J(o);else if(o=dt(o),u=o.min,d=o.max,!u||!d)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=d.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(o){return J((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return J(this.min.x,this.max.y)},getTopRight:function(){return J(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var u,d;return typeof o[0]=="number"||o instanceof W?o=J(o):o=dt(o),o instanceof ct?(u=o.min,d=o.max):u=d=o,u.x>=this.min.x&&d.x<=this.max.x&&u.y>=this.min.y&&d.y<=this.max.y},intersects:function(o){o=dt(o);var u=this.min,d=this.max,p=o.min,y=o.max,T=y.x>=u.x&&p.x<=d.x,M=y.y>=u.y&&p.y<=d.y;return T&&M},overlaps:function(o){o=dt(o);var u=this.min,d=this.max,p=o.min,y=o.max,T=y.x>u.x&&p.x<d.x,M=y.y>u.y&&p.y<d.y;return T&&M},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var u=this.min,d=this.max,p=Math.abs(u.x-d.x)*o,y=Math.abs(u.y-d.y)*o;return dt(J(u.x-p,u.y-y),J(d.x+p,d.y+y))},equals:function(o){return o?(o=dt(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function dt(o,u){return!o||o instanceof ct?o:new ct(o,u)}function vt(o,u){if(o)for(var d=u?[o,u]:o,p=0,y=d.length;p<y;p++)this.extend(d[p])}vt.prototype={extend:function(o){var u=this._southWest,d=this._northEast,p,y;if(o instanceof wt)p=o,y=o;else if(o instanceof vt){if(p=o._southWest,y=o._northEast,!p||!y)return this}else return o?this.extend(pt(o)||bt(o)):this;return!u&&!d?(this._southWest=new wt(p.lat,p.lng),this._northEast=new wt(y.lat,y.lng)):(u.lat=Math.min(p.lat,u.lat),u.lng=Math.min(p.lng,u.lng),d.lat=Math.max(y.lat,d.lat),d.lng=Math.max(y.lng,d.lng)),this},pad:function(o){var u=this._southWest,d=this._northEast,p=Math.abs(u.lat-d.lat)*o,y=Math.abs(u.lng-d.lng)*o;return new vt(new wt(u.lat-p,u.lng-y),new wt(d.lat+p,d.lng+y))},getCenter:function(){return new wt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new wt(this.getNorth(),this.getWest())},getSouthEast:function(){return new wt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof wt||"lat"in o?o=pt(o):o=bt(o);var u=this._southWest,d=this._northEast,p,y;return o instanceof vt?(p=o.getSouthWest(),y=o.getNorthEast()):p=y=o,p.lat>=u.lat&&y.lat<=d.lat&&p.lng>=u.lng&&y.lng<=d.lng},intersects:function(o){o=bt(o);var u=this._southWest,d=this._northEast,p=o.getSouthWest(),y=o.getNorthEast(),T=y.lat>=u.lat&&p.lat<=d.lat,M=y.lng>=u.lng&&p.lng<=d.lng;return T&&M},overlaps:function(o){o=bt(o);var u=this._southWest,d=this._northEast,p=o.getSouthWest(),y=o.getNorthEast(),T=y.lat>u.lat&&p.lat<d.lat,M=y.lng>u.lng&&p.lng<d.lng;return T&&M},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,u){return o?(o=bt(o),this._southWest.equals(o.getSouthWest(),u)&&this._northEast.equals(o.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function bt(o,u){return o instanceof vt?o:new vt(o,u)}function wt(o,u,d){if(isNaN(o)||isNaN(u))throw new Error("Invalid LatLng object: ("+o+", "+u+")");this.lat=+o,this.lng=+u,d!==void 0&&(this.alt=+d)}wt.prototype={equals:function(o,u){if(!o)return!1;o=pt(o);var d=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return d<=(u===void 0?1e-9:u)},toString:function(o){return"LatLng("+w(this.lat,o)+", "+w(this.lng,o)+")"},distanceTo:function(o){return Jn.distance(this,pt(o))},wrap:function(){return Jn.wrapLatLng(this)},toBounds:function(o){var u=180*o/40075017,d=u/Math.cos(Math.PI/180*this.lat);return bt([this.lat-u,this.lng-d],[this.lat+u,this.lng+d])},clone:function(){return new wt(this.lat,this.lng,this.alt)}};function pt(o,u,d){return o instanceof wt?o:C(o)&&typeof o[0]!="object"?o.length===3?new wt(o[0],o[1],o[2]):o.length===2?new wt(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new wt(o.lat,"lng"in o?o.lng:o.lon,o.alt):u===void 0?null:new wt(o,u,d)}var de={latLngToPoint:function(o,u){var d=this.projection.project(o),p=this.scale(u);return this.transformation._transform(d,p)},pointToLatLng:function(o,u){var d=this.scale(u),p=this.transformation.untransform(o,d);return this.projection.unproject(p)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var u=this.projection.bounds,d=this.scale(o),p=this.transformation.transform(u.min,d),y=this.transformation.transform(u.max,d);return new ct(p,y)},infinite:!1,wrapLatLng:function(o){var u=this.wrapLng?_(o.lng,this.wrapLng,!0):o.lng,d=this.wrapLat?_(o.lat,this.wrapLat,!0):o.lat,p=o.alt;return new wt(d,u,p)},wrapLatLngBounds:function(o){var u=o.getCenter(),d=this.wrapLatLng(u),p=u.lat-d.lat,y=u.lng-d.lng;if(p===0&&y===0)return o;var T=o.getSouthWest(),M=o.getNorthEast(),B=new wt(T.lat-p,T.lng-y),$=new wt(M.lat-p,M.lng-y);return new vt(B,$)}},Jn=r({},de,{wrapLng:[-180,180],R:6371e3,distance:function(o,u){var d=Math.PI/180,p=o.lat*d,y=u.lat*d,T=Math.sin((u.lat-o.lat)*d/2),M=Math.sin((u.lng-o.lng)*d/2),B=T*T+Math.cos(p)*Math.cos(y)*M*M,$=2*Math.atan2(Math.sqrt(B),Math.sqrt(1-B));return this.R*$}}),ec=6378137,Ji={R:ec,MAX_LATITUDE:85.0511287798,project:function(o){var u=Math.PI/180,d=this.MAX_LATITUDE,p=Math.max(Math.min(d,o.lat),-d),y=Math.sin(p*u);return new W(this.R*o.lng*u,this.R*Math.log((1+y)/(1-y))/2)},unproject:function(o){var u=180/Math.PI;return new wt((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*u,o.x*u/this.R)},bounds:function(){var o=ec*Math.PI;return new ct([-o,-o],[o,o])}()};function tr(o,u,d,p){if(C(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=u,this._c=d,this._d=p}tr.prototype={transform:function(o,u){return this._transform(o.clone(),u)},_transform:function(o,u){return u=u||1,o.x=u*(this._a*o.x+this._b),o.y=u*(this._c*o.y+this._d),o},untransform:function(o,u){return u=u||1,new W((o.x/u-this._b)/this._a,(o.y/u-this._d)/this._c)}};function yi(o,u,d,p){return new tr(o,u,d,p)}var ts=r({},Jn,{code:"EPSG:3857",projection:Ji,transformation:function(){var o=.5/(Math.PI*Ji.R);return yi(o,.5,-o,.5)}()}),ba=r({},ts,{code:"EPSG:900913"});function Js(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Da(o,u){var d="",p,y,T,M,B,$;for(p=0,T=o.length;p<T;p++){for(B=o[p],y=0,M=B.length;y<M;y++)$=B[y],d+=(y?"L":"M")+$.x+" "+$.y;d+=u?at.svg?"z":"x":""}return d||"M0 0"}var to=document.documentElement.style,eo="ActiveXObject"in window,nc=eo&&!document.addEventListener,Va="msLaunchUri"in navigator&&!("documentMode"in document),es=Ue("webkit"),Ma=Ue("android"),ic=Ue("android 2")||Ue("android 3"),Na=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Oa=Ma&&Ue("Google")&&Na<537&&!("AudioNode"in window),ns=!!window.opera,ve=!Va&&Ue("chrome"),Ae=Ue("gecko")&&!es&&!ns&&!eo,no=!ve&&Ue("safari"),Fa=Ue("phantom"),Ba="OTransition"in to,Jd=navigator.platform.indexOf("Win")===0,er=eo&&"transition"in to,io="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ic,za="MozPerspective"in to,Ua=!window.L_DISABLE_3D&&(er||io||za)&&!Ba&&!Fa,is=typeof orientation<"u"||Ue("mobile"),tf=is&&es,ja=is&&io,$a=!window.PointerEvent&&window.MSPointerEvent,qa=!!(window.PointerEvent||$a),nr="ontouchstart"in window||!!window.TouchEvent,Ga=!window.L_NO_TOUCH&&(nr||qa),Wa=is&&ns,vi=is&&Ae,rc=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ro=function(){var o=!1;try{var u=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",g,u),window.removeEventListener("testPassiveEventSupport",g,u)}catch{}return o}(),sc=function(){return!!document.createElement("canvas").getContext}(),wi=!!(document.createElementNS&&Js("svg").createSVGRect),oc=!!wi&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),De=!wi&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var u=o.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}}(),ac=navigator.platform.indexOf("Mac")===0,rs=navigator.platform.indexOf("Linux")===0;function Ue(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var at={ie:eo,ielt9:nc,edge:Va,webkit:es,android:Ma,android23:ic,androidStock:Oa,opera:ns,chrome:ve,gecko:Ae,safari:no,phantom:Fa,opera12:Ba,win:Jd,ie3d:er,webkit3d:io,gecko3d:za,any3d:Ua,mobile:is,mobileWebkit:tf,mobileWebkit3d:ja,msPointer:$a,pointer:qa,touch:Ga,touchNative:nr,mobileOpera:Wa,mobileGecko:vi,retina:rc,passiveEvents:ro,canvas:sc,svg:wi,vml:De,inlineSvg:oc,mac:ac,linux:rs},uc=at.msPointer?"MSPointerDown":"pointerdown",Ei=at.msPointer?"MSPointerMove":"pointermove",lc=at.msPointer?"MSPointerUp":"pointerup",cc=at.msPointer?"MSPointerCancel":"pointercancel",ir={touchstart:uc,touchmove:Ei,touchend:lc,touchcancel:cc},Ha={touchstart:ef,touchmove:os,touchend:os,touchcancel:os},ti={},ss=!1;function ei(o,u,d){return u==="touchstart"&&fc(),Ha[u]?(d=Ha[u].bind(this,d),o.addEventListener(ir[u],d,!1),d):(console.warn("wrong event specified:",u),g)}function hc(o,u,d){if(!ir[u]){console.warn("wrong event specified:",u);return}o.removeEventListener(ir[u],d,!1)}function dc(o){ti[o.pointerId]=o}function Ka(o){ti[o.pointerId]&&(ti[o.pointerId]=o)}function so(o){delete ti[o.pointerId]}function fc(){ss||(document.addEventListener(uc,dc,!0),document.addEventListener(Ei,Ka,!0),document.addEventListener(lc,so,!0),document.addEventListener(cc,so,!0),ss=!0)}function os(o,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var d in ti)u.touches.push(ti[d]);u.changedTouches=[u],o(u)}}function ef(o,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&pe(u),os(o,u)}function oo(o){var u={},d,p;for(p in o)d=o[p],u[p]=d&&d.bind?d.bind(o):d;return o=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var pc=200;function Za(o,u){o.addEventListener("dblclick",u);var d=0,p;function y(T){if(T.detail!==1){p=T.detail;return}if(!(T.pointerType==="mouse"||T.sourceCapabilities&&!T.sourceCapabilities.firesTouchEvents)){var M=ar(T);if(!(M.some(function($){return $ instanceof HTMLLabelElement&&$.attributes.for})&&!M.some(function($){return $ instanceof HTMLInputElement||$ instanceof HTMLSelectElement}))){var B=Date.now();B-d<=pc?(p++,p===2&&u(oo(T))):p=1,d=B}}}return o.addEventListener("click",y),{dblclick:u,simDblclick:y}}function as(o,u){o.removeEventListener("dblclick",u.dblclick),o.removeEventListener("click",u.simDblclick)}var zn=Si(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ti=Si(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mc=Ti==="webkitTransition"||Ti==="OTransition"?Ti+"End":"transitionend";function Qa(o){return typeof o=="string"?document.getElementById(o):o}function rr(o,u){var d=o.style[u]||o.currentStyle&&o.currentStyle[u];if((!d||d==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(o,null);d=p?p[u]:null}return d==="auto"?null:d}function At(o,u,d){var p=document.createElement(o);return p.className=u||"",d&&d.appendChild(p),p}function Bt(o){var u=o.parentNode;u&&u.removeChild(o)}function sr(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Ii(o){var u=o.parentNode;u&&u.lastChild!==o&&u.appendChild(o)}function Pi(o){var u=o.parentNode;u&&u.firstChild!==o&&u.insertBefore(o,u.firstChild)}function Ya(o,u){if(o.classList!==void 0)return o.classList.contains(u);var d=uo(o);return d.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(d)}function gt(o,u){if(o.classList!==void 0)for(var d=x(u),p=0,y=d.length;p<y;p++)o.classList.add(d[p]);else if(!Ya(o,u)){var T=uo(o);ao(o,(T?T+" ":"")+u)}}function Wt(o,u){o.classList!==void 0?o.classList.remove(u):ao(o,E((" "+uo(o)+" ").replace(" "+u+" "," ")))}function ao(o,u){o.className.baseVal===void 0?o.className=u:o.className.baseVal=u}function uo(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function fe(o,u){"opacity"in o.style?o.style.opacity=u:"filter"in o.style&&Un(o,u)}function Un(o,u){var d=!1,p="DXImageTransform.Microsoft.Alpha";try{d=o.filters.item(p)}catch{if(u===1)return}u=Math.round(u*100),d?(d.Enabled=u!==100,d.Opacity=u):o.style.filter+=" progid:"+p+"(opacity="+u+")"}function Si(o){for(var u=document.documentElement.style,d=0;d<o.length;d++)if(o[d]in u)return o[d];return!1}function xn(o,u,d){var p=u||new W(0,0);o.style[zn]=(at.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(d?" scale("+d+")":"")}function Xt(o,u){o._leaflet_pos=u,at.any3d?xn(o,u):(o.style.left=u.x+"px",o.style.top=u.y+"px")}function Rt(o){return o._leaflet_pos||new W(0,0)}var ni,jn,Ai;if("onselectstart"in document)ni=function(){ft(window,"selectstart",pe)},jn=function(){Nt(window,"selectstart",pe)};else{var us=Si(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ni=function(){if(us){var o=document.documentElement.style;Ai=o[us],o[us]="none"}},jn=function(){us&&(document.documentElement.style[us]=Ai,Ai=void 0)}}function lo(){ft(window,"dragstart",pe)}function Xa(){Nt(window,"dragstart",pe)}var co,Ja;function tu(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(ii(),co=o,Ja=o.style.outlineStyle,o.style.outlineStyle="none",ft(window,"keydown",ii))}function ii(){co&&(co.style.outlineStyle=Ja,co=void 0,Ja=void 0,Nt(window,"keydown",ii))}function $n(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function ho(o){var u=o.getBoundingClientRect();return{x:u.width/o.offsetWidth||1,y:u.height/o.offsetHeight||1,boundingClientRect:u}}var _c={__proto__:null,TRANSFORM:zn,TRANSITION:Ti,TRANSITION_END:mc,get:Qa,getStyle:rr,create:At,remove:Bt,empty:sr,toFront:Ii,toBack:Pi,hasClass:Ya,addClass:gt,removeClass:Wt,setClass:ao,getClass:uo,setOpacity:fe,testProp:Si,setTransform:xn,setPosition:Xt,getPosition:Rt,get disableTextSelection(){return ni},get enableTextSelection(){return jn},disableImageDrag:lo,enableImageDrag:Xa,preventOutline:tu,restoreOutline:ii,getSizedParentNode:$n,getScale:ho};function ft(o,u,d,p){if(u&&typeof u=="object")for(var y in u)Cn(o,y,u[y],d);else{u=x(u);for(var T=0,M=u.length;T<M;T++)Cn(o,u[T],d,p)}return this}var Ve="_leaflet_events";function Nt(o,u,d,p){if(arguments.length===1)gc(o),delete o[Ve];else if(u&&typeof u=="object")for(var y in u)nu(o,y,u[y],d);else if(u=x(u),arguments.length===2)gc(o,function(B){return j(u,B)!==-1});else for(var T=0,M=u.length;T<M;T++)nu(o,u[T],d,p);return this}function gc(o,u){for(var d in o[Ve]){var p=d.split(/\d/)[0];(!u||u(p))&&nu(o,p,null,null,d)}}var eu={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Cn(o,u,d,p){var y=u+h(d)+(p?"_"+h(p):"");if(o[Ve]&&o[Ve][y])return this;var T=function(B){return d.call(p||o,B||window.event)},M=T;!at.touchNative&&at.pointer&&u.indexOf("touch")===0?T=ei(o,u,T):at.touch&&u==="dblclick"?T=Za(o,T):"addEventListener"in o?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?o.addEventListener(eu[u]||u,T,at.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(T=function(B){B=B||window.event,su(o,B)&&M(B)},o.addEventListener(eu[u],T,!1)):o.addEventListener(u,M,!1):o.attachEvent("on"+u,T),o[Ve]=o[Ve]||{},o[Ve][y]=T}function nu(o,u,d,p,y){y=y||u+h(d)+(p?"_"+h(p):"");var T=o[Ve]&&o[Ve][y];if(!T)return this;!at.touchNative&&at.pointer&&u.indexOf("touch")===0?hc(o,u,T):at.touch&&u==="dblclick"?as(o,T):"removeEventListener"in o?o.removeEventListener(eu[u]||u,T,!1):o.detachEvent("on"+u,T),o[Ve][y]=null}function xi(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function or(o){return Cn(o,"wheel",xi),this}function ri(o){return ft(o,"mousedown touchstart dblclick contextmenu",xi),o._leaflet_disable_click=!0,this}function pe(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function gn(o){return pe(o),xi(o),this}function ar(o){if(o.composedPath)return o.composedPath();for(var u=[],d=o.target;d;)u.push(d),d=d.parentNode;return u}function iu(o,u){if(!u)return new W(o.clientX,o.clientY);var d=ho(u),p=d.boundingClientRect;return new W((o.clientX-p.left)/d.x-u.clientLeft,(o.clientY-p.top)/d.y-u.clientTop)}var ru=at.linux&&at.chrome?window.devicePixelRatio:at.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function jt(o){return at.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/ru:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function su(o,u){var d=u.relatedTarget;if(!d)return!0;try{for(;d&&d!==o;)d=d.parentNode}catch{return!1}return d!==o}var nf={__proto__:null,on:ft,off:Nt,stopPropagation:xi,disableScrollPropagation:or,disableClickPropagation:ri,preventDefault:pe,stop:gn,getPropagationPath:ar,getMousePosition:iu,getWheelDelta:jt,isExternalTarget:su,addListener:ft,removeListener:Nt},ou=Se.extend({run:function(o,u,d,p){this.stop(),this._el=o,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=Rt(o),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=N(this._animate,this),this._step()},_step:function(o){var u=+new Date-this._startTime,d=this._duration*1e3;u<d?this._runFrame(this._easeOut(u/d),o):(this._runFrame(1),this._complete())},_runFrame:function(o,u){var d=this._startPos.add(this._offset.multiplyBy(o));u&&d._round(),Xt(this._el,d),this.fire("step")},_complete:function(){O(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Tt=Se.extend({options:{crs:ts,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,u){u=R(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(pt(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ti&&at.any3d&&!at.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ft(this._proxy,mc,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,u,d){if(u=u===void 0?this._zoom:this._limitZoom(u),o=this._limitCenter(pt(o),u,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=r({animate:d.animate},d.zoom),d.pan=r({animate:d.animate,duration:d.duration},d.pan));var p=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,u,d.zoom):this._tryAnimatedPan(o,d.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(o,u,d.pan&&d.pan.noMoveStart),this},setZoom:function(o,u){return this._loaded?this.setView(this.getCenter(),o,{zoom:u}):(this._zoom=o,this)},zoomIn:function(o,u){return o=o||(at.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,u)},zoomOut:function(o,u){return o=o||(at.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,u)},setZoomAround:function(o,u,d){var p=this.getZoomScale(u),y=this.getSize().divideBy(2),T=o instanceof W?o:this.latLngToContainerPoint(o),M=T.subtract(y).multiplyBy(1-1/p),B=this.containerPointToLatLng(y.add(M));return this.setView(B,u,{zoom:d})},_getBoundsCenterZoom:function(o,u){u=u||{},o=o.getBounds?o.getBounds():bt(o);var d=J(u.paddingTopLeft||u.padding||[0,0]),p=J(u.paddingBottomRight||u.padding||[0,0]),y=this.getBoundsZoom(o,!1,d.add(p));if(y=typeof u.maxZoom=="number"?Math.min(u.maxZoom,y):y,y===1/0)return{center:o.getCenter(),zoom:y};var T=p.subtract(d).divideBy(2),M=this.project(o.getSouthWest(),y),B=this.project(o.getNorthEast(),y),$=this.unproject(M.add(B).divideBy(2).add(T),y);return{center:$,zoom:y}},fitBounds:function(o,u){if(o=bt(o),!o.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(o,u);return this.setView(d.center,d.zoom,u)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,u){return this.setView(o,this._zoom,{pan:u})},panBy:function(o,u){if(o=J(o).round(),u=u||{},!o.x&&!o.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ou,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){gt(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,d,u.duration||.25,u.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,u,d){if(d=d||{},d.animate===!1||!at.any3d)return this.setView(o,u,d);this._stop();var p=this.project(this.getCenter()),y=this.project(o),T=this.getSize(),M=this._zoom;o=pt(o),u=u===void 0?M:u;var B=Math.max(T.x,T.y),$=B*this.getZoomScale(M,u),K=y.distanceTo(p)||1,it=1.42,ht=it*it;function Et(me){var Mc=me?-1:1,H1=me?$:B,K1=$*$-B*B+Mc*ht*ht*K*K,Z1=2*H1*ht*K,uf=K1/Z1,Og=Math.sqrt(uf*uf+1)-uf,Q1=Og<1e-9?-18:Math.log(Og);return Q1}function Qe(me){return(Math.exp(me)-Math.exp(-me))/2}function Ce(me){return(Math.exp(me)+Math.exp(-me))/2}function kn(me){return Qe(me)/Ce(me)}var an=Et(0);function Eo(me){return B*(Ce(an)/Ce(an+it*me))}function $1(me){return B*(Ce(an)*kn(an+it*me)-Qe(an))/ht}function q1(me){return 1-Math.pow(1-me,1.5)}var G1=Date.now(),Mg=(Et(1)-an)/it,W1=d.duration?1e3*d.duration:1e3*Mg*.8;function Ng(){var me=(Date.now()-G1)/W1,Mc=q1(me)*Mg;me<=1?(this._flyToFrame=N(Ng,this),this._move(this.unproject(p.add(y.subtract(p).multiplyBy($1(Mc)/K)),M),this.getScaleZoom(B/Eo(Mc),M),{flyTo:!0})):this._move(o,u)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),Ng.call(this),this},flyToBounds:function(o,u){var d=this._getBoundsCenterZoom(o,u);return this.flyTo(d.center,d.zoom,u)},setMaxBounds:function(o){return o=bt(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var u=this.options.minZoom;return this.options.minZoom=o,this._loaded&&u!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var u=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&u!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,u){this._enforcingBounds=!0;var d=this.getCenter(),p=this._limitCenter(d,this._zoom,bt(o));return d.equals(p)||this.panTo(p,u),this._enforcingBounds=!1,this},panInside:function(o,u){u=u||{};var d=J(u.paddingTopLeft||u.padding||[0,0]),p=J(u.paddingBottomRight||u.padding||[0,0]),y=this.project(this.getCenter()),T=this.project(o),M=this.getPixelBounds(),B=dt([M.min.add(d),M.max.subtract(p)]),$=B.getSize();if(!B.contains(T)){this._enforcingBounds=!0;var K=T.subtract(B.getCenter()),it=B.extend(T).getSize().subtract($);y.x+=K.x<0?-it.x:it.x,y.y+=K.y<0?-it.y:it.y,this.panTo(this.unproject(y),u),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=r({animate:!1,pan:!0},o===!0?{animate:!0}:o);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),p=u.divideBy(2).round(),y=d.divideBy(2).round(),T=p.subtract(y);return!T.x&&!T.y?this:(o.animate&&o.pan?this.panBy(T):(o.pan&&this._rawPanBy(T),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=r({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=a(this._handleGeolocationResponse,this),d=a(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,d,o):navigator.geolocation.getCurrentPosition(u,d,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var u=o.code,d=o.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var u=o.coords.latitude,d=o.coords.longitude,p=new wt(u,d),y=p.toBounds(o.coords.accuracy*2),T=this._locateOptions;if(T.setView){var M=this.getBoundsZoom(y);this.setView(p,T.maxZoom?Math.min(M,T.maxZoom):M)}var B={latlng:p,bounds:y,timestamp:o.timestamp};for(var $ in o.coords)typeof o.coords[$]=="number"&&(B[$]=o.coords[$]);this.fire("locationfound",B)}},addHandler:function(o,u){if(!u)return this;var d=this[o]=new u(this);return this._handlers.push(d),this.options[o]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Bt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(O(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)Bt(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,u){var d="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),p=At("div",d,u||this._mapPane);return o&&(this._panes[o]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),u=this.unproject(o.getBottomLeft()),d=this.unproject(o.getTopRight());return new vt(u,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,u,d){o=bt(o),d=J(d||[0,0]);var p=this.getZoom()||0,y=this.getMinZoom(),T=this.getMaxZoom(),M=o.getNorthWest(),B=o.getSouthEast(),$=this.getSize().subtract(d),K=dt(this.project(B,p),this.project(M,p)).getSize(),it=at.any3d?this.options.zoomSnap:1,ht=$.x/K.x,Et=$.y/K.y,Qe=u?Math.max(ht,Et):Math.min(ht,Et);return p=this.getScaleZoom(Qe,p),it&&(p=Math.round(p/(it/100))*(it/100),p=u?Math.ceil(p/it)*it:Math.floor(p/it)*it),Math.max(y,Math.min(T,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,u){var d=this._getTopLeftPoint(o,u);return new ct(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,u){var d=this.options.crs;return u=u===void 0?this._zoom:u,d.scale(o)/d.scale(u)},getScaleZoom:function(o,u){var d=this.options.crs;u=u===void 0?this._zoom:u;var p=d.zoom(o*d.scale(u));return isNaN(p)?1/0:p},project:function(o,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(pt(o),u)},unproject:function(o,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(J(o),u)},layerPointToLatLng:function(o){var u=J(o).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(o){var u=this.project(pt(o))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(pt(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(bt(o))},distance:function(o,u){return this.options.crs.distance(pt(o),pt(u))},containerPointToLayerPoint:function(o){return J(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return J(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var u=this.containerPointToLayerPoint(J(o));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pt(o)))},mouseEventToContainerPoint:function(o){return iu(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var u=this._container=Qa(o);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ft(u,"scroll",this._onScroll,this),this._containerId=h(u)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&at.any3d,gt(o,"leaflet-container"+(at.touch?" leaflet-touch":"")+(at.retina?" leaflet-retina":"")+(at.ielt9?" leaflet-oldie":"")+(at.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=rr(o,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Xt(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(gt(o.markerPane,"leaflet-zoom-hide"),gt(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,u,d){Xt(this._mapPane,new W(0,0));var p=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var y=this._zoom!==u;this._moveStart(y,d)._move(o,u)._moveEnd(y),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(o,u){return o&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(o,u,d,p){u===void 0&&(u=this._zoom);var y=this._zoom!==u;return this._zoom=u,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),p?d&&d.pinch&&this.fire("zoom",d):((y||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return O(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){Xt(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[h(this._container)]=this;var u=o?Nt:ft;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),at.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){O(this._resizeRequest),this._resizeRequest=N(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,u){for(var d=[],p,y=u==="mouseout"||u==="mouseover",T=o.target||o.srcElement,M=!1;T;){if(p=this._targets[h(T)],p&&(u==="click"||u==="preclick")&&this._draggableMoved(p)){M=!0;break}if(p&&p.listens(u,!0)&&(y&&!su(T,o)||(d.push(p),y))||T===this._container)break;T=T.parentNode}return!d.length&&!M&&!y&&this.listens(u,!0)&&(d=[this]),d},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var u=o.target||o.srcElement;if(!(!this._loaded||u._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(u))){var d=o.type;d==="mousedown"&&tu(u),this._fireDOMEvent(o,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,u,d){if(o.type==="click"){var p=r({},o);p.type="preclick",this._fireDOMEvent(p,p.type,d)}var y=this._findEventTargets(o,u);if(d){for(var T=[],M=0;M<d.length;M++)d[M].listens(u,!0)&&T.push(d[M]);y=T.concat(y)}if(y.length){u==="contextmenu"&&pe(o);var B=y[0],$={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var K=B.getLatLng&&(!B._radius||B._radius<=10);$.containerPoint=K?this.latLngToContainerPoint(B.getLatLng()):this.mouseEventToContainerPoint(o),$.layerPoint=this.containerPointToLayerPoint($.containerPoint),$.latlng=K?B.getLatLng():this.layerPointToLatLng($.layerPoint)}for(M=0;M<y.length;M++)if(y[M].fire(u,$,!0),$.originalEvent._stopped||y[M].options.bubblingMouseEvents===!1&&j(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,u=this._handlers.length;o<u;o++)this._handlers[o].disable()},whenReady:function(o,u){return this._loaded?o.call(u||this,{target:this}):this.on("load",o,u),this},_getMapPanePos:function(){return Rt(this._mapPane)||new W(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,u){var d=o&&u!==void 0?this._getNewPixelOrigin(o,u):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,u){var d=this.getSize()._divideBy(2);return this.project(o,u)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,u,d){var p=this._getNewPixelOrigin(d,u);return this.project(o,u)._subtract(p)},_latLngBoundsToNewLayerBounds:function(o,u,d){var p=this._getNewPixelOrigin(d,u);return dt([this.project(o.getSouthWest(),u)._subtract(p),this.project(o.getNorthWest(),u)._subtract(p),this.project(o.getSouthEast(),u)._subtract(p),this.project(o.getNorthEast(),u)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,u,d){if(!d)return o;var p=this.project(o,u),y=this.getSize().divideBy(2),T=new ct(p.subtract(y),p.add(y)),M=this._getBoundsOffset(T,d,u);return Math.abs(M.x)<=1&&Math.abs(M.y)<=1?o:this.unproject(p.add(M),u)},_limitOffset:function(o,u){if(!u)return o;var d=this.getPixelBounds(),p=new ct(d.min.add(o),d.max.add(o));return o.add(this._getBoundsOffset(p,u))},_getBoundsOffset:function(o,u,d){var p=dt(this.project(u.getNorthEast(),d),this.project(u.getSouthWest(),d)),y=p.min.subtract(o.min),T=p.max.subtract(o.max),M=this._rebound(y.x,-T.x),B=this._rebound(y.y,-T.y);return new W(M,B)},_rebound:function(o,u){return o+u>0?Math.round(o-u)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(u))},_limitZoom:function(o){var u=this.getMinZoom(),d=this.getMaxZoom(),p=at.any3d?this.options.zoomSnap:1;return p&&(o=Math.round(o/p)*p),Math.max(u,Math.min(d,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Wt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,u){var d=this._getCenterOffset(o)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,u),!0)},_createAnimProxy:function(){var o=this._proxy=At("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(u){var d=zn,p=this._proxy.style[d];xn(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),p===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Bt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),u=this.getZoom();xn(this._proxy,this.project(o,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,u,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(u),y=this._getCenterOffset(o)._divideBy(1-1/p);return d.animate!==!0&&!this.getSize().contains(y)?!1:(N(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(o,u,!0)},this),!0)},_animateZoom:function(o,u,d,p){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=u,gt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:u,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Wt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function yc(o,u){return new Tt(o,u)}var je=Ft.extend({options:{position:"topright"},initialize:function(o){R(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var u=this._map;return u&&u.removeControl(this),this.options.position=o,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var u=this._container=this.onAdd(o),d=this.getPosition(),p=o._controlCorners[d];return gt(u,"leaflet-control"),d.indexOf("bottom")!==-1?p.insertBefore(u,p.firstChild):p.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Bt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),ur=function(o){return new je(o)};Tt.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},u="leaflet-",d=this._controlContainer=At("div",u+"control-container",this._container);function p(y,T){var M=u+y+" "+u+T;o[y+T]=At("div",M,d)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)Bt(this._controlCorners[o]);Bt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Rn=je.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,u,d,p){return d<p?-1:p<d?1:0}},initialize:function(o,u,d){R(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in o)this._addLayer(o[p],p);for(p in u)this._addLayer(u[p],p,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return je.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,u){return this._addLayer(o,u),this._map?this._update():this},addOverlay:function(o,u){return this._addLayer(o,u,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var u=this._getLayer(h(o));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){gt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(gt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):Wt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Wt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",u=this._container=At("div",o),d=this.options.collapsed;u.setAttribute("aria-haspopup",!0),ri(u),or(u);var p=this._section=At("section",o+"-list");d&&(this._map.on("click",this.collapse,this),ft(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var y=this._layersLink=At("a",o+"-toggle",u);y.href="#",y.title="Layers",y.setAttribute("role","button"),ft(y,{keydown:function(T){T.keyCode===13&&this._expandSafely()},click:function(T){pe(T),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=At("div",o+"-base",p),this._separator=At("div",o+"-separator",p),this._overlaysList=At("div",o+"-overlays",p),u.appendChild(p)},_getLayer:function(o){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&h(this._layers[u].layer)===o)return this._layers[u]},_addLayer:function(o,u,d){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:u,overlay:d}),this.options.sortLayers&&this._layers.sort(a(function(p,y){return this.options.sortFunction(p.layer,y.layer,p.name,y.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;sr(this._baseLayersList),sr(this._overlaysList),this._layerControlInputs=[];var o,u,d,p,y=0;for(d=0;d<this._layers.length;d++)p=this._layers[d],this._addItem(p),u=u||p.overlay,o=o||!p.overlay,y+=p.overlay?0:1;return this.options.hideSingleBase&&(o=o&&y>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=u&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var u=this._getLayer(h(o.target)),d=u.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;d&&this._map.fire(d,u)},_createRadioElement:function(o,u){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(u?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=d,p.firstChild},_addItem:function(o){var u=document.createElement("label"),d=this._map.hasLayer(o.layer),p;o.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=d):p=this._createRadioElement("leaflet-base-layers_"+h(this),d),this._layerControlInputs.push(p),p.layerId=h(o.layer),ft(p,"click",this._onInputClick,this);var y=document.createElement("span");y.innerHTML=" "+o.name;var T=document.createElement("span");u.appendChild(T),T.appendChild(p),T.appendChild(y);var M=o.overlay?this._overlaysList:this._baseLayersList;return M.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,u,d,p=[],y=[];this._handlingClick=!0;for(var T=o.length-1;T>=0;T--)u=o[T],d=this._getLayer(u.layerId).layer,u.checked?p.push(d):u.checked||y.push(d);for(T=0;T<y.length;T++)this._map.hasLayer(y[T])&&this._map.removeLayer(y[T]);for(T=0;T<p.length;T++)this._map.hasLayer(p[T])||this._map.addLayer(p[T]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,u,d,p=this._map.getZoom(),y=o.length-1;y>=0;y--)u=o[y],d=this._getLayer(u.layerId).layer,u.disabled=d.options.minZoom!==void 0&&p<d.options.minZoom||d.options.maxZoom!==void 0&&p>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,ft(o,"click",pe),this.expand();var u=this;setTimeout(function(){Nt(o,"click",pe),u._preventClick=!1})}}),vc=function(o,u,d){return new Rn(o,u,d)},au=je.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var u="leaflet-control-zoom",d=At("div",u+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,u+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,u+"-out",d,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,u,d,p,y){var T=At("a",d,p);return T.innerHTML=o,T.href="#",T.title=u,T.setAttribute("role","button"),T.setAttribute("aria-label",u),ri(T),ft(T,"click",gn),ft(T,"click",y,this),ft(T,"click",this._refocusOnMap,this),T},_updateDisabled:function(){var o=this._map,u="leaflet-disabled";Wt(this._zoomInButton,u),Wt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(gt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(gt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});Tt.mergeOptions({zoomControl:!0}),Tt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new au,this.addControl(this.zoomControl))});var ls=function(o){return new au(o)},uu=je.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var u="leaflet-control-scale",d=At("div",u),p=this.options;return this._addScales(p,u+"-line",d),o.on(p.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),d},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,u,d){o.metric&&(this._mScale=At("div",u,d)),o.imperial&&(this._iScale=At("div",u,d))},_update:function(){var o=this._map,u=o.getSize().y/2,d=o.distance(o.containerPointToLatLng([0,u]),o.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(d)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var u=this._getRoundNum(o),d=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,d,u/o)},_updateImperial:function(o){var u=o*3.2808399,d,p,y;u>5280?(d=u/5280,p=this._getRoundNum(d),this._updateScale(this._iScale,p+" mi",p/d)):(y=this._getRoundNum(u),this._updateScale(this._iScale,y+" ft",y/u))},_updateScale:function(o,u,d){o.style.width=Math.round(this.options.maxWidth*d)+"px",o.innerHTML=u},_getRoundNum:function(o){var u=Math.pow(10,(Math.floor(o)+"").length-1),d=o/u;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,u*d}}),lu=function(o){return new uu(o)},fo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',po=je.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(at.inlineSvg?fo+" ":"")+"Leaflet</a>"},initialize:function(o){R(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=At("div","leaflet-control-attribution"),ri(this._container);for(var u in o._layers)o._layers[u].getAttribution&&this.addAttribution(o._layers[u].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var u in this._attributions)this._attributions[u]&&o.push(u);var d=[];this.options.prefix&&d.push(this.options.prefix),o.length&&d.push(o.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});Tt.mergeOptions({attributionControl:!0}),Tt.addInitHook(function(){this.options.attributionControl&&new po().addTo(this)});var mo=function(o){return new po(o)};je.Layers=Rn,je.Zoom=au,je.Scale=uu,je.Attribution=po,ur.layers=vc,ur.zoom=ls,ur.scale=lu,ur.attribution=mo;var Ln=Ft.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ln.addTo=function(o,u){return o.addHandler(u,this),this};var wc={Events:re},lr=at.touch?"touchstart mousedown":"mousedown",qn=Se.extend({options:{clickTolerance:3},initialize:function(o,u,d,p){R(this,p),this._element=o,this._dragStartTarget=u||o,this._preventOutline=d},enable:function(){this._enabled||(ft(this._dragStartTarget,lr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(qn._dragging===this&&this.finishDrag(!0),Nt(this._dragStartTarget,lr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!Ya(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){qn._dragging===this&&this.finishDrag();return}if(!(qn._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(qn._dragging=this,this._preventOutline&&tu(this._element),lo(),ni(),!this._moving)){this.fire("down");var u=o.touches?o.touches[0]:o,d=$n(this._element);this._startPoint=new W(u.clientX,u.clientY),this._startPos=Rt(this._element),this._parentScale=ho(d);var p=o.type==="mousedown";ft(document,p?"mousemove":"touchmove",this._onMove,this),ft(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var u=o.touches&&o.touches.length===1?o.touches[0]:o,d=new W(u.clientX,u.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,pe(o),this._moved||(this.fire("dragstart"),this._moved=!0,gt(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),gt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),Xt(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){Wt(document.body,"leaflet-dragging"),this._lastTarget&&(Wt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Nt(document,"mousemove touchmove",this._onMove,this),Nt(document,"mouseup touchend touchcancel",this._onUp,this),Xa(),jn();var u=this._moved&&this._moving;this._moving=!1,qn._dragging=!1,u&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function cu(o,u,d){var p,y=[1,4,2,8],T,M,B,$,K,it,ht,Et;for(T=0,it=o.length;T<it;T++)o[T]._code=ae(o[T],u);for(B=0;B<4;B++){for(ht=y[B],p=[],T=0,it=o.length,M=it-1;T<it;M=T++)$=o[T],K=o[M],$._code&ht?K._code&ht||(Et=Ri(K,$,ht,u,d),Et._code=ae(Et,u),p.push(Et)):(K._code&ht&&(Et=Ri(K,$,ht,u,d),Et._code=ae(Et,u),p.push(Et)),p.push($));o=p}return o}function _o(o,u){var d,p,y,T,M,B,$,K,it;if(!o||o.length===0)throw new Error("latlngs not passed");we(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var ht=pt([0,0]),Et=bt(o),Qe=Et.getNorthWest().distanceTo(Et.getSouthWest())*Et.getNorthEast().distanceTo(Et.getNorthWest());Qe<1700&&(ht=cs(o));var Ce=o.length,kn=[];for(d=0;d<Ce;d++){var an=pt(o[d]);kn.push(u.project(pt([an.lat-ht.lat,an.lng-ht.lng])))}for(B=$=K=0,d=0,p=Ce-1;d<Ce;p=d++)y=kn[d],T=kn[p],M=y.y*T.x-T.y*y.x,$+=(y.x+T.x)*M,K+=(y.y+T.y)*M,B+=M*3;B===0?it=kn[0]:it=[$/B,K/B];var Eo=u.unproject(J(it));return pt([Eo.lat+ht.lat,Eo.lng+ht.lng])}function cs(o){for(var u=0,d=0,p=0,y=0;y<o.length;y++){var T=pt(o[y]);u+=T.lat,d+=T.lng,p++}return pt([u/p,d/p])}var Ec={__proto__:null,clipPolygon:cu,polygonCenter:_o,centroid:cs};function hs(o,u){if(!u||!o.length)return o.slice();var d=u*u;return o=Ic(o,d),o=Ci(o,d),o}function hu(o,u,d){return Math.sqrt(cr(o,u,d,!0))}function Tc(o,u,d){return cr(o,u,d)}function Ci(o,u){var d=o.length,p=typeof Uint8Array!=void 0+""?Uint8Array:Array,y=new p(d);y[0]=y[d-1]=1,go(o,y,u,0,d-1);var T,M=[];for(T=0;T<d;T++)y[T]&&M.push(o[T]);return M}function go(o,u,d,p,y){var T=0,M,B,$;for(B=p+1;B<=y-1;B++)$=cr(o[B],o[p],o[y],!0),$>T&&(M=B,T=$);T>d&&(u[M]=1,go(o,u,d,p,M),go(o,u,d,M,y))}function Ic(o,u){for(var d=[o[0]],p=1,y=0,T=o.length;p<T;p++)Pc(o[p],o[y])>u&&(d.push(o[p]),y=p);return y<T-1&&d.push(o[T-1]),d}var du;function fu(o,u,d,p,y){var T=p?du:ae(o,d),M=ae(u,d),B,$,K;for(du=M;;){if(!(T|M))return[o,u];if(T&M)return!1;B=T||M,$=Ri(o,u,B,d,y),K=ae($,d),B===T?(o=$,T=K):(u=$,M=K)}}function Ri(o,u,d,p,y){var T=u.x-o.x,M=u.y-o.y,B=p.min,$=p.max,K,it;return d&8?(K=o.x+T*($.y-o.y)/M,it=$.y):d&4?(K=o.x+T*(B.y-o.y)/M,it=B.y):d&2?(K=$.x,it=o.y+M*($.x-o.x)/T):d&1&&(K=B.x,it=o.y+M*(B.x-o.x)/T),new W(K,it,y)}function ae(o,u){var d=0;return o.x<u.min.x?d|=1:o.x>u.max.x&&(d|=2),o.y<u.min.y?d|=4:o.y>u.max.y&&(d|=8),d}function Pc(o,u){var d=u.x-o.x,p=u.y-o.y;return d*d+p*p}function cr(o,u,d,p){var y=u.x,T=u.y,M=d.x-y,B=d.y-T,$=M*M+B*B,K;return $>0&&(K=((o.x-y)*M+(o.y-T)*B)/$,K>1?(y=d.x,T=d.y):K>0&&(y+=M*K,T+=B*K)),M=o.x-y,B=o.y-T,p?M*M+B*B:new W(y,T)}function we(o){return!C(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function c(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),we(o)}function m(o,u){var d,p,y,T,M,B,$,K;if(!o||o.length===0)throw new Error("latlngs not passed");we(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var it=pt([0,0]),ht=bt(o),Et=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Et<1700&&(it=cs(o));var Qe=o.length,Ce=[];for(d=0;d<Qe;d++){var kn=pt(o[d]);Ce.push(u.project(pt([kn.lat-it.lat,kn.lng-it.lng])))}for(d=0,p=0;d<Qe-1;d++)p+=Ce[d].distanceTo(Ce[d+1])/2;if(p===0)K=Ce[0];else for(d=0,T=0;d<Qe-1;d++)if(M=Ce[d],B=Ce[d+1],y=M.distanceTo(B),T+=y,T>p){$=(T-p)/y,K=[B.x-$*(B.x-M.x),B.y-$*(B.y-M.y)];break}var an=u.unproject(J(K));return pt([an.lat+it.lat,an.lng+it.lng])}var v={__proto__:null,simplify:hs,pointToSegmentDistance:hu,closestPointOnSegment:Tc,clipSegment:fu,_getEdgeIntersection:Ri,_getBitCode:ae,_sqClosestPointOnSegment:cr,isFlat:we,_flat:c,polylineCenter:m},I={project:function(o){return new W(o.lng,o.lat)},unproject:function(o){return new wt(o.y,o.x)},bounds:new ct([-180,-90],[180,90])},F={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ct([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var u=Math.PI/180,d=this.R,p=o.lat*u,y=this.R_MINOR/d,T=Math.sqrt(1-y*y),M=T*Math.sin(p),B=Math.tan(Math.PI/4-p/2)/Math.pow((1-M)/(1+M),T/2);return p=-d*Math.log(Math.max(B,1e-10)),new W(o.lng*u*d,p)},unproject:function(o){for(var u=180/Math.PI,d=this.R,p=this.R_MINOR/d,y=Math.sqrt(1-p*p),T=Math.exp(-o.y/d),M=Math.PI/2-2*Math.atan(T),B=0,$=.1,K;B<15&&Math.abs($)>1e-7;B++)K=y*Math.sin(M),K=Math.pow((1-K)/(1+K),y/2),$=Math.PI/2-2*Math.atan(T*K)-M,M+=$;return new wt(M*u,o.x*u/d)}},q={__proto__:null,LonLat:I,Mercator:F,SphericalMercator:Ji},tt=r({},Jn,{code:"EPSG:3395",projection:F,transformation:function(){var o=.5/(Math.PI*F.R);return yi(o,.5,-o,.5)}()}),Dt=r({},Jn,{code:"EPSG:4326",projection:I,transformation:yi(1/180,1,-1/180,.5)}),Ee=r({},de,{projection:I,transformation:yi(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,u){var d=u.lng-o.lng,p=u.lat-o.lat;return Math.sqrt(d*d+p*p)},infinite:!0});de.Earth=Jn,de.EPSG3395=tt,de.EPSG3857=ts,de.EPSG900913=ba,de.EPSG4326=Dt,de.Simple=Ee;var mt=Se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[h(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[h(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var u=o.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var d=this.getEvents();u.on(d,this),this.once("remove",function(){u.off(d,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});Tt.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var u=h(o);return this._layers[u]?this:(this._layers[u]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var u=h(o);return this._layers[u]?(this._loaded&&o.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return h(o)in this._layers},eachLayer:function(o,u){for(var d in this._layers)o.call(u,this._layers[d]);return this},_addLayers:function(o){o=o?C(o)?o:[o]:[];for(var u=0,d=o.length;u<d;u++)this.addLayer(o[u])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[h(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var u=h(o);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,u=-1/0,d=this._getZoomSpan();for(var p in this._zoomBoundLayers){var y=this._zoomBoundLayers[p].options;o=y.minZoom===void 0?o:Math.min(o,y.minZoom),u=y.maxZoom===void 0?u:Math.max(u,y.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=o===1/0?void 0:o,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Jt=mt.extend({initialize:function(o,u){R(this,u),this._layers={};var d,p;if(o)for(d=0,p=o.length;d<p;d++)this.addLayer(o[d])},addLayer:function(o){var u=this.getLayerId(o);return this._layers[u]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var u=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(o){var u=typeof o=="number"?o:this.getLayerId(o);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var u=Array.prototype.slice.call(arguments,1),d,p;for(d in this._layers)p=this._layers[d],p[o]&&p[o].apply(p,u);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,u){for(var d in this._layers)o.call(u,this._layers[d]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return h(o)}}),xe=function(o,u){return new Jt(o,u)},$e=Jt.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Jt.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Jt.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new vt;for(var u in this._layers){var d=this._layers[u];o.extend(d.getBounds?d.getBounds():d.getLatLng())}return o}}),yn=function(o,u){return new $e(o,u)},Gn=Ft.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){R(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,u){var d=this._getIconUrl(o);if(!d){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(d,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(p,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(o,u){var d=this.options,p=d[u+"Size"];typeof p=="number"&&(p=[p,p]);var y=J(p),T=J(u==="shadow"&&d.shadowAnchor||d.iconAnchor||y&&y.divideBy(2,!0));o.className="leaflet-marker-"+u+" "+(d.className||""),T&&(o.style.marginLeft=-T.x+"px",o.style.marginTop=-T.y+"px"),y&&(o.style.width=y.x+"px",o.style.height=y.y+"px")},_createImg:function(o,u){return u=u||document.createElement("img"),u.src=o,u},_getIconUrl:function(o){return at.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function pu(o){return new Gn(o)}var mu=Gn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof mu.imagePath!="string"&&(mu.imagePath=this._detectIconPath()),(this.options.imagePath||mu.imagePath)+Gn.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var u=function(d,p,y){var T=p.exec(d);return T&&T[y]};return o=u(o,/^url\((['"])?(.+)\1\)$/,2),o&&u(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=At("div","leaflet-default-icon-path",document.body),u=rr(o,"background-image")||rr(o,"backgroundImage");if(document.body.removeChild(o),u=this._stripUrl(u),u)return u;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),_g=Ln.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new qn(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),gt(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Wt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var u=this._marker,d=u._map,p=this._marker.options.autoPanSpeed,y=this._marker.options.autoPanPadding,T=Rt(u._icon),M=d.getPixelBounds(),B=d.getPixelOrigin(),$=dt(M.min._subtract(B).add(y),M.max._subtract(B).subtract(y));if(!$.contains(T)){var K=J((Math.max($.max.x,T.x)-$.max.x)/(M.max.x-$.max.x)-(Math.min($.min.x,T.x)-$.min.x)/(M.min.x-$.min.x),(Math.max($.max.y,T.y)-$.max.y)/(M.max.y-$.max.y)-(Math.min($.min.y,T.y)-$.min.y)/(M.min.y-$.min.y)).multiplyBy(p);d.panBy(K,{animate:!1}),this._draggable._newPos._add(K),this._draggable._startPos._add(K),Xt(u._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=N(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(O(this._panRequest),this._panRequest=N(this._adjustPan.bind(this,o)))},_onDrag:function(o){var u=this._marker,d=u._shadow,p=Rt(u._icon),y=u._map.layerPointToLatLng(p);d&&Xt(d,p),u._latlng=y,o.latlng=y,o.oldLatLng=this._oldLatLng,u.fire("move",o).fire("drag",o)},_onDragEnd:function(o){O(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Sc=mt.extend({options:{icon:new mu,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,u){R(this,u),this._latlng=pt(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var u=this._latlng;return this._latlng=pt(o),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=o.icon.createIcon(this._icon),p=!1;d!==this._icon&&(this._icon&&this._removeIcon(),p=!0,o.title&&(d.title=o.title),d.tagName==="IMG"&&(d.alt=o.alt||"")),gt(d,u),o.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ft(d,"focus",this._panOnFocus,this);var y=o.icon.createShadow(this._shadow),T=!1;y!==this._shadow&&(this._removeShadow(),T=!0),y&&(gt(y,u),y.alt=""),this._shadow=y,o.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),y&&T&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Nt(this._icon,"focus",this._panOnFocus,this),Bt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Bt(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&Xt(this._icon,o),this._shadow&&Xt(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var u=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(gt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),_g)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new _g(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&fe(this._icon,o),this._shadow&&fe(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var u=this.options.icon.options,d=u.iconSize?J(u.iconSize):J(0,0),p=u.iconAnchor?J(u.iconAnchor):J(0,0);o.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:d.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function S1(o,u){return new Sc(o,u)}var hr=mt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return R(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ac=hr.extend({options:{fill:!0,radius:10},initialize:function(o,u){R(this,u),this._latlng=pt(o),this._radius=this.options.radius},setLatLng:function(o){var u=this._latlng;return this._latlng=pt(o),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var u=o&&o.radius||this._radius;return hr.prototype.setStyle.call(this,o),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,u=this._radiusY||o,d=this._clickTolerance(),p=[o+d,u+d];this._pxBounds=new ct(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function A1(o,u){return new Ac(o,u)}var rf=Ac.extend({initialize:function(o,u,d){if(typeof u=="number"&&(u=r({},d,{radius:u})),R(this,u),this._latlng=pt(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new vt(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:hr.prototype.setStyle,_project:function(){var o=this._latlng.lng,u=this._latlng.lat,d=this._map,p=d.options.crs;if(p.distance===Jn.distance){var y=Math.PI/180,T=this._mRadius/Jn.R/y,M=d.project([u+T,o]),B=d.project([u-T,o]),$=M.add(B).divideBy(2),K=d.unproject($).lat,it=Math.acos((Math.cos(T*y)-Math.sin(u*y)*Math.sin(K*y))/(Math.cos(u*y)*Math.cos(K*y)))/y;(isNaN(it)||it===0)&&(it=T/Math.cos(Math.PI/180*u)),this._point=$.subtract(d.getPixelOrigin()),this._radius=isNaN(it)?0:$.x-d.project([K,o-it]).x,this._radiusY=$.y-M.y}else{var ht=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(ht).x}this._updateBounds()}});function x1(o,u,d){return new rf(o,u,d)}var Li=hr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,u){R(this,u),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var u=1/0,d=null,p=cr,y,T,M=0,B=this._parts.length;M<B;M++)for(var $=this._parts[M],K=1,it=$.length;K<it;K++){y=$[K-1],T=$[K];var ht=p(o,y,T,!0);ht<u&&(u=ht,d=p(o,y,T))}return d&&(d.distance=Math.sqrt(u)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return m(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,u){return u=u||this._defaultShape(),o=pt(o),u.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new vt,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return we(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var u=[],d=we(o),p=0,y=o.length;p<y;p++)d?(u[p]=pt(o[p]),this._bounds.extend(u[p])):u[p]=this._convertLatLngs(o[p]);return u},_project:function(){var o=new ct;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),u=new W(o,o);this._rawPxBounds&&(this._pxBounds=new ct([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(o,u,d){var p=o[0]instanceof wt,y=o.length,T,M;if(p){for(M=[],T=0;T<y;T++)M[T]=this._map.latLngToLayerPoint(o[T]),d.extend(M[T]);u.push(M)}else for(T=0;T<y;T++)this._projectLatlngs(o[T],u,d)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,d,p,y,T,M,B,$;for(d=0,y=0,T=this._rings.length;d<T;d++)for($=this._rings[d],p=0,M=$.length;p<M-1;p++)B=fu($[p],$[p+1],o,p,!0),B&&(u[y]=u[y]||[],u[y].push(B[0]),(B[1]!==$[p+1]||p===M-2)&&(u[y].push(B[1]),y++))}},_simplifyPoints:function(){for(var o=this._parts,u=this.options.smoothFactor,d=0,p=o.length;d<p;d++)o[d]=hs(o[d],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,u){var d,p,y,T,M,B,$=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(d=0,T=this._parts.length;d<T;d++)for(B=this._parts[d],p=0,M=B.length,y=M-1;p<M;y=p++)if(!(!u&&p===0)&&hu(o,B[y],B[p])<=$)return!0;return!1}});function C1(o,u){return new Li(o,u)}Li._flat=c;var yo=Li.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _o(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var u=Li.prototype._convertLatLngs.call(this,o),d=u.length;return d>=2&&u[0]instanceof wt&&u[0].equals(u[d-1])&&u.pop(),u},_setLatLngs:function(o){Li.prototype._setLatLngs.call(this,o),we(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return we(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,u=this.options.weight,d=new W(u,u);if(o=new ct(o.min.subtract(d),o.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,y=this._rings.length,T;p<y;p++)T=cu(this._rings[p],o,!0),T.length&&this._parts.push(T)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var u=!1,d,p,y,T,M,B,$,K;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(T=0,$=this._parts.length;T<$;T++)for(d=this._parts[T],M=0,K=d.length,B=K-1;M<K;B=M++)p=d[M],y=d[B],p.y>o.y!=y.y>o.y&&o.x<(y.x-p.x)*(o.y-p.y)/(y.y-p.y)+p.x&&(u=!u);return u||Li.prototype._containsPoint.call(this,o,!0)}});function R1(o,u){return new yo(o,u)}var ki=$e.extend({initialize:function(o,u){R(this,u),this._layers={},o&&this.addData(o)},addData:function(o){var u=C(o)?o:o.features,d,p,y;if(u){for(d=0,p=u.length;d<p;d++)y=u[d],(y.geometries||y.geometry||y.features||y.coordinates)&&this.addData(y);return this}var T=this.options;if(T.filter&&!T.filter(o))return this;var M=xc(o,T);return M?(M.feature=Lc(o),M.defaultOptions=M.options,this.resetStyle(M),T.onEachFeature&&T.onEachFeature(o,M),this.addLayer(M)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=r({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(u){this._setLayerStyle(u,o)},this)},_setLayerStyle:function(o,u){o.setStyle&&(typeof u=="function"&&(u=u(o.feature)),o.setStyle(u))}});function xc(o,u){var d=o.type==="Feature"?o.geometry:o,p=d?d.coordinates:null,y=[],T=u&&u.pointToLayer,M=u&&u.coordsToLatLng||sf,B,$,K,it;if(!p&&!d)return null;switch(d.type){case"Point":return B=M(p),gg(T,o,B,u);case"MultiPoint":for(K=0,it=p.length;K<it;K++)B=M(p[K]),y.push(gg(T,o,B,u));return new $e(y);case"LineString":case"MultiLineString":return $=Cc(p,d.type==="LineString"?0:1,M),new Li($,u);case"Polygon":case"MultiPolygon":return $=Cc(p,d.type==="Polygon"?1:2,M),new yo($,u);case"GeometryCollection":for(K=0,it=d.geometries.length;K<it;K++){var ht=xc({geometry:d.geometries[K],type:"Feature",properties:o.properties},u);ht&&y.push(ht)}return new $e(y);case"FeatureCollection":for(K=0,it=d.features.length;K<it;K++){var Et=xc(d.features[K],u);Et&&y.push(Et)}return new $e(y);default:throw new Error("Invalid GeoJSON object.")}}function gg(o,u,d,p){return o?o(u,d):new Sc(d,p&&p.markersInheritOptions&&p)}function sf(o){return new wt(o[1],o[0],o[2])}function Cc(o,u,d){for(var p=[],y=0,T=o.length,M;y<T;y++)M=u?Cc(o[y],u-1,d):(d||sf)(o[y]),p.push(M);return p}function of(o,u){return o=pt(o),o.alt!==void 0?[w(o.lng,u),w(o.lat,u),w(o.alt,u)]:[w(o.lng,u),w(o.lat,u)]}function Rc(o,u,d,p){for(var y=[],T=0,M=o.length;T<M;T++)y.push(u?Rc(o[T],we(o[T])?0:u-1,d,p):of(o[T],p));return!u&&d&&y.length>0&&y.push(y[0].slice()),y}function vo(o,u){return o.feature?r({},o.feature,{geometry:u}):Lc(u)}function Lc(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var af={toGeoJSON:function(o){return vo(this,{type:"Point",coordinates:of(this.getLatLng(),o)})}};Sc.include(af),rf.include(af),Ac.include(af),Li.include({toGeoJSON:function(o){var u=!we(this._latlngs),d=Rc(this._latlngs,u?1:0,!1,o);return vo(this,{type:(u?"Multi":"")+"LineString",coordinates:d})}}),yo.include({toGeoJSON:function(o){var u=!we(this._latlngs),d=u&&!we(this._latlngs[0]),p=Rc(this._latlngs,d?2:u?1:0,!0,o);return u||(p=[p]),vo(this,{type:(d?"Multi":"")+"Polygon",coordinates:p})}}),Jt.include({toMultiPoint:function(o){var u=[];return this.eachLayer(function(d){u.push(d.toGeoJSON(o).geometry.coordinates)}),vo(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(o){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(o);var d=u==="GeometryCollection",p=[];return this.eachLayer(function(y){if(y.toGeoJSON){var T=y.toGeoJSON(o);if(d)p.push(T.geometry);else{var M=Lc(T);M.type==="FeatureCollection"?p.push.apply(p,M.features):p.push(M)}}}),d?vo(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function yg(o,u){return new ki(o,u)}var L1=yg,kc=mt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,u,d){this._url=o,this._bounds=bt(u),R(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(gt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Bt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&Ii(this._image),this},bringToBack:function(){return this._map&&Pi(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=bt(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",u=this._image=o?this._url:At("img");if(gt(u,"leaflet-image-layer"),this._zoomAnimated&&gt(u,"leaflet-zoom-animated"),this.options.className&&gt(u,this.options.className),u.onselectstart=g,u.onmousemove=g,u.onload=a(this.fire,this,"load"),u.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(o){var u=this._map.getZoomScale(o.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;xn(this._image,d,u)},_reset:function(){var o=this._image,u=new ct(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=u.getSize();Xt(o,u.min),o.style.width=d.x+"px",o.style.height=d.y+"px"},_updateOpacity:function(){fe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),k1=function(o,u,d){return new kc(o,u,d)},vg=kc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",u=this._image=o?this._url:At("video");if(gt(u,"leaflet-image-layer"),this._zoomAnimated&&gt(u,"leaflet-zoom-animated"),this.options.className&&gt(u,this.options.className),u.onselectstart=g,u.onmousemove=g,u.onloadeddata=a(this.fire,this,"load"),o){for(var d=u.getElementsByTagName("source"),p=[],y=0;y<d.length;y++)p.push(d[y].src);this._url=d.length>0?p:[u.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var T=0;T<this._url.length;T++){var M=At("source");M.src=this._url[T],u.appendChild(M)}}});function b1(o,u,d){return new vg(o,u,d)}var wg=kc.extend({_initImage:function(){var o=this._image=this._url;gt(o,"leaflet-image-layer"),this._zoomAnimated&&gt(o,"leaflet-zoom-animated"),this.options.className&&gt(o,this.options.className),o.onselectstart=g,o.onmousemove=g}});function D1(o,u,d){return new wg(o,u,d)}var si=mt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,u){o&&(o instanceof wt||C(o))?(this._latlng=pt(o),R(this,u)):(R(this,o),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&fe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&fe(this._container,1),this.bringToFront(),this.options.interactive&&(gt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(fe(this._container,0),this._removeTimeout=setTimeout(a(Bt,void 0,this._container),200)):Bt(this._container),this.options.interactive&&(Wt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=pt(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ii(this._container),this},bringToBack:function(){return this._map&&Pi(this._container),this},_prepareOpen:function(o){var u=this._source;if(!u._map)return!1;if(u instanceof $e){u=null;var d=this._source._layers;for(var p in d)if(d[p]._map){u=d[p];break}if(!u)return!1;this._source=u}if(!o)if(u.getCenter)o=u.getCenter();else if(u.getLatLng)o=u.getLatLng();else if(u.getBounds)o=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")o.innerHTML=u;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),u=J(this.options.offset),d=this._getAnchor();this._zoomAnimated?Xt(this._container,o.add(d)):u=u.add(o).add(d);var p=this._containerBottom=-u.y,y=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=p+"px",this._container.style.left=y+"px"}},_getAnchor:function(){return[0,0]}});Tt.include({_initOverlay:function(o,u,d,p){var y=u;return y instanceof o||(y=new o(p).setContent(u)),d&&y.setLatLng(d),y}}),mt.include({_initOverlay:function(o,u,d,p){var y=d;return y instanceof o?(R(y,p),y._source=this):(y=u&&!p?u:new o(p,this),y.setContent(d)),y}});var bc=si.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,si.prototype.openOn.call(this,o)},onAdd:function(o){si.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof hr||this._source.on("preclick",xi))},onRemove:function(o){si.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof hr||this._source.off("preclick",xi))},getEvents:function(){var o=si.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",u=this._container=At("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=At("div",o+"-content-wrapper",u);if(this._contentNode=At("div",o+"-content",d),ri(u),or(this._contentNode),ft(u,"contextmenu",xi),this._tipContainer=At("div",o+"-tip-container",u),this._tip=At("div",o+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=At("a",o+"-close-button",u);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',ft(p,"click",function(y){pe(y),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,u=o.style;u.width="",u.whiteSpace="nowrap";var d=o.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),u.width=d+1+"px",u.whiteSpace="",u.height="";var p=o.offsetHeight,y=this.options.maxHeight,T="leaflet-popup-scrolled";y&&p>y?(u.height=y+"px",gt(o,T)):Wt(o,T),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var u=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),d=this._getAnchor();Xt(this._container,u.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,u=parseInt(rr(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+u,p=this._containerWidth,y=new W(this._containerLeft,-d-this._containerBottom);y._add(Rt(this._container));var T=o.layerPointToContainerPoint(y),M=J(this.options.autoPanPadding),B=J(this.options.autoPanPaddingTopLeft||M),$=J(this.options.autoPanPaddingBottomRight||M),K=o.getSize(),it=0,ht=0;T.x+p+$.x>K.x&&(it=T.x+p-K.x+$.x),T.x-it-B.x<0&&(it=T.x-B.x),T.y+d+$.y>K.y&&(ht=T.y+d-K.y+$.y),T.y-ht-B.y<0&&(ht=T.y-B.y),(it||ht)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([it,ht]))}},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),V1=function(o,u){return new bc(o,u)};Tt.mergeOptions({closePopupOnClick:!0}),Tt.include({openPopup:function(o,u,d){return this._initOverlay(bc,o,u,d).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),mt.include({bindPopup:function(o,u){return this._popup=this._initOverlay(bc,this._popup,o,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof $e||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){gn(o);var u=o.layer||o.target;if(this._popup._source===u&&!(u instanceof hr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=u,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var Dc=si.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){si.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){si.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=si.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",u=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=At("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var u,d,p=this._map,y=this._container,T=p.latLngToContainerPoint(p.getCenter()),M=p.layerPointToContainerPoint(o),B=this.options.direction,$=y.offsetWidth,K=y.offsetHeight,it=J(this.options.offset),ht=this._getAnchor();B==="top"?(u=$/2,d=K):B==="bottom"?(u=$/2,d=0):B==="center"?(u=$/2,d=K/2):B==="right"?(u=0,d=K/2):B==="left"?(u=$,d=K/2):M.x<T.x?(B="right",u=0,d=K/2):(B="left",u=$+(it.x+ht.x)*2,d=K/2),o=o.subtract(J(u,d,!0)).add(it).add(ht),Wt(y,"leaflet-tooltip-right"),Wt(y,"leaflet-tooltip-left"),Wt(y,"leaflet-tooltip-top"),Wt(y,"leaflet-tooltip-bottom"),gt(y,"leaflet-tooltip-"+B),Xt(y,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&fe(this._container,o)},_animateZoom:function(o){var u=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(u)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),M1=function(o,u){return new Dc(o,u)};Tt.include({openTooltip:function(o,u,d){return this._initOverlay(Dc,o,u,d).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),mt.include({bindTooltip:function(o,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Dc,this._tooltip,o,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var u=o?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[u](d),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof $e||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var u=typeof o.getElement=="function"&&o.getElement();u&&(ft(u,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),ft(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var u=typeof o.getElement=="function"&&o.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var u=o.latlng,d,p;this._tooltip.options.sticky&&o.originalEvent&&(d=this._map.mouseEventToContainerPoint(o.originalEvent),p=this._map.containerPointToLayerPoint(d),u=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(u)}});var Eg=Gn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var u=o&&o.tagName==="DIV"?o:document.createElement("div"),d=this.options;if(d.html instanceof Element?(sr(u),u.appendChild(d.html)):u.innerHTML=d.html!==!1?d.html:"",d.bgPos){var p=J(d.bgPos);u.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function N1(o){return new Eg(o)}Gn.Default=mu;var _u=mt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:at.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){R(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),Bt(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ii(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Pi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof W?o:new W(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var u=this.getPane().children,d=-o(-1/0,1/0),p=0,y=u.length,T;p<y;p++)T=u[p].style.zIndex,u[p]!==this._container&&T&&(d=o(d,+T));isFinite(d)&&(this.options.zIndex=d+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!at.ielt9){fe(this._container,this.options.opacity);var o=+new Date,u=!1,d=!1;for(var p in this._tiles){var y=this._tiles[p];if(!(!y.current||!y.loaded)){var T=Math.min(1,(o-y.loaded)/200);fe(y.el,T),T<1?u=!0:(y.active?d=!0:this._onOpaqueTile(y),y.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),u&&(O(this._fadeFrame),this._fadeFrame=N(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=At("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,u=this.options.maxZoom;if(o!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===o?(this._levels[d].el.style.zIndex=u-Math.abs(o-d),this._onUpdateLevel(d)):(Bt(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var p=this._levels[o],y=this._map;return p||(p=this._levels[o]={},p.el=At("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=u,p.origin=y.project(y.unproject(y.getPixelOrigin()),o).round(),p.zoom=o,this._setZoomTransform(p,y.getCenter(),y.getZoom()),g(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var o,u,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)u=this._tiles[o],u.retain=u.current;for(o in this._tiles)if(u=this._tiles[o],u.current&&!u.active){var p=u.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var u in this._tiles)this._tiles[u].coords.z===o&&this._removeTile(u)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)Bt(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,u,d,p){var y=Math.floor(o/2),T=Math.floor(u/2),M=d-1,B=new W(+y,+T);B.z=+M;var $=this._tileCoordsToKey(B),K=this._tiles[$];return K&&K.active?(K.retain=!0,!0):(K&&K.loaded&&(K.retain=!0),M>p?this._retainParent(y,T,M,p):!1)},_retainChildren:function(o,u,d,p){for(var y=2*o;y<2*o+2;y++)for(var T=2*u;T<2*u+2;T++){var M=new W(y,T);M.z=d+1;var B=this._tileCoordsToKey(M),$=this._tiles[B];if($&&$.active){$.retain=!0;continue}else $&&$.loaded&&($.retain=!0);d+1<p&&this._retainChildren(y,T,d+1,p)}},_resetView:function(o){var u=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var u=this.options;return u.minNativeZoom!==void 0&&o<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<o?u.maxNativeZoom:o},_setView:function(o,u,d,p){var y=Math.round(u);this.options.maxZoom!==void 0&&y>this.options.maxZoom||this.options.minZoom!==void 0&&y<this.options.minZoom?y=void 0:y=this._clampZoom(y);var T=this.options.updateWhenZooming&&y!==this._tileZoom;(!p||T)&&(this._tileZoom=y,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),y!==void 0&&this._update(o),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(o,u)},_setZoomTransforms:function(o,u){for(var d in this._levels)this._setZoomTransform(this._levels[d],o,u)},_setZoomTransform:function(o,u,d){var p=this._map.getZoomScale(d,o.zoom),y=o.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(u,d)).round();at.any3d?xn(o.el,y,p):Xt(o.el,y)},_resetGrid:function(){var o=this._map,u=o.options.crs,d=this._tileSize=this.getTileSize(),p=this._tileZoom,y=this._map.getPixelWorldBounds(this._tileZoom);y&&(this._globalTileRange=this._pxBoundsToTileRange(y)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,u.wrapLng[0]],p).x/d.x),Math.ceil(o.project([0,u.wrapLng[1]],p).x/d.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([u.wrapLat[0],0],p).y/d.x),Math.ceil(o.project([u.wrapLat[1],0],p).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var u=this._map,d=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),p=u.getZoomScale(d,this._tileZoom),y=u.project(o,this._tileZoom).floor(),T=u.getSize().divideBy(p*2);return new ct(y.subtract(T),y.add(T))},_update:function(o){var u=this._map;if(u){var d=this._clampZoom(u.getZoom());if(o===void 0&&(o=u.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(o),y=this._pxBoundsToTileRange(p),T=y.getCenter(),M=[],B=this.options.keepBuffer,$=new ct(y.getBottomLeft().subtract([B,-B]),y.getTopRight().add([B,-B]));if(!(isFinite(y.min.x)&&isFinite(y.min.y)&&isFinite(y.max.x)&&isFinite(y.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var K in this._tiles){var it=this._tiles[K].coords;(it.z!==this._tileZoom||!$.contains(new W(it.x,it.y)))&&(this._tiles[K].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(o,d);return}for(var ht=y.min.y;ht<=y.max.y;ht++)for(var Et=y.min.x;Et<=y.max.x;Et++){var Qe=new W(Et,ht);if(Qe.z=this._tileZoom,!!this._isValidTile(Qe)){var Ce=this._tiles[this._tileCoordsToKey(Qe)];Ce?Ce.current=!0:M.push(Qe)}}if(M.sort(function(an,Eo){return an.distanceTo(T)-Eo.distanceTo(T)}),M.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var kn=document.createDocumentFragment();for(Et=0;Et<M.length;Et++)this._addTile(M[Et],kn);this._level.el.appendChild(kn)}}}},_isValidTile:function(o){var u=this._map.options.crs;if(!u.infinite){var d=this._globalTileRange;if(!u.wrapLng&&(o.x<d.min.x||o.x>d.max.x)||!u.wrapLat&&(o.y<d.min.y||o.y>d.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(o);return bt(this.options.bounds).overlaps(p)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var u=this._map,d=this.getTileSize(),p=o.scaleBy(d),y=p.add(d),T=u.unproject(p,o.z),M=u.unproject(y,o.z);return[T,M]},_tileCoordsToBounds:function(o){var u=this._tileCoordsToNwSe(o),d=new vt(u[0],u[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var u=o.split(":"),d=new W(+u[0],+u[1]);return d.z=+u[2],d},_removeTile:function(o){var u=this._tiles[o];u&&(Bt(u.el),delete this._tiles[o],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){gt(o,"leaflet-tile");var u=this.getTileSize();o.style.width=u.x+"px",o.style.height=u.y+"px",o.onselectstart=g,o.onmousemove=g,at.ielt9&&this.options.opacity<1&&fe(o,this.options.opacity)},_addTile:function(o,u){var d=this._getTilePos(o),p=this._tileCoordsToKey(o),y=this.createTile(this._wrapCoords(o),a(this._tileReady,this,o));this._initTile(y),this.createTile.length<2&&N(a(this._tileReady,this,o,null,y)),Xt(y,d),this._tiles[p]={el:y,coords:o,current:!0},u.appendChild(y),this.fire("tileloadstart",{tile:y,coords:o})},_tileReady:function(o,u,d){u&&this.fire("tileerror",{error:u,tile:d,coords:o});var p=this._tileCoordsToKey(o);d=this._tiles[p],d&&(d.loaded=+new Date,this._map._fadeAnimated?(fe(d.el,0),O(this._fadeFrame),this._fadeFrame=N(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),u||(gt(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),at.ielt9||!this._map._fadeAnimated?N(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var u=new W(this._wrapX?_(o.x,this._wrapX):o.x,this._wrapY?_(o.y,this._wrapY):o.y);return u.z=o.z,u},_pxBoundsToTileRange:function(o){var u=this.getTileSize();return new ct(o.min.unscaleBy(u).floor(),o.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function O1(o){return new _u(o)}var wo=_u.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,u){this._url=o,u=R(this,u),u.detectRetina&&at.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,u){return this._url===o&&u===void 0&&(u=!0),this._url=o,u||this.redraw(),this},createTile:function(o,u){var d=document.createElement("img");return ft(d,"load",a(this._tileOnLoad,this,u,d)),ft(d,"error",a(this._tileOnError,this,u,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(o),d},getTileUrl:function(o){var u={r:at.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-o.y;this.options.tms&&(u.y=d),u["-y"]=d}return S(this._url,r(u,this.options))},_tileOnLoad:function(o,u){at.ielt9?setTimeout(a(o,this,null,u),0):o(null,u)},_tileOnError:function(o,u,d){var p=this.options.errorTileUrl;p&&u.getAttribute("src")!==p&&(u.src=p),o(d,u)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,u=this.options.maxZoom,d=this.options.zoomReverse,p=this.options.zoomOffset;return d&&(o=u-o),o+p},_getSubdomain:function(o){var u=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var o,u;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(u=this._tiles[o].el,u.onload=g,u.onerror=g,!u.complete)){u.src=H;var d=this._tiles[o].coords;Bt(u),delete this._tiles[o],this.fire("tileabort",{tile:u,coords:d})}},_removeTile:function(o){var u=this._tiles[o];if(u)return u.el.setAttribute("src",H),_u.prototype._removeTile.call(this,o)},_tileReady:function(o,u,d){if(!(!this._map||d&&d.getAttribute("src")===H))return _u.prototype._tileReady.call(this,o,u,d)}});function Tg(o,u){return new wo(o,u)}var Ig=wo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,u){this._url=o;var d=r({},this.defaultWmsParams);for(var p in u)p in this.options||(d[p]=u[p]);u=R(this,u);var y=u.detectRetina&&at.retina?2:1,T=this.getTileSize();d.width=T.x*y,d.height=T.y*y,this.wmsParams=d},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,wo.prototype.onAdd.call(this,o)},getTileUrl:function(o){var u=this._tileCoordsToNwSe(o),d=this._crs,p=dt(d.project(u[0]),d.project(u[1])),y=p.min,T=p.max,M=(this._wmsVersion>=1.3&&this._crs===Dt?[y.y,y.x,T.y,T.x]:[y.x,y.y,T.x,T.y]).join(","),B=wo.prototype.getTileUrl.call(this,o);return B+z(this.wmsParams,B,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+M},setParams:function(o,u){return r(this.wmsParams,o),u||this.redraw(),this}});function F1(o,u){return new Ig(o,u)}wo.WMS=Ig,Tg.wms=F1;var bi=mt.extend({options:{padding:.1},initialize:function(o){R(this,o),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),gt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,u){var d=this._map.getZoomScale(u,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),y=this._map.project(this._center,u),T=p.multiplyBy(-d).add(y).subtract(this._map._getNewPixelOrigin(o,u));at.any3d?xn(this._container,T,d):Xt(this._container,T)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,u=this._map.getSize(),d=this._map.containerPointToLayerPoint(u.multiplyBy(-o)).round();this._bounds=new ct(d,d.add(u.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Pg=bi.extend({options:{tolerance:0},getEvents:function(){var o=bi.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){bi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");ft(o,"mousemove",this._onMouseMove,this),ft(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ft(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){O(this._redrawRequest),delete this._ctx,Bt(this._container),Nt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var u in this._layers)o=this._layers[u],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){bi.prototype._update.call(this);var o=this._bounds,u=this._container,d=o.getSize(),p=at.retina?2:1;Xt(u,o.min),u.width=p*d.x,u.height=p*d.y,u.style.width=d.x+"px",u.style.height=d.y+"px",at.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){bi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[h(o)]=o;var u=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var u=o._order,d=u.next,p=u.prev;d?d.prev=p:this._drawLast=p,p?p.next=d:this._drawFirst=d,delete o._order,delete this._layers[h(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var u=o.options.dashArray.split(/[, ]+/),d=[],p,y;for(y=0;y<u.length;y++){if(p=Number(u[y]),isNaN(p))return;d.push(p)}o.options._dashArray=d}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||N(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var u=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ct,this._redrawBounds.extend(o._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(o._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var u=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,u=this._redrawBounds;if(this._ctx.save(),u){var d=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)o=p.layer,(!u||o._pxBounds&&o._pxBounds.intersects(u))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,u){if(this._drawing){var d,p,y,T,M=o._parts,B=M.length,$=this._ctx;if(B){for($.beginPath(),d=0;d<B;d++){for(p=0,y=M[d].length;p<y;p++)T=M[d][p],$[p?"lineTo":"moveTo"](T.x,T.y);u&&$.closePath()}this._fillStroke($,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var u=o._point,d=this._ctx,p=Math.max(Math.round(o._radius),1),y=(Math.max(Math.round(o._radiusY),1)||p)/p;y!==1&&(d.save(),d.scale(1,y)),d.beginPath(),d.arc(u.x,u.y/y,p,0,Math.PI*2,!1),y!==1&&d.restore(),this._fillStroke(d,o)}},_fillStroke:function(o,u){var d=u.options;d.fill&&(o.globalAlpha=d.fillOpacity,o.fillStyle=d.fillColor||d.color,o.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(o.setLineDash&&o.setLineDash(u.options&&u.options._dashArray||[]),o.globalAlpha=d.opacity,o.lineWidth=d.weight,o.strokeStyle=d.color,o.lineCap=d.lineCap,o.lineJoin=d.lineJoin,o.stroke())},_onClick:function(o){for(var u=this._map.mouseEventToLayerPoint(o),d,p,y=this._drawFirst;y;y=y.next)d=y.layer,d.options.interactive&&d._containsPoint(u)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(d))&&(p=d);this._fireEvent(p?[p]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,u)}},_handleMouseOut:function(o){var u=this._hoveredLayer;u&&(Wt(this._container,"leaflet-interactive"),this._fireEvent([u],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,u){if(!this._mouseHoverThrottled){for(var d,p,y=this._drawFirst;y;y=y.next)d=y.layer,d.options.interactive&&d._containsPoint(u)&&(p=d);p!==this._hoveredLayer&&(this._handleMouseOut(o),p&&(gt(this._container,"leaflet-interactive"),this._fireEvent([p],o,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,u,d){this._map._fireDOMEvent(u,d||u.type,o)},_bringToFront:function(o){var u=o._order;if(u){var d=u.next,p=u.prev;if(d)d.prev=p;else return;p?p.next=d:d&&(this._drawFirst=d),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(o)}},_bringToBack:function(o){var u=o._order;if(u){var d=u.next,p=u.prev;if(p)p.next=d;else return;d?d.prev=p:p&&(this._drawLast=p),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(o)}}});function Sg(o){return at.canvas?new Pg(o):null}var gu=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),B1={_initContainer:function(){this._container=At("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(bi.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var u=o._container=gu("shape");gt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",o._path=gu("path"),u.appendChild(o._path),this._updateStyle(o),this._layers[h(o)]=o},_addPath:function(o){var u=o._container;this._container.appendChild(u),o.options.interactive&&o.addInteractiveTarget(u)},_removePath:function(o){var u=o._container;Bt(u),o.removeInteractiveTarget(u),delete this._layers[h(o)]},_updateStyle:function(o){var u=o._stroke,d=o._fill,p=o.options,y=o._container;y.stroked=!!p.stroke,y.filled=!!p.fill,p.stroke?(u||(u=o._stroke=gu("stroke")),y.appendChild(u),u.weight=p.weight+"px",u.color=p.color,u.opacity=p.opacity,p.dashArray?u.dashStyle=C(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=p.lineCap.replace("butt","flat"),u.joinstyle=p.lineJoin):u&&(y.removeChild(u),o._stroke=null),p.fill?(d||(d=o._fill=gu("fill")),y.appendChild(d),d.color=p.fillColor||p.color,d.opacity=p.fillOpacity):d&&(y.removeChild(d),o._fill=null)},_updateCircle:function(o){var u=o._point.round(),d=Math.round(o._radius),p=Math.round(o._radiusY||d);this._setPath(o,o._empty()?"M0 0":"AL "+u.x+","+u.y+" "+d+","+p+" 0,"+65535*360)},_setPath:function(o,u){o._path.v=u},_bringToFront:function(o){Ii(o._container)},_bringToBack:function(o){Pi(o._container)}},Vc=at.vml?gu:Js,yu=bi.extend({_initContainer:function(){this._container=Vc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Vc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Bt(this._container),Nt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){bi.prototype._update.call(this);var o=this._bounds,u=o.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,d.setAttribute("width",u.x),d.setAttribute("height",u.y)),Xt(d,o.min),d.setAttribute("viewBox",[o.min.x,o.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(o){var u=o._path=Vc("path");o.options.className&&gt(u,o.options.className),o.options.interactive&&gt(u,"leaflet-interactive"),this._updateStyle(o),this._layers[h(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){Bt(o._path),o.removeInteractiveTarget(o._path),delete this._layers[h(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var u=o._path,d=o.options;u&&(d.stroke?(u.setAttribute("stroke",d.color),u.setAttribute("stroke-opacity",d.opacity),u.setAttribute("stroke-width",d.weight),u.setAttribute("stroke-linecap",d.lineCap),u.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?u.setAttribute("stroke-dasharray",d.dashArray):u.removeAttribute("stroke-dasharray"),d.dashOffset?u.setAttribute("stroke-dashoffset",d.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),d.fill?(u.setAttribute("fill",d.fillColor||d.color),u.setAttribute("fill-opacity",d.fillOpacity),u.setAttribute("fill-rule",d.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(o,u){this._setPath(o,Da(o._parts,u))},_updateCircle:function(o){var u=o._point,d=Math.max(Math.round(o._radius),1),p=Math.max(Math.round(o._radiusY),1)||d,y="a"+d+","+p+" 0 1,0 ",T=o._empty()?"M0 0":"M"+(u.x-d)+","+u.y+y+d*2+",0 "+y+-d*2+",0 ";this._setPath(o,T)},_setPath:function(o,u){o._path.setAttribute("d",u)},_bringToFront:function(o){Ii(o._path)},_bringToBack:function(o){Pi(o._path)}});at.vml&&yu.include(B1);function Ag(o){return at.svg||at.vml?new yu(o):null}Tt.include({getRenderer:function(o){var u=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var u=this._paneRenderers[o];return u===void 0&&(u=this._createRenderer({pane:o}),this._paneRenderers[o]=u),u},_createRenderer:function(o){return this.options.preferCanvas&&Sg(o)||Ag(o)}});var xg=yo.extend({initialize:function(o,u){yo.prototype.initialize.call(this,this._boundsToLatLngs(o),u)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=bt(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function z1(o,u){return new xg(o,u)}yu.create=Vc,yu.pointsToPath=Da,ki.geometryToLayer=xc,ki.coordsToLatLng=sf,ki.coordsToLatLngs=Cc,ki.latLngToCoords=of,ki.latLngsToCoords=Rc,ki.getFeature=vo,ki.asFeature=Lc,Tt.mergeOptions({boxZoom:!0});var Cg=Ln.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){ft(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Nt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Bt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ni(),lo(),this._startPoint=this._map.mouseEventToContainerPoint(o),ft(document,{contextmenu:gn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=At("div","leaflet-zoom-box",this._container),gt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var u=new ct(this._point,this._startPoint),d=u.getSize();Xt(this._box,u.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Bt(this._box),Wt(this._container,"leaflet-crosshair")),jn(),Xa(),Nt(document,{contextmenu:gn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var u=new vt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Tt.addInitHook("addHandler","boxZoom",Cg),Tt.mergeOptions({doubleClickZoom:!0});var Rg=Ln.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var u=this._map,d=u.getZoom(),p=u.options.zoomDelta,y=o.originalEvent.shiftKey?d-p:d+p;u.options.doubleClickZoom==="center"?u.setZoom(y):u.setZoomAround(o.containerPoint,y)}});Tt.addInitHook("addHandler","doubleClickZoom",Rg),Tt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Lg=Ln.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new qn(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}gt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Wt(this._map._container,"leaflet-grab"),Wt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=bt(this._map.options.maxBounds);this._offsetLimit=dt(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var u=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(u),this._prunePositions(u)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,u){return o-(o-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;o.x<u.min.x&&(o.x=this._viscousLimit(o.x,u.min.x)),o.y<u.min.y&&(o.y=this._viscousLimit(o.y,u.min.y)),o.x>u.max.x&&(o.x=this._viscousLimit(o.x,u.max.x)),o.y>u.max.y&&(o.y=this._viscousLimit(o.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,u=Math.round(o/2),d=this._initialWorldOffset,p=this._draggable._newPos.x,y=(p-u+d)%o+u-d,T=(p+u+d)%o-u-d,M=Math.abs(y+d)<Math.abs(T+d)?y:T;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=M},_onDragEnd:function(o){var u=this._map,d=u.options,p=!d.inertia||o.noInertia||this._times.length<2;if(u.fire("dragend",o),p)u.fire("moveend");else{this._prunePositions(+new Date);var y=this._lastPos.subtract(this._positions[0]),T=(this._lastTime-this._times[0])/1e3,M=d.easeLinearity,B=y.multiplyBy(M/T),$=B.distanceTo([0,0]),K=Math.min(d.inertiaMaxSpeed,$),it=B.multiplyBy(K/$),ht=K/(d.inertiaDeceleration*M),Et=it.multiplyBy(-ht/2).round();!Et.x&&!Et.y?u.fire("moveend"):(Et=u._limitOffset(Et,u.options.maxBounds),N(function(){u.panBy(Et,{duration:ht,easeLinearity:M,noMoveStart:!0,animate:!0})}))}}});Tt.addInitHook("addHandler","dragging",Lg),Tt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var kg=Ln.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),ft(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Nt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,u=document.documentElement,d=o.scrollTop||u.scrollTop,p=o.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(p,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var u=this._panKeys={},d=this.keyCodes,p,y;for(p=0,y=d.left.length;p<y;p++)u[d.left[p]]=[-1*o,0];for(p=0,y=d.right.length;p<y;p++)u[d.right[p]]=[o,0];for(p=0,y=d.down.length;p<y;p++)u[d.down[p]]=[0,o];for(p=0,y=d.up.length;p<y;p++)u[d.up[p]]=[0,-1*o]},_setZoomDelta:function(o){var u=this._zoomKeys={},d=this.keyCodes,p,y;for(p=0,y=d.zoomIn.length;p<y;p++)u[d.zoomIn[p]]=o;for(p=0,y=d.zoomOut.length;p<y;p++)u[d.zoomOut[p]]=-o},_addHooks:function(){ft(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Nt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var u=o.keyCode,d=this._map,p;if(u in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(p=this._panKeys[u],o.shiftKey&&(p=J(p).multiplyBy(3)),d.options.maxBounds&&(p=d._limitOffset(J(p),d.options.maxBounds)),d.options.worldCopyJump){var y=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(p)));d.panTo(y)}else d.panBy(p)}else if(u in this._zoomKeys)d.setZoom(d.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;gn(o)}}});Tt.addInitHook("addHandler","keyboard",kg),Tt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bg=Ln.extend({addHooks:function(){ft(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Nt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var u=jt(o),d=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var p=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),p),gn(o)},_performZoom:function(){var o=this._map,u=o.getZoom(),d=this._map.options.zoomSnap||0;o._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),y=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,T=d?Math.ceil(y/d)*d:y,M=o._limitZoom(u+(this._delta>0?T:-T))-u;this._delta=0,this._startTime=null,M&&(o.options.scrollWheelZoom==="center"?o.setZoom(u+M):o.setZoomAround(this._lastMousePos,u+M))}});Tt.addInitHook("addHandler","scrollWheelZoom",bg);var U1=600;Tt.mergeOptions({tapHold:at.touchNative&&at.safari&&at.mobile,tapTolerance:15});var Dg=Ln.extend({addHooks:function(){ft(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Nt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var u=o.touches[0];this._startPos=this._newPos=new W(u.clientX,u.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(ft(document,"touchend",pe),ft(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),U1),ft(document,"touchend touchcancel contextmenu",this._cancel,this),ft(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){Nt(document,"touchend",pe),Nt(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),Nt(document,"touchend touchcancel contextmenu",this._cancel,this),Nt(document,"touchmove",this._onMove,this)},_onMove:function(o){var u=o.touches[0];this._newPos=new W(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,u){var d=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});d._simulated=!0,u.target.dispatchEvent(d)}});Tt.addInitHook("addHandler","tapHold",Dg),Tt.mergeOptions({touchZoom:at.touch,bounceAtZoomLimits:!0});var Vg=Ln.extend({addHooks:function(){gt(this._map._container,"leaflet-touch-zoom"),ft(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Wt(this._map._container,"leaflet-touch-zoom"),Nt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var u=this._map;if(!(!o.touches||o.touches.length!==2||u._animatingZoom||this._zooming)){var d=u.mouseEventToContainerPoint(o.touches[0]),p=u.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(d.add(p)._divideBy(2))),this._startDist=d.distanceTo(p),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),ft(document,"touchmove",this._onTouchMove,this),ft(document,"touchend touchcancel",this._onTouchEnd,this),pe(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var u=this._map,d=u.mouseEventToContainerPoint(o.touches[0]),p=u.mouseEventToContainerPoint(o.touches[1]),y=d.distanceTo(p)/this._startDist;if(this._zoom=u.getScaleZoom(y,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&y<1||this._zoom>u.getMaxZoom()&&y>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,y===1)return}else{var T=d._add(p)._divideBy(2)._subtract(this._centerPoint);if(y===1&&T.x===0&&T.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(T),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),O(this._animRequest);var M=a(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=N(M,this,!0),pe(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,O(this._animRequest),Nt(document,"touchmove",this._onTouchMove,this),Nt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Tt.addInitHook("addHandler","touchZoom",Vg),Tt.BoxZoom=Cg,Tt.DoubleClickZoom=Rg,Tt.Drag=Lg,Tt.Keyboard=kg,Tt.ScrollWheelZoom=bg,Tt.TapHold=Dg,Tt.TouchZoom=Vg,e.Bounds=ct,e.Browser=at,e.CRS=de,e.Canvas=Pg,e.Circle=rf,e.CircleMarker=Ac,e.Class=Ft,e.Control=je,e.DivIcon=Eg,e.DivOverlay=si,e.DomEvent=nf,e.DomUtil=_c,e.Draggable=qn,e.Evented=Se,e.FeatureGroup=$e,e.GeoJSON=ki,e.GridLayer=_u,e.Handler=Ln,e.Icon=Gn,e.ImageOverlay=kc,e.LatLng=wt,e.LatLngBounds=vt,e.Layer=mt,e.LayerGroup=Jt,e.LineUtil=v,e.Map=Tt,e.Marker=Sc,e.Mixin=wc,e.Path=hr,e.Point=W,e.PolyUtil=Ec,e.Polygon=yo,e.Polyline=Li,e.Popup=bc,e.PosAnimation=ou,e.Projection=q,e.Rectangle=xg,e.Renderer=bi,e.SVG=yu,e.SVGOverlay=wg,e.TileLayer=wo,e.Tooltip=Dc,e.Transformation=tr,e.Util=D,e.VideoOverlay=vg,e.bind=a,e.bounds=dt,e.canvas=Sg,e.circle=x1,e.circleMarker=A1,e.control=ur,e.divIcon=N1,e.extend=r,e.featureGroup=yn,e.geoJSON=yg,e.geoJson=L1,e.gridLayer=O1,e.icon=pu,e.imageOverlay=k1,e.latLng=pt,e.latLngBounds=bt,e.layerGroup=xe,e.map=yc,e.marker=S1,e.point=J,e.polygon=R1,e.polyline=C1,e.popup=V1,e.rectangle=z1,e.setOptions=R,e.stamp=h,e.svg=Ag,e.svgOverlay=D1,e.tileLayer=Tg,e.tooltip=M1,e.transformation=yi,e.version=i,e.videoOverlay=b1;var j1=window.L;e.noConflict=function(){return window.L=j1,this},window.L=e})})(Bp,Bp.exports);var PA=Bp.exports;const Jc=Tw(PA);var Hy={exports:{}};(function(n,t){(function(e,i){i(t)})(Ew,function(e){var i=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(s){L.Util.setOptions(this,s),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var a=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,a?this._withAnimation:this._noAnimation),this._markerCluster=a?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(s){if(s instanceof L.LayerGroup)return this.addLayers([s]);if(!s.getLatLng)return this._nonPointGroup.addLayer(s),this.fire("layeradd",{layer:s}),this;if(!this._map)return this._needsClustering.push(s),this.fire("layeradd",{layer:s}),this;if(this.hasLayer(s))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(s,this._maxZoom),this.fire("layeradd",{layer:s}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var a=s,l=this._zoom;if(s.__parent)for(;a.__parent._zoom>=l;)a=a.__parent;return this._currentShownBounds.contains(a.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(s,a):this._animationAddLayerNonAnimated(s,a)),this},removeLayer:function(s){return s instanceof L.LayerGroup?this.removeLayers([s]):s.getLatLng?this._map?s.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(s)),this._removeLayer(s,!0),this.fire("layerremove",{layer:s}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),s.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(s)&&(this._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,s)&&this.hasLayer(s)&&this._needsRemoving.push({layer:s,latlng:s._latlng}),this.fire("layerremove",{layer:s}),this):(this._nonPointGroup.removeLayer(s),this.fire("layerremove",{layer:s}),this)},addLayers:function(s,a){if(!L.Util.isArray(s))return this.addLayer(s);var l=this._featureGroup,h=this._nonPointGroup,f=this.options.chunkedLoading,_=this.options.chunkInterval,g=this.options.chunkProgress,w=s.length,E=0,x=!0,R;if(this._map){var z=new Date().getTime(),A=L.bind(function(){var C=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();E<w;E++){if(f&&E%200===0){var j=new Date().getTime()-C;if(j>_)break}if(R=s[E],R instanceof L.LayerGroup){x&&(s=s.slice(),x=!1),this._extractNonGroupLayers(R,s),w=s.length;continue}if(!R.getLatLng){h.addLayer(R),a||this.fire("layeradd",{layer:R});continue}if(!this.hasLayer(R)&&(this._addLayer(R,this._maxZoom),a||this.fire("layeradd",{layer:R}),R.__parent&&R.__parent.getChildCount()===2)){var H=R.__parent.getAllChildMarkers(),Y=H[0]===R?H[1]:H[0];l.removeLayer(Y)}}g&&g(E,w,new Date().getTime()-z),E===w?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(A,this.options.chunkDelay)},this);A()}else for(var S=this._needsClustering;E<w;E++){if(R=s[E],R instanceof L.LayerGroup){x&&(s=s.slice(),x=!1),this._extractNonGroupLayers(R,s),w=s.length;continue}if(!R.getLatLng){h.addLayer(R);continue}this.hasLayer(R)||S.push(R)}return this},removeLayers:function(s){var a,l,h=s.length,f=this._featureGroup,_=this._nonPointGroup,g=!0;if(!this._map){for(a=0;a<h;a++){if(l=s[a],l instanceof L.LayerGroup){g&&(s=s.slice(),g=!1),this._extractNonGroupLayers(l,s),h=s.length;continue}this._arraySplice(this._needsClustering,l),_.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var w=s.slice(),E=h;for(a=0;a<E;a++){if(l=w[a],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,w),E=w.length;continue}this._unspiderfyLayer(l)}}for(a=0;a<h;a++){if(l=s[a],l instanceof L.LayerGroup){g&&(s=s.slice(),g=!1),this._extractNonGroupLayers(l,s),h=s.length;continue}if(!l.__parent){_.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),f.hasLayer(l)&&(f.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(s){s.off(this._childMarkerEventHandlers,this),delete s.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var s=new L.LatLngBounds;this._topClusterLevel&&s.extend(this._topClusterLevel._bounds);for(var a=this._needsClustering.length-1;a>=0;a--)s.extend(this._needsClustering[a].getLatLng());return s.extend(this._nonPointGroup.getBounds()),s},eachLayer:function(s,a){var l=this._needsClustering.slice(),h=this._needsRemoving,f,_,g;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),_=l.length-1;_>=0;_--){for(f=!0,g=h.length-1;g>=0;g--)if(h[g].layer===l[_]){f=!1;break}f&&s.call(a,l[_])}this._nonPointGroup.eachLayer(s,a)},getLayers:function(){var s=[];return this.eachLayer(function(a){s.push(a)}),s},getLayer:function(s){var a=null;return s=parseInt(s,10),this.eachLayer(function(l){L.stamp(l)===s&&(a=l)}),a},hasLayer:function(s){if(!s)return!1;var a,l=this._needsClustering;for(a=l.length-1;a>=0;a--)if(l[a]===s)return!0;for(l=this._needsRemoving,a=l.length-1;a>=0;a--)if(l[a].layer===s)return!1;return!!(s.__parent&&s.__parent._group===this)||this._nonPointGroup.hasLayer(s)},zoomToShowLayer:function(s,a){var l=this._map;typeof a!="function"&&(a=function(){});var h=function(){(l.hasLayer(s)||l.hasLayer(s.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",h,this),this.off("animationend",h,this),l.hasLayer(s)?a():s.__parent._icon&&(this.once("spiderfied",a,this),s.__parent.spiderfy()))};s._icon&&this._map.getBounds().contains(s.getLatLng())?a():s.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",h,this),this._map.panTo(s.getLatLng())):(this._map.on("moveend",h,this),this.on("animationend",h,this),s.__parent.zoomToBounds())},onAdd:function(s){this._map=s;var a,l,h;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(s),this._nonPointGroup.addTo(s),this._gridClusters||this._generateInitialClusters(),this._maxLat=s.options.crs.projection.MAX_LATITUDE,a=0,l=this._needsRemoving.length;a<l;a++)h=this._needsRemoving[a],h.newlatlng=h.layer._latlng,h.layer._latlng=h.latlng;for(a=0,l=this._needsRemoving.length;a<l;a++)h=this._needsRemoving[a],this._removeLayer(h.layer,!0),h.layer._latlng=h.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(s){s.off("zoomend",this._zoomEnd,this),s.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(s){for(var a=s;a&&!a._icon;)a=a.__parent;return a||null},_arraySplice:function(s,a){for(var l=s.length-1;l>=0;l--)if(s[l]===a)return s.splice(l,1),!0},_removeFromGridUnclustered:function(s,a){for(var l=this._map,h=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());a>=f&&h[a].removeObject(s,l.project(s.getLatLng(),a));a--);},_childMarkerDragStart:function(s){s.target.__dragStart=s.target._latlng},_childMarkerMoved:function(s){if(!this._ignoreMove&&!s.target.__dragStart){var a=s.target._popup&&s.target._popup.isOpen();this._moveChild(s.target,s.oldLatLng,s.latlng),a&&s.target.openPopup()}},_moveChild:function(s,a,l){s._latlng=a,this.removeLayer(s),s._latlng=l,this.addLayer(s)},_childMarkerDragEnd:function(s){var a=s.target.__dragStart;delete s.target.__dragStart,a&&this._moveChild(s.target,a,s.target._latlng)},_removeLayer:function(s,a,l){var h=this._gridClusters,f=this._gridUnclustered,_=this._featureGroup,g=this._map,w=Math.floor(this._map.getMinZoom());a&&this._removeFromGridUnclustered(s,this._maxZoom);var E=s.__parent,x=E._markers,R;for(this._arraySplice(x,s);E&&(E._childCount--,E._boundsNeedUpdate=!0,!(E._zoom<w));)a&&E._childCount<=1?(R=E._markers[0]===s?E._markers[1]:E._markers[0],h[E._zoom].removeObject(E,g.project(E._cLatLng,E._zoom)),f[E._zoom].addObject(R,g.project(R.getLatLng(),E._zoom)),this._arraySplice(E.__parent._childClusters,E),E.__parent._markers.push(R),R.__parent=E.__parent,E._icon&&(_.removeLayer(E),l||_.addLayer(R))):E._iconNeedsUpdate=!0,E=E.__parent;delete s.__parent},_isOrIsParent:function(s,a){for(;a;){if(s===a)return!0;a=a.parentNode}return!1},fire:function(s,a,l){if(a&&a.layer instanceof L.MarkerCluster){if(a.originalEvent&&this._isOrIsParent(a.layer._icon,a.originalEvent.relatedTarget))return;s="cluster"+s}L.FeatureGroup.prototype.fire.call(this,s,a,l)},listens:function(s,a){return L.FeatureGroup.prototype.listens.call(this,s,a)||L.FeatureGroup.prototype.listens.call(this,"cluster"+s,a)},_defaultIconCreateFunction:function(s){var a=s.getChildCount(),l=" marker-cluster-";return a<10?l+="small":a<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+a+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var s=this._map,a=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,h=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(a||h||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),s.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(s){var a=s.layer,l=a;if(!(s.type==="clusterkeypress"&&s.originalEvent&&s.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===a._childCount&&this.options.spiderfyOnMaxZoom?a.spiderfy():this.options.zoomToBoundsOnClick&&a.zoomToBounds(),this.options.spiderfyOnEveryZoom&&a.spiderfy(),s.originalEvent&&s.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(s){var a=this._map;this._inZoomAnimation||(this._shownPolygon&&a.removeLayer(this._shownPolygon),s.layer.getChildCount()>2&&s.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(s.layer.getConvexHull(),this.options.polygonOptions),a.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var s=this.options.spiderfyOnMaxZoom,a=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,h=this.options.spiderfyOnEveryZoom,f=this._map;(s||l||h)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),a&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var s=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,s),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),s),this._currentShownBounds=s}},_generateInitialClusters:function(){var s=Math.ceil(this._map.getMaxZoom()),a=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,h=l;typeof l!="function"&&(h=function(){return l}),this.options.disableClusteringAtZoom!==null&&(s=this.options.disableClusteringAtZoom-1),this._maxZoom=s,this._gridClusters={},this._gridUnclustered={};for(var f=s;f>=a;f--)this._gridClusters[f]=new L.DistanceGrid(h(f)),this._gridUnclustered[f]=new L.DistanceGrid(h(f));this._topClusterLevel=new this._markerCluster(this,a-1)},_addLayer:function(s,a){var l=this._gridClusters,h=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),_,g;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(s),s.on(this._childMarkerEventHandlers,this);a>=f;a--){_=this._map.project(s.getLatLng(),a);var w=l[a].getNearObject(_);if(w){w._addChild(s),s.__parent=w;return}if(w=h[a].getNearObject(_),w){var E=w.__parent;E&&this._removeLayer(w,!1);var x=new this._markerCluster(this,a,w,s);l[a].addObject(x,this._map.project(x._cLatLng,a)),w.__parent=x,s.__parent=x;var R=x;for(g=a-1;g>E._zoom;g--)R=new this._markerCluster(this,g,R),l[g].addObject(R,this._map.project(w.getLatLng(),g));E._addChild(R),this._removeFromGridUnclustered(w,a);return}h[a].addObject(s,_)}this._topClusterLevel._addChild(s),s.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(s){s instanceof L.MarkerCluster&&s._iconNeedsUpdate&&s._updateIcon()})},_enqueue:function(s){this._queue.push(s),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var s=0;s<this._queue.length;s++)this._queue[s].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var s=Math.round(this._map._zoom);this._processQueue(),this._zoom<s&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,s)):this._zoom>s?(this._animationStart(),this._animationZoomOut(this._zoom,s)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(s){var a=this._maxLat;return a!==void 0&&(s.getNorth()>=a&&(s._northEast.lat=1/0),s.getSouth()<=-a&&(s._southWest.lat=-1/0)),s},_animationAddLayerNonAnimated:function(s,a){if(a===s)this._featureGroup.addLayer(s);else if(a._childCount===2){a._addToMap();var l=a.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else a._updateIcon()},_extractNonGroupLayers:function(s,a){var l=s.getLayers(),h=0,f;for(a=a||[];h<l.length;h++){if(f=l[h],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,a);continue}a.push(f)}return a},_overrideMarkerIcon:function(s){var a=s.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[s]}});return a}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(s,a){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),s),this._topClusterLevel._recursivelyAddChildrenToMap(null,a,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(s,a){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),s),this._topClusterLevel._recursivelyAddChildrenToMap(null,a,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(s,a){this._animationAddLayerNonAnimated(s,a)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(s,a){var l=this._getExpandedVisibleBounds(),h=this._featureGroup,f=Math.floor(this._map.getMinZoom()),_;this._ignoreMove=!0,this._topClusterLevel._recursively(l,s,f,function(g){var w=g._latlng,E=g._markers,x;for(l.contains(w)||(w=null),g._isSingleParent()&&s+1===a?(h.removeLayer(g),g._recursivelyAddChildrenToMap(null,a,l)):(g.clusterHide(),g._recursivelyAddChildrenToMap(w,a,l)),_=E.length-1;_>=0;_--)x=E[_],l.contains(x._latlng)||h.removeLayer(x)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,a),h.eachLayer(function(g){!(g instanceof L.MarkerCluster)&&g._icon&&g.clusterShow()}),this._topClusterLevel._recursively(l,s,a,function(g){g._recursivelyRestoreChildPositions(a)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,s,f,function(g){h.removeLayer(g),g.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(s,a){this._animationZoomOutSingle(this._topClusterLevel,s-1,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,a,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),s,this._getExpandedVisibleBounds())},_animationAddLayer:function(s,a){var l=this,h=this._featureGroup;h.addLayer(s),a!==s&&(a._childCount>2?(a._updateIcon(),this._forceLayout(),this._animationStart(),s._setPos(this._map.latLngToLayerPoint(a.getLatLng())),s.clusterHide(),this._enqueue(function(){h.removeLayer(s),s.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(a,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(s,a,l){var h=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());s._recursivelyAnimateChildrenInAndAddSelfToMap(h,f,a+1,l);var _=this;this._forceLayout(),s._recursivelyBecomeVisible(h,l),this._enqueue(function(){if(s._childCount===1){var g=s._markers[0];this._ignoreMove=!0,g.setLatLng(g.getLatLng()),this._ignoreMove=!1,g.clusterShow&&g.clusterShow()}else s._recursively(h,l,f,function(w){w._recursivelyRemoveChildrenFromMap(h,f,a+1)});_._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(s){return new L.MarkerClusterGroup(s)};var r=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(s,a,l,h){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:s.options.clusterPane}),this._group=s,this._zoom=a,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),h&&this._addChild(h)},getAllChildMarkers:function(s,a){s=s||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(s,a);for(var h=this._markers.length-1;h>=0;h--)a&&this._markers[h].__dragStart||s.push(this._markers[h]);return s},getChildCount:function(){return this._childCount},zoomToBounds:function(s){for(var a=this._childClusters.slice(),l=this._group._map,h=l.getBoundsZoom(this._bounds),f=this._zoom+1,_=l.getZoom(),g;a.length>0&&h>f;){f++;var w=[];for(g=0;g<a.length;g++)w=w.concat(a[g]._childClusters);a=w}h>f?this._group._map.setView(this._latlng,f):h<=_?this._group._map.setView(this._latlng,_+1):this._group._map.fitBounds(this._bounds,s)},getBounds:function(){var s=new L.LatLngBounds;return s.extend(this._bounds),s},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(s,a){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(s),s instanceof L.MarkerCluster?(a||(this._childClusters.push(s),s.__parent=this),this._childCount+=s._childCount):(a||this._markers.push(s),this._childCount++),this.__parent&&this.__parent._addChild(s,!0)},_setClusterCenter:function(s){this._cLatLng||(this._cLatLng=s._cLatLng||s._latlng)},_resetBounds:function(){var s=this._bounds;s._southWest&&(s._southWest.lat=1/0,s._southWest.lng=1/0),s._northEast&&(s._northEast.lat=-1/0,s._northEast.lng=-1/0)},_recalculateBounds:function(){var s=this._markers,a=this._childClusters,l=0,h=0,f=this._childCount,_,g,w,E;if(f!==0){for(this._resetBounds(),_=0;_<s.length;_++)w=s[_]._latlng,this._bounds.extend(w),l+=w.lat,h+=w.lng;for(_=0;_<a.length;_++)g=a[_],g._boundsNeedUpdate&&g._recalculateBounds(),this._bounds.extend(g._bounds),w=g._wLatLng,E=g._childCount,l+=w.lat*E,h+=w.lng*E;this._latlng=this._wLatLng=new L.LatLng(l/f,h/f),this._boundsNeedUpdate=!1}},_addToMap:function(s){s&&(this._backupLatlng=this._latlng,this.setLatLng(s)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(s,a,l){this._recursively(s,this._group._map.getMinZoom(),l-1,function(h){var f=h._markers,_,g;for(_=f.length-1;_>=0;_--)g=f[_],g._icon&&(g._setPos(a),g.clusterHide())},function(h){var f=h._childClusters,_,g;for(_=f.length-1;_>=0;_--)g=f[_],g._icon&&(g._setPos(a),g.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(s,a,l,h){this._recursively(s,h,a,function(f){f._recursivelyAnimateChildrenIn(s,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),l),f._isSingleParent()&&l-1===h?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(s,a,l)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(s,a){this._recursively(s,this._group._map.getMinZoom(),a,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(s,a,l){this._recursively(l,this._group._map.getMinZoom()-1,a,function(h){if(a!==h._zoom)for(var f=h._markers.length-1;f>=0;f--){var _=h._markers[f];l.contains(_._latlng)&&(s&&(_._backupLatlng=_.getLatLng(),_.setLatLng(s),_.clusterHide&&_.clusterHide()),h._group._featureGroup.addLayer(_))}},function(h){h._addToMap(s)})},_recursivelyRestoreChildPositions:function(s){for(var a=this._markers.length-1;a>=0;a--){var l=this._markers[a];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(s-1===this._zoom)for(var h=this._childClusters.length-1;h>=0;h--)this._childClusters[h]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(s)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(s,a,l,h){var f,_;this._recursively(s,a-1,l-1,function(g){for(_=g._markers.length-1;_>=0;_--)f=g._markers[_],(!h||!h.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(g){for(_=g._childClusters.length-1;_>=0;_--)f=g._childClusters[_],(!h||!h.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(s,a,l,h,f){var _=this._childClusters,g=this._zoom,w,E;if(a<=g&&(h&&h(this),f&&g===l&&f(this)),g<a||g<l)for(w=_.length-1;w>=0;w--)E=_[w],E._boundsNeedUpdate&&E._recalculateBounds(),s.intersects(E._bounds)&&E._recursively(s,a,l,h,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var s=this.options.opacity;return this.setOpacity(0),this.options.opacity=s,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(s){this._cellSize=s,this._sqCellSize=s*s,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(s,a){var l=this._getCoord(a.x),h=this._getCoord(a.y),f=this._grid,_=f[h]=f[h]||{},g=_[l]=_[l]||[],w=L.Util.stamp(s);this._objectPoint[w]=a,g.push(s)},updateObject:function(s,a){this.removeObject(s),this.addObject(s,a)},removeObject:function(s,a){var l=this._getCoord(a.x),h=this._getCoord(a.y),f=this._grid,_=f[h]=f[h]||{},g=_[l]=_[l]||[],w,E;for(delete this._objectPoint[L.Util.stamp(s)],w=0,E=g.length;w<E;w++)if(g[w]===s)return g.splice(w,1),E===1&&delete _[l],!0},eachObject:function(s,a){var l,h,f,_,g,w,E,x=this._grid;for(l in x){g=x[l];for(h in g)for(w=g[h],f=0,_=w.length;f<_;f++)E=s.call(a,w[f]),E&&(f--,_--)}},getNearObject:function(s){var a=this._getCoord(s.x),l=this._getCoord(s.y),h,f,_,g,w,E,x,R,z=this._objectPoint,A=this._sqCellSize,S=null;for(h=l-1;h<=l+1;h++)if(g=this._grid[h],g){for(f=a-1;f<=a+1;f++)if(w=g[f],w)for(_=0,E=w.length;_<E;_++)x=w[_],R=this._sqDist(z[L.Util.stamp(x)],s),(R<A||R<=A&&S===null)&&(A=R,S=x)}return S},_getCoord:function(s){var a=Math.floor(s/this._cellSize);return isFinite(a)?a:s},_sqDist:function(s,a){var l=a.x-s.x,h=a.y-s.y;return l*l+h*h}},function(){L.QuickHull={getDistant:function(s,a){var l=a[1].lat-a[0].lat,h=a[0].lng-a[1].lng;return h*(s.lat-a[0].lat)+l*(s.lng-a[0].lng)},findMostDistantPointFromBaseLine:function(s,a){var l=0,h=null,f=[],_,g,w;for(_=a.length-1;_>=0;_--){if(g=a[_],w=this.getDistant(g,s),w>0)f.push(g);else continue;w>l&&(l=w,h=g)}return{maxPoint:h,newPoints:f}},buildConvexHull:function(s,a){var l=[],h=this.findMostDistantPointFromBaseLine(s,a);return h.maxPoint?(l=l.concat(this.buildConvexHull([s[0],h.maxPoint],h.newPoints)),l=l.concat(this.buildConvexHull([h.maxPoint,s[1]],h.newPoints)),l):[s[0]]},getConvexHull:function(s){var a=!1,l=!1,h=!1,f=!1,_=null,g=null,w=null,E=null,x=null,R=null,z;for(z=s.length-1;z>=0;z--){var A=s[z];(a===!1||A.lat>a)&&(_=A,a=A.lat),(l===!1||A.lat<l)&&(g=A,l=A.lat),(h===!1||A.lng>h)&&(w=A,h=A.lng),(f===!1||A.lng<f)&&(E=A,f=A.lng)}l!==a?(R=g,x=_):(R=E,x=w);var S=[].concat(this.buildConvexHull([R,x],s),this.buildConvexHull([x,R],s));return S}}}(),L.MarkerCluster.include({getConvexHull:function(){var s=this.getAllChildMarkers(),a=[],l,h;for(h=s.length-1;h>=0;h--)l=s[h].getLatLng(),a.push(l);return L.QuickHull.getConvexHull(a)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var s=this.getAllChildMarkers(null,!0),a=this._group,l=a._map,h=l.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(s.length,h):s.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(s.length,h):(h.y+=10,f=this._generatePointsCircle(s.length,h)),this._animationSpiderfy(s,f)}},unspiderfy:function(s){this._group._inZoomAnimation||(this._animationUnspiderfy(s),this._group._spiderfied=null)},_generatePointsCircle:function(s,a){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+s),h=l/this._2PI,f=this._2PI/s,_=[],g,w;for(h=Math.max(h,35),_.length=s,g=0;g<s;g++)w=this._circleStartAngle+g*f,_[g]=new L.Point(a.x+h*Math.cos(w),a.y+h*Math.sin(w))._round();return _},_generatePointsSpiral:function(s,a){var l=this._group.options.spiderfyDistanceMultiplier,h=l*this._spiralLengthStart,f=l*this._spiralFootSeparation,_=l*this._spiralLengthFactor*this._2PI,g=0,w=[],E;for(w.length=s,E=s;E>=0;E--)E<s&&(w[E]=new L.Point(a.x+h*Math.cos(g),a.y+h*Math.sin(g))._round()),g+=f/h+E*5e-4,h+=_/g;return w},_noanimationUnspiderfy:function(){var s=this._group,a=s._map,l=s._featureGroup,h=this.getAllChildMarkers(null,!0),f,_;for(s._ignoreMove=!0,this.setOpacity(1),_=h.length-1;_>=0;_--)f=h[_],l.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(a.removeLayer(f._spiderLeg),delete f._spiderLeg);s.fire("unspiderfied",{cluster:this,markers:h}),s._ignoreMove=!1,s._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(s,a){var l=this._group,h=l._map,f=l._featureGroup,_=this._group.options.spiderLegPolylineOptions,g,w,E,x;for(l._ignoreMove=!0,g=0;g<s.length;g++)x=h.layerPointToLatLng(a[g]),w=s[g],E=new L.Polyline([this._latlng,x],_),h.addLayer(E),w._spiderLeg=E,w._preSpiderfyLatlng=w._latlng,w.setLatLng(x),w.setZIndexOffset&&w.setZIndexOffset(1e6),f.addLayer(w);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:s})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(s,a){var l=this,h=this._group,f=h._map,_=h._featureGroup,g=this._latlng,w=f.latLngToLayerPoint(g),E=L.Path.SVG,x=L.extend({},this._group.options.spiderLegPolylineOptions),R=x.opacity,z,A,S,C,j,H;for(R===void 0&&(R=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),E?(x.opacity=0,x.className=(x.className||"")+" leaflet-cluster-spider-leg"):x.opacity=R,h._ignoreMove=!0,z=0;z<s.length;z++)A=s[z],H=f.layerPointToLatLng(a[z]),S=new L.Polyline([g,H],x),f.addLayer(S),A._spiderLeg=S,E&&(C=S._path,j=C.getTotalLength()+.1,C.style.strokeDasharray=j,C.style.strokeDashoffset=j),A.setZIndexOffset&&A.setZIndexOffset(1e6),A.clusterHide&&A.clusterHide(),_.addLayer(A),A._setPos&&A._setPos(w);for(h._forceLayout(),h._animationStart(),z=s.length-1;z>=0;z--)H=f.layerPointToLatLng(a[z]),A=s[z],A._preSpiderfyLatlng=A._latlng,A.setLatLng(H),A.clusterShow&&A.clusterShow(),E&&(S=A._spiderLeg,C=S._path,C.style.strokeDashoffset=0,S.setStyle({opacity:R}));this.setOpacity(.3),h._ignoreMove=!1,setTimeout(function(){h._animationEnd(),h.fire("spiderfied",{cluster:l,markers:s})},200)},_animationUnspiderfy:function(s){var a=this,l=this._group,h=l._map,f=l._featureGroup,_=s?h._latLngToNewLayerPoint(this._latlng,s.zoom,s.center):h.latLngToLayerPoint(this._latlng),g=this.getAllChildMarkers(null,!0),w=L.Path.SVG,E,x,R,z,A,S;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),x=g.length-1;x>=0;x--)E=g[x],E._preSpiderfyLatlng&&(E.closePopup(),E.setLatLng(E._preSpiderfyLatlng),delete E._preSpiderfyLatlng,S=!0,E._setPos&&(E._setPos(_),S=!1),E.clusterHide&&(E.clusterHide(),S=!1),S&&f.removeLayer(E),w&&(R=E._spiderLeg,z=R._path,A=z.getTotalLength()+.1,z.style.strokeDashoffset=A,R.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var C=0;for(x=g.length-1;x>=0;x--)E=g[x],E._spiderLeg&&C++;for(x=g.length-1;x>=0;x--)E=g[x],E._spiderLeg&&(E.clusterShow&&E.clusterShow(),E.setZIndexOffset&&E.setZIndexOffset(0),C>1&&f.removeLayer(E),h.removeLayer(E._spiderLeg),delete E._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:a,markers:g})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(s){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(s))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(s){this._spiderfied&&this._spiderfied.unspiderfy(s)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(s){s._spiderLeg&&(this._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow(),s.setZIndexOffset&&s.setZIndexOffset(0),this._map.removeLayer(s._spiderLeg),delete s._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(s){return s?s instanceof L.MarkerClusterGroup?s=s._topClusterLevel.getAllChildMarkers():s instanceof L.LayerGroup?s=s._layers:s instanceof L.MarkerCluster?s=s.getAllChildMarkers():s instanceof L.Marker&&(s=[s]):s=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(s),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(s),this},_flagParentsIconsNeedUpdate:function(s){var a,l;for(a in s)for(l=s[a].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(s){var a,l;for(a in s)l=s[a],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(s,a){var l=this.options.icon;return L.setOptions(l,s),this.setIcon(l),a&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),e.MarkerClusterGroup=i,e.MarkerCluster=r,Object.defineProperty(e,"__esModule",{value:!0})})})(Hy,Hy.exports);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=r&63|128):(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=r&63|128)}return t},SA=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const r=n[e++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[e++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[e++],a=n[e++],l=n[e++],h=((r&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;t[i++]=String.fromCharCode(55296+(h>>10)),t[i++]=String.fromCharCode(56320+(h&1023))}else{const s=n[e++],a=n[e++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|a&63)}}return t.join("")},NE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],a=r+1<n.length,l=a?n[r+1]:0,h=r+2<n.length,f=h?n[r+2]:0,_=s>>2,g=(s&3)<<4|l>>4;let w=(l&15)<<2|f>>6,E=f&63;h||(E=64,a||(w=64)),i.push(e[_],e[g],e[w],e[E])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(ME(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):SA(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=e[n.charAt(r++)],l=r<n.length?e[n.charAt(r)]:0;++r;const f=r<n.length?e[n.charAt(r)]:64;++r;const g=r<n.length?e[n.charAt(r)]:64;if(++r,s==null||l==null||f==null||g==null)throw new AA;const w=s<<2|l>>4;if(i.push(w),f!==64){const E=l<<4&240|f>>2;if(i.push(E),g!==64){const x=f<<6&192|g;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class AA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xA=function(n){const t=ME(n);return NE.encodeByteArray(t,!0)},Qh=function(n){return xA(n).replace(/\./g,"")},CA=function(n){try{return NE.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Yh(n,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const e=t;return new Date(e.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!RA(e)||(n[e]=Yh(n[e],t[e]));return n}function RA(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=()=>OE().__FIREBASE_DEFAULTS__,kA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},bA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&CA(n[1]);return t&&JSON.parse(t)},FE=()=>{try{return LA()||kA()||bA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},BE=()=>{var n;return(n=FE())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[Qh(JSON.stringify(e)),Qh(JSON.stringify(a)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MA(){var n;const t=(n=FE())===null||n===void 0?void 0:n.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NA(){return typeof window<"u"||zE()}function zE(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function UE(){return!MA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jE(){try{return typeof indexedDB=="object"}catch{return!1}}function OA(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{var s;t(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA="FirebaseError";class Hs extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=FA,Object.setPrototypeOf(this,Hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rd.prototype.create)}}class Rd{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},r=`${this.service}/${t}`,s=this.errors[t],a=s?BA(s,i):"Error",l=`${this.serviceName}: ${a} (${r}).`;return new Hs(r,l,i)}}function BA(n,t){return n.replace(zA,(e,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const zA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function yl(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const r of e){if(!i.includes(r))return!1;const s=n[r],a=t[r];if(Zy(s)&&Zy(a)){if(!yl(s,a))return!1}else if(s!==a)return!1}for(const r of i)if(!e.includes(r))return!1;return!0}function Zy(n){return n!==null&&typeof n=="object"}function UA(n,t){const e=new jA(n,t);return e.subscribe.bind(e)}class jA{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let r;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");$A(t,["next","error","complete"])?r=t:r={next:t,error:e,complete:i},r.next===void 0&&(r.next=Mf),r.error===void 0&&(r.error=Mf),r.complete===void 0&&(r.complete=Mf);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $A(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function Mf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n){return n&&n._delegate?n._delegate:n}class Ms{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new DA;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(WA(t))try{this.getOrInitializeService({instanceIdentifier:ms})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=ms){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ms){return this.instances.has(t)}getOptions(t=ms){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&a.resolve(r)}return r}onInit(t,e){var i;const r=this.normalizeInstanceIdentifier(e),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(t),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&t(a,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const r of i)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:GA(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=ms){return this.component?this.component.multipleInstances?t:ms:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GA(n){return n===ms?void 0:n}function WA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new qA(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=[];var xt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(xt||(xt={}));const qE={debug:xt.DEBUG,verbose:xt.VERBOSE,info:xt.INFO,warn:xt.WARN,error:xt.ERROR,silent:xt.SILENT},HA=xt.INFO,KA={[xt.DEBUG]:"log",[xt.VERBOSE]:"log",[xt.INFO]:"info",[xt.WARN]:"warn",[xt.ERROR]:"error"},ZA=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),r=KA[t];if(r)console[r](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class u_{constructor(t){this.name=t,this._logLevel=HA,this._logHandler=ZA,this._userLogHandler=null,a_.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in xt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?qE[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,xt.DEBUG,...t),this._logHandler(this,xt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,xt.VERBOSE,...t),this._logHandler(this,xt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,xt.INFO,...t),this._logHandler(this,xt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,xt.WARN,...t),this._logHandler(this,xt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,xt.ERROR,...t),this._logHandler(this,xt.ERROR,...t)}}function QA(n){a_.forEach(t=>{t.setLogLevel(n)})}function YA(n,t){for(const e of a_){let i=null;t&&t.level&&(i=qE[t.level]),n===null?e.userLogHandler=null:e.userLogHandler=(r,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(i??r.logLevel)&&n({level:xt[s].toLowerCase(),message:l,args:a,type:r.name})}}}const XA=(n,t)=>t.some(e=>n instanceof e);let Qy,Yy;function JA(){return Qy||(Qy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tx(){return Yy||(Yy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GE=new WeakMap,zp=new WeakMap,WE=new WeakMap,Nf=new WeakMap,l_=new WeakMap;function ex(n){const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{e(Dr(n.result)),r()},a=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",a)});return t.then(e=>{e instanceof IDBCursor&&GE.set(e,n)}).catch(()=>{}),l_.set(t,n),t}function nx(n){if(zp.has(n))return;const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{e(),r()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});zp.set(n,t)}let Up={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return zp.get(n);if(t==="objectStoreNames")return n.objectStoreNames||WE.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Dr(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function ix(n){Up=n(Up)}function rx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(Of(this),t,...e);return WE.set(i,t.sort?t.sort():[t]),Dr(i)}:tx().includes(n)?function(...t){return n.apply(Of(this),t),Dr(GE.get(this))}:function(...t){return Dr(n.apply(Of(this),t))}}function sx(n){return typeof n=="function"?rx(n):(n instanceof IDBTransaction&&nx(n),XA(n,JA())?new Proxy(n,Up):n)}function Dr(n){if(n instanceof IDBRequest)return ex(n);if(Nf.has(n))return Nf.get(n);const t=sx(n);return t!==n&&(Nf.set(n,t),l_.set(t,n)),t}const Of=n=>l_.get(n);function ox(n,t,{blocked:e,upgrade:i,blocking:r,terminated:s}={}){const a=indexedDB.open(n,t),l=Dr(a);return i&&a.addEventListener("upgradeneeded",h=>{i(Dr(a.result),h.oldVersion,h.newVersion,Dr(a.transaction),h)}),e&&a.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),r&&h.addEventListener("versionchange",f=>r(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const ax=["get","getKey","getAll","getAllKeys","count"],ux=["put","add","delete","clear"],Ff=new Map;function Xy(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Ff.get(t))return Ff.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,r=ux.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(r||ax.includes(e)))return;const s=async function(a,...l){const h=this.transaction(a,r?"readwrite":"readonly");let f=h.store;return i&&(f=f.index(l.shift())),(await Promise.all([f[e](...l),r&&h.done]))[0]};return Ff.set(t,s),s}ix(n=>({...n,get:(t,e,i)=>Xy(t,e)||n.get(t,e,i),has:(t,e)=>!!Xy(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(cx(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function cx(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Jh="@firebase/app",jp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi=new u_("@firebase/app"),hx="@firebase/app-compat",dx="@firebase/analytics-compat",fx="@firebase/analytics",px="@firebase/app-check-compat",mx="@firebase/app-check",_x="@firebase/auth",gx="@firebase/auth-compat",yx="@firebase/database",vx="@firebase/data-connect",wx="@firebase/database-compat",Ex="@firebase/functions",Tx="@firebase/functions-compat",Ix="@firebase/installations",Px="@firebase/installations-compat",Sx="@firebase/messaging",Ax="@firebase/messaging-compat",xx="@firebase/performance",Cx="@firebase/performance-compat",Rx="@firebase/remote-config",Lx="@firebase/remote-config-compat",kx="@firebase/storage",bx="@firebase/storage-compat",Dx="@firebase/firestore",Vx="@firebase/vertexai-preview",Mx="@firebase/firestore-compat",Nx="firebase",Ox="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or="[DEFAULT]",Fx={[Jh]:"fire-core",[hx]:"fire-core-compat",[fx]:"fire-analytics",[dx]:"fire-analytics-compat",[mx]:"fire-app-check",[px]:"fire-app-check-compat",[_x]:"fire-auth",[gx]:"fire-auth-compat",[yx]:"fire-rtdb",[vx]:"fire-data-connect",[wx]:"fire-rtdb-compat",[Ex]:"fire-fn",[Tx]:"fire-fn-compat",[Ix]:"fire-iid",[Px]:"fire-iid-compat",[Sx]:"fire-fcm",[Ax]:"fire-fcm-compat",[xx]:"fire-perf",[Cx]:"fire-perf-compat",[Rx]:"fire-rc",[Lx]:"fire-rc-compat",[kx]:"fire-gcs",[bx]:"fire-gcs-compat",[Dx]:"fire-fst",[Mx]:"fire-fst-compat",[Vx]:"fire-vertex","fire-js":"fire-js",[Nx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr=new Map,sa=new Map,oa=new Map;function vl(n,t){try{n.container.addComponent(t)}catch(e){Wi.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function HE(n,t){n.container.addOrOverwriteComponent(t)}function aa(n){const t=n.name;if(oa.has(t))return Wi.debug(`There were multiple attempts to register component ${t}.`),!1;oa.set(t,n);for(const e of Fr.values())vl(e,n);for(const e of sa.values())vl(e,n);return!0}function KE(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function Bx(n,t,e=Or){KE(n,t).clearInstance(e)}function ZE(n){return n.options!==void 0}function zx(n){return n.settings!==void 0}function Ux(){oa.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},On=new Rd("app","Firebase",jx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QE=class{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ms("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw On.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x extends QE{constructor(t,e,i,r){const s=e.automaticDataCollectionEnabled!==void 0?e.automaticDataCollectionEnabled:!1,a={name:i,automaticDataCollectionEnabled:s};if(t.apiKey!==void 0)super(t,a,r);else{const l=t;super(l.options,a,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},e),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,e.releaseOnDeref=void 0,Ui(Jh,jp,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(t){this.isDeleted||(this._refCount++,t!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(t,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){d_(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw On.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_=Ox;function h_(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i=Object.assign({name:Or,automaticDataCollectionEnabled:!1},t),r=i.name;if(typeof r!="string"||!r)throw On.create("bad-app-name",{appName:String(r)});if(e||(e=BE()),!e)throw On.create("no-options");const s=Fr.get(r);if(s){if(yl(e,s.options)&&yl(i,s.config))return s;throw On.create("duplicate-app",{appName:r})}const a=new $E(r);for(const h of oa.values())a.addComponent(h);const l=new QE(e,i,a);return Fr.set(r,l),l}function qx(n,t){if(NA()&&!zE())throw On.create("invalid-server-app-environment");t.automaticDataCollectionEnabled===void 0&&(t.automaticDataCollectionEnabled=!1);let e;ZE(n)?e=n.options:e=n;const i=Object.assign(Object.assign({},t),e);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const r=f=>[...f].reduce((_,g)=>Math.imul(31,_)+g.charCodeAt(0)|0,0);if(t.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw On.create("finalization-registry-not-supported",{});const s=""+r(JSON.stringify(i)),a=sa.get(s);if(a)return a.incRefCount(t.releaseOnDeref),a;const l=new $E(s);for(const f of oa.values())l.addComponent(f);const h=new $x(e,t,s,l);return sa.set(s,h),h}function Gx(n=Or){const t=Fr.get(n);if(!t&&n===Or&&BE())return h_();if(!t)throw On.create("no-app",{appName:n});return t}function Wx(){return Array.from(Fr.values())}async function d_(n){let t=!1;const e=n.name;Fr.has(e)?(t=!0,Fr.delete(e)):sa.has(e)&&n.decRefCount()<=0&&(sa.delete(e),t=!0),t&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function Ui(n,t,e){var i;let r=(i=Fx[n])!==null&&i!==void 0?i:n;e&&(r+=`-${e}`);const s=r.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${t}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Wi.warn(l.join(" "));return}aa(new Ms(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}function YE(n,t){if(n!==null&&typeof n!="function")throw On.create("invalid-log-argument");YA(n,t)}function XE(n){QA(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx="firebase-heartbeat-database",Kx=1,wl="firebase-heartbeat-store";let Bf=null;function JE(){return Bf||(Bf=ox(Hx,Kx,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(wl)}catch(e){console.warn(e)}}}}).catch(n=>{throw On.create("idb-open",{originalErrorMessage:n.message})})),Bf}async function Zx(n){try{const e=(await JE()).transaction(wl),i=await e.objectStore(wl).get(tT(n));return await e.done,i}catch(t){if(t instanceof Hs)Wi.warn(t.message);else{const e=On.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Wi.warn(e.message)}}}async function Jy(n,t){try{const i=(await JE()).transaction(wl,"readwrite");await i.objectStore(wl).put(t,tT(n)),await i.done}catch(e){if(e instanceof Hs)Wi.warn(e.message);else{const i=On.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});Wi.warn(i.message)}}}function tT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx=1024,Yx=30*24*60*60*1e3;class Xx{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new tC(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,e;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tv();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Yx}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Wi.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=tv(),{heartbeatsToSend:i,unsentEntries:r}=Jx(this._heartbeatsCache.heartbeats),s=Qh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Wi.warn(e),""}}}function tv(){return new Date().toISOString().substring(0,10)}function Jx(n,t=Qx){const e=[];let i=n.slice();for(const r of n){const s=e.find(a=>a.agent===r.agent);if(s){if(s.dates.push(r.date),ev(e)>t){s.dates.pop();break}}else if(e.push({agent:r.agent,dates:[r.date]}),ev(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class tC{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jE()?OA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Zx(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return Jy(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return Jy(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function ev(n){return Qh(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(n){aa(new Ms("platform-logger",t=>new lx(t),"PRIVATE")),aa(new Ms("heartbeat",t=>new Xx(t),"PRIVATE")),Ui(Jh,jp,n),Ui(Jh,jp,"esm2017"),Ui("fire-js","")}eC("");const nC=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Hs,SDK_VERSION:c_,_DEFAULT_ENTRY_NAME:Or,_addComponent:vl,_addOrOverwriteComponent:HE,_apps:Fr,_clearComponents:Ux,_components:oa,_getProvider:KE,_isFirebaseApp:ZE,_isFirebaseServerApp:zx,_registerComponent:aa,_removeServiceInstance:Bx,_serverApps:sa,deleteApp:d_,getApp:Gx,getApps:Wx,initializeApp:h_,initializeServerApp:qx,onLog:YE,registerVersion:Ui,setLogLevel:XE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(t,e){this._delegate=t,this.firebase=e,vl(t,new Ms("app-compat",()=>this,"PUBLIC")),this.container=t.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this._delegate.automaticDataCollectionEnabled=t}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(t=>{this._delegate.checkDestroyed(),t()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),d_(this._delegate)))}_getService(t,e=Or){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(t);return!r.isInitialized()&&((i=r.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:e})}_removeServiceInstance(t,e=Or){this._delegate.container.getProvider(t).clearInstance(e)}_addComponent(t){vl(this._delegate,t)}_addOrOverwriteComponent(t){HE(this._delegate,t)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},nv=new Rd("app-compat","Firebase",rC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(n){const t={},e={__esModule:!0,initializeApp:s,app:r,registerVersion:Ui,setLogLevel:XE,onLog:YE,apps:null,SDK_VERSION:c_,INTERNAL:{registerComponent:l,removeApp:i,useAsService:h,modularAPIs:nC}};e.default=e,Object.defineProperty(e,"apps",{get:a});function i(f){delete t[f]}function r(f){if(f=f||Or,!Ky(t,f))throw nv.create("no-app",{appName:f});return t[f]}r.App=n;function s(f,_={}){const g=h_(f,_);if(Ky(t,g.name))return t[g.name];const w=new n(g,e);return t[g.name]=w,w}function a(){return Object.keys(t).map(f=>t[f])}function l(f){const _=f.name,g=_.replace("-compat","");if(aa(f)&&f.type==="PUBLIC"){const w=(E=r())=>{if(typeof E[g]!="function")throw nv.create("invalid-app-argument",{appName:_});return E[g]()};f.serviceProps!==void 0&&Yh(w,f.serviceProps),e[g]=w,n.prototype[g]=function(...E){return this._getService.bind(this,_).apply(this,f.multipleInstances?E:[])}}return f.type==="PUBLIC"?e[g]:null}function h(f,_){return _==="serverAuth"?null:_}return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(){const n=sC(iC);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:eT,extendNamespace:t,createSubscribe:UA,ErrorFactory:Rd,deepExtend:Yh});function t(e){Yh(n,e)}return n}const oC=eT();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv=new u_("@firebase/app-compat"),aC="@firebase/app-compat",uC="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(n){Ui(aC,uC,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=OE();if(n.firebase!==void 0){iv.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const t=n.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&iv.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const El=oC;lC();var cC="firebase",hC="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */El.registerVersion(cC,hC,"app-compat");var rv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rs,nT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(k,P){function b(){}b.prototype=P.prototype,k.D=P.prototype,k.prototype=new b,k.prototype.constructor=k,k.C=function(V,N,O){for(var D=Array(arguments.length-2),Ft=2;Ft<arguments.length;Ft++)D[Ft-2]=arguments[Ft];return P.prototype[N].apply(V,D)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,e),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,P,b){b||(b=0);var V=Array(16);if(typeof P=="string")for(var N=0;16>N;++N)V[N]=P.charCodeAt(b++)|P.charCodeAt(b++)<<8|P.charCodeAt(b++)<<16|P.charCodeAt(b++)<<24;else for(N=0;16>N;++N)V[N]=P[b++]|P[b++]<<8|P[b++]<<16|P[b++]<<24;P=k.g[0],b=k.g[1],N=k.g[2];var O=k.g[3],D=P+(O^b&(N^O))+V[0]+3614090360&4294967295;P=b+(D<<7&4294967295|D>>>25),D=O+(N^P&(b^N))+V[1]+3905402710&4294967295,O=P+(D<<12&4294967295|D>>>20),D=N+(b^O&(P^b))+V[2]+606105819&4294967295,N=O+(D<<17&4294967295|D>>>15),D=b+(P^N&(O^P))+V[3]+3250441966&4294967295,b=N+(D<<22&4294967295|D>>>10),D=P+(O^b&(N^O))+V[4]+4118548399&4294967295,P=b+(D<<7&4294967295|D>>>25),D=O+(N^P&(b^N))+V[5]+1200080426&4294967295,O=P+(D<<12&4294967295|D>>>20),D=N+(b^O&(P^b))+V[6]+2821735955&4294967295,N=O+(D<<17&4294967295|D>>>15),D=b+(P^N&(O^P))+V[7]+4249261313&4294967295,b=N+(D<<22&4294967295|D>>>10),D=P+(O^b&(N^O))+V[8]+1770035416&4294967295,P=b+(D<<7&4294967295|D>>>25),D=O+(N^P&(b^N))+V[9]+2336552879&4294967295,O=P+(D<<12&4294967295|D>>>20),D=N+(b^O&(P^b))+V[10]+4294925233&4294967295,N=O+(D<<17&4294967295|D>>>15),D=b+(P^N&(O^P))+V[11]+2304563134&4294967295,b=N+(D<<22&4294967295|D>>>10),D=P+(O^b&(N^O))+V[12]+1804603682&4294967295,P=b+(D<<7&4294967295|D>>>25),D=O+(N^P&(b^N))+V[13]+4254626195&4294967295,O=P+(D<<12&4294967295|D>>>20),D=N+(b^O&(P^b))+V[14]+2792965006&4294967295,N=O+(D<<17&4294967295|D>>>15),D=b+(P^N&(O^P))+V[15]+1236535329&4294967295,b=N+(D<<22&4294967295|D>>>10),D=P+(N^O&(b^N))+V[1]+4129170786&4294967295,P=b+(D<<5&4294967295|D>>>27),D=O+(b^N&(P^b))+V[6]+3225465664&4294967295,O=P+(D<<9&4294967295|D>>>23),D=N+(P^b&(O^P))+V[11]+643717713&4294967295,N=O+(D<<14&4294967295|D>>>18),D=b+(O^P&(N^O))+V[0]+3921069994&4294967295,b=N+(D<<20&4294967295|D>>>12),D=P+(N^O&(b^N))+V[5]+3593408605&4294967295,P=b+(D<<5&4294967295|D>>>27),D=O+(b^N&(P^b))+V[10]+38016083&4294967295,O=P+(D<<9&4294967295|D>>>23),D=N+(P^b&(O^P))+V[15]+3634488961&4294967295,N=O+(D<<14&4294967295|D>>>18),D=b+(O^P&(N^O))+V[4]+3889429448&4294967295,b=N+(D<<20&4294967295|D>>>12),D=P+(N^O&(b^N))+V[9]+568446438&4294967295,P=b+(D<<5&4294967295|D>>>27),D=O+(b^N&(P^b))+V[14]+3275163606&4294967295,O=P+(D<<9&4294967295|D>>>23),D=N+(P^b&(O^P))+V[3]+4107603335&4294967295,N=O+(D<<14&4294967295|D>>>18),D=b+(O^P&(N^O))+V[8]+1163531501&4294967295,b=N+(D<<20&4294967295|D>>>12),D=P+(N^O&(b^N))+V[13]+2850285829&4294967295,P=b+(D<<5&4294967295|D>>>27),D=O+(b^N&(P^b))+V[2]+4243563512&4294967295,O=P+(D<<9&4294967295|D>>>23),D=N+(P^b&(O^P))+V[7]+1735328473&4294967295,N=O+(D<<14&4294967295|D>>>18),D=b+(O^P&(N^O))+V[12]+2368359562&4294967295,b=N+(D<<20&4294967295|D>>>12),D=P+(b^N^O)+V[5]+4294588738&4294967295,P=b+(D<<4&4294967295|D>>>28),D=O+(P^b^N)+V[8]+2272392833&4294967295,O=P+(D<<11&4294967295|D>>>21),D=N+(O^P^b)+V[11]+1839030562&4294967295,N=O+(D<<16&4294967295|D>>>16),D=b+(N^O^P)+V[14]+4259657740&4294967295,b=N+(D<<23&4294967295|D>>>9),D=P+(b^N^O)+V[1]+2763975236&4294967295,P=b+(D<<4&4294967295|D>>>28),D=O+(P^b^N)+V[4]+1272893353&4294967295,O=P+(D<<11&4294967295|D>>>21),D=N+(O^P^b)+V[7]+4139469664&4294967295,N=O+(D<<16&4294967295|D>>>16),D=b+(N^O^P)+V[10]+3200236656&4294967295,b=N+(D<<23&4294967295|D>>>9),D=P+(b^N^O)+V[13]+681279174&4294967295,P=b+(D<<4&4294967295|D>>>28),D=O+(P^b^N)+V[0]+3936430074&4294967295,O=P+(D<<11&4294967295|D>>>21),D=N+(O^P^b)+V[3]+3572445317&4294967295,N=O+(D<<16&4294967295|D>>>16),D=b+(N^O^P)+V[6]+76029189&4294967295,b=N+(D<<23&4294967295|D>>>9),D=P+(b^N^O)+V[9]+3654602809&4294967295,P=b+(D<<4&4294967295|D>>>28),D=O+(P^b^N)+V[12]+3873151461&4294967295,O=P+(D<<11&4294967295|D>>>21),D=N+(O^P^b)+V[15]+530742520&4294967295,N=O+(D<<16&4294967295|D>>>16),D=b+(N^O^P)+V[2]+3299628645&4294967295,b=N+(D<<23&4294967295|D>>>9),D=P+(N^(b|~O))+V[0]+4096336452&4294967295,P=b+(D<<6&4294967295|D>>>26),D=O+(b^(P|~N))+V[7]+1126891415&4294967295,O=P+(D<<10&4294967295|D>>>22),D=N+(P^(O|~b))+V[14]+2878612391&4294967295,N=O+(D<<15&4294967295|D>>>17),D=b+(O^(N|~P))+V[5]+4237533241&4294967295,b=N+(D<<21&4294967295|D>>>11),D=P+(N^(b|~O))+V[12]+1700485571&4294967295,P=b+(D<<6&4294967295|D>>>26),D=O+(b^(P|~N))+V[3]+2399980690&4294967295,O=P+(D<<10&4294967295|D>>>22),D=N+(P^(O|~b))+V[10]+4293915773&4294967295,N=O+(D<<15&4294967295|D>>>17),D=b+(O^(N|~P))+V[1]+2240044497&4294967295,b=N+(D<<21&4294967295|D>>>11),D=P+(N^(b|~O))+V[8]+1873313359&4294967295,P=b+(D<<6&4294967295|D>>>26),D=O+(b^(P|~N))+V[15]+4264355552&4294967295,O=P+(D<<10&4294967295|D>>>22),D=N+(P^(O|~b))+V[6]+2734768916&4294967295,N=O+(D<<15&4294967295|D>>>17),D=b+(O^(N|~P))+V[13]+1309151649&4294967295,b=N+(D<<21&4294967295|D>>>11),D=P+(N^(b|~O))+V[4]+4149444226&4294967295,P=b+(D<<6&4294967295|D>>>26),D=O+(b^(P|~N))+V[11]+3174756917&4294967295,O=P+(D<<10&4294967295|D>>>22),D=N+(P^(O|~b))+V[2]+718787259&4294967295,N=O+(D<<15&4294967295|D>>>17),D=b+(O^(N|~P))+V[9]+3951481745&4294967295,k.g[0]=k.g[0]+P&4294967295,k.g[1]=k.g[1]+(N+(D<<21&4294967295|D>>>11))&4294967295,k.g[2]=k.g[2]+N&4294967295,k.g[3]=k.g[3]+O&4294967295}i.prototype.u=function(k,P){P===void 0&&(P=k.length);for(var b=P-this.blockSize,V=this.B,N=this.h,O=0;O<P;){if(N==0)for(;O<=b;)r(this,k,O),O+=this.blockSize;if(typeof k=="string"){for(;O<P;)if(V[N++]=k.charCodeAt(O++),N==this.blockSize){r(this,V),N=0;break}}else for(;O<P;)if(V[N++]=k[O++],N==this.blockSize){r(this,V),N=0;break}}this.h=N,this.o+=P},i.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var P=1;P<k.length-8;++P)k[P]=0;var b=8*this.o;for(P=k.length-8;P<k.length;++P)k[P]=b&255,b/=256;for(this.u(k),k=Array(16),P=b=0;4>P;++P)for(var V=0;32>V;V+=8)k[b++]=this.g[P]>>>V&255;return k};function s(k,P){var b=l;return Object.prototype.hasOwnProperty.call(b,k)?b[k]:b[k]=P(k)}function a(k,P){this.h=P;for(var b=[],V=!0,N=k.length-1;0<=N;N--){var O=k[N]|0;V&&O==P||(b[N]=O,V=!1)}this.g=b}var l={};function h(k){return-128<=k&&128>k?s(k,function(P){return new a([P|0],0>P?-1:0)}):new a([k|0],0>k?-1:0)}function f(k){if(isNaN(k)||!isFinite(k))return g;if(0>k)return z(f(-k));for(var P=[],b=1,V=0;k>=b;V++)P[V]=k/b|0,b*=4294967296;return new a(P,0)}function _(k,P){if(k.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(k.charAt(0)=="-")return z(_(k.substring(1),P));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=f(Math.pow(P,8)),V=g,N=0;N<k.length;N+=8){var O=Math.min(8,k.length-N),D=parseInt(k.substring(N,N+O),P);8>O?(O=f(Math.pow(P,O)),V=V.j(O).add(f(D))):(V=V.j(b),V=V.add(f(D)))}return V}var g=h(0),w=h(1),E=h(16777216);n=a.prototype,n.m=function(){if(R(this))return-z(this).m();for(var k=0,P=1,b=0;b<this.g.length;b++){var V=this.i(b);k+=(0<=V?V:4294967296+V)*P,P*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(x(this))return"0";if(R(this))return"-"+z(this).toString(k);for(var P=f(Math.pow(k,6)),b=this,V="";;){var N=j(b,P).g;b=A(b,N.j(P));var O=((0<b.g.length?b.g[0]:b.h)>>>0).toString(k);if(b=N,x(b))return O+V;for(;6>O.length;)O="0"+O;V=O+V}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function x(k){if(k.h!=0)return!1;for(var P=0;P<k.g.length;P++)if(k.g[P]!=0)return!1;return!0}function R(k){return k.h==-1}n.l=function(k){return k=A(this,k),R(k)?-1:x(k)?0:1};function z(k){for(var P=k.g.length,b=[],V=0;V<P;V++)b[V]=~k.g[V];return new a(b,~k.h).add(w)}n.abs=function(){return R(this)?z(this):this},n.add=function(k){for(var P=Math.max(this.g.length,k.g.length),b=[],V=0,N=0;N<=P;N++){var O=V+(this.i(N)&65535)+(k.i(N)&65535),D=(O>>>16)+(this.i(N)>>>16)+(k.i(N)>>>16);V=D>>>16,O&=65535,D&=65535,b[N]=D<<16|O}return new a(b,b[b.length-1]&-2147483648?-1:0)};function A(k,P){return k.add(z(P))}n.j=function(k){if(x(this)||x(k))return g;if(R(this))return R(k)?z(this).j(z(k)):z(z(this).j(k));if(R(k))return z(this.j(z(k)));if(0>this.l(E)&&0>k.l(E))return f(this.m()*k.m());for(var P=this.g.length+k.g.length,b=[],V=0;V<2*P;V++)b[V]=0;for(V=0;V<this.g.length;V++)for(var N=0;N<k.g.length;N++){var O=this.i(V)>>>16,D=this.i(V)&65535,Ft=k.i(N)>>>16,An=k.i(N)&65535;b[2*V+2*N]+=D*An,S(b,2*V+2*N),b[2*V+2*N+1]+=O*An,S(b,2*V+2*N+1),b[2*V+2*N+1]+=D*Ft,S(b,2*V+2*N+1),b[2*V+2*N+2]+=O*Ft,S(b,2*V+2*N+2)}for(V=0;V<P;V++)b[V]=b[2*V+1]<<16|b[2*V];for(V=P;V<2*P;V++)b[V]=0;return new a(b,0)};function S(k,P){for(;(k[P]&65535)!=k[P];)k[P+1]+=k[P]>>>16,k[P]&=65535,P++}function C(k,P){this.g=k,this.h=P}function j(k,P){if(x(P))throw Error("division by zero");if(x(k))return new C(g,g);if(R(k))return P=j(z(k),P),new C(z(P.g),z(P.h));if(R(P))return P=j(k,z(P)),new C(z(P.g),P.h);if(30<k.g.length){if(R(k)||R(P))throw Error("slowDivide_ only works with positive integers.");for(var b=w,V=P;0>=V.l(k);)b=H(b),V=H(V);var N=Y(b,1),O=Y(V,1);for(V=Y(V,2),b=Y(b,2);!x(V);){var D=O.add(V);0>=D.l(k)&&(N=N.add(b),O=D),V=Y(V,1),b=Y(b,1)}return P=A(k,N.j(P)),new C(N,P)}for(N=g;0<=k.l(P);){for(b=Math.max(1,Math.floor(k.m()/P.m())),V=Math.ceil(Math.log(b)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),O=f(b),D=O.j(P);R(D)||0<D.l(k);)b-=V,O=f(b),D=O.j(P);x(O)&&(O=w),N=N.add(O),k=A(k,D)}return new C(N,k)}n.A=function(k){return j(this,k).h},n.and=function(k){for(var P=Math.max(this.g.length,k.g.length),b=[],V=0;V<P;V++)b[V]=this.i(V)&k.i(V);return new a(b,this.h&k.h)},n.or=function(k){for(var P=Math.max(this.g.length,k.g.length),b=[],V=0;V<P;V++)b[V]=this.i(V)|k.i(V);return new a(b,this.h|k.h)},n.xor=function(k){for(var P=Math.max(this.g.length,k.g.length),b=[],V=0;V<P;V++)b[V]=this.i(V)^k.i(V);return new a(b,this.h^k.h)};function H(k){for(var P=k.g.length+1,b=[],V=0;V<P;V++)b[V]=k.i(V)<<1|k.i(V-1)>>>31;return new a(b,k.h)}function Y(k,P){var b=P>>5;P%=32;for(var V=k.g.length-b,N=[],O=0;O<V;O++)N[O]=0<P?k.i(O+b)>>>P|k.i(O+b+1)<<32-P:k.i(O+b);return new a(N,k.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,nT=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=_,Rs=a}).apply(typeof rv<"u"?rv:typeof self<"u"?self:typeof window<"u"?window:{});var th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var iT,Nu,rT,yh,$p,sT,oT,aT;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,m,v){return c==Array.prototype||c==Object.prototype||(c[m]=v.value),c};function e(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof th=="object"&&th];for(var m=0;m<c.length;++m){var v=c[m];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var i=e(this);function r(c,m){if(m)t:{var v=i;c=c.split(".");for(var I=0;I<c.length-1;I++){var F=c[I];if(!(F in v))break t;v=v[F]}c=c[c.length-1],I=v[c],m=m(I),m!=I&&m!=null&&t(v,c,{configurable:!0,writable:!0,value:m})}}function s(c,m){c instanceof String&&(c+="");var v=0,I=!1,F={next:function(){if(!I&&v<c.length){var q=v++;return{value:m(q,c[q]),done:!1}}return I=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}r("Array.prototype.values",function(c){return c||function(){return s(this,function(m,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function h(c){var m=typeof c;return m=m!="object"?m:c?Array.isArray(c)?"array":m:"null",m=="array"||m=="object"&&typeof c.length=="number"}function f(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function _(c,m,v){return c.call.apply(c.bind,arguments)}function g(c,m,v){if(!c)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var F=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(F,I),c.apply(m,F)}}return function(){return c.apply(m,arguments)}}function w(c,m,v){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:g,w.apply(null,arguments)}function E(c,m){var v=Array.prototype.slice.call(arguments,1);return function(){var I=v.slice();return I.push.apply(I,arguments),c.apply(this,I)}}function x(c,m){function v(){}v.prototype=m.prototype,c.aa=m.prototype,c.prototype=new v,c.prototype.constructor=c,c.Qb=function(I,F,q){for(var tt=Array(arguments.length-2),Dt=2;Dt<arguments.length;Dt++)tt[Dt-2]=arguments[Dt];return m.prototype[F].apply(I,tt)}}function R(c){const m=c.length;if(0<m){const v=Array(m);for(let I=0;I<m;I++)v[I]=c[I];return v}return[]}function z(c,m){for(let v=1;v<arguments.length;v++){const I=arguments[v];if(h(I)){const F=c.length||0,q=I.length||0;c.length=F+q;for(let tt=0;tt<q;tt++)c[F+tt]=I[tt]}else c.push(I)}}class A{constructor(m,v){this.i=m,this.j=v,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function S(c){return/^[\s\xa0]*$/.test(c)}function C(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function j(c){return j[" "](c),c}j[" "]=function(){};var H=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function Y(c,m,v){for(const I in c)m.call(v,c[I],I,c)}function k(c,m){for(const v in c)m.call(void 0,c[v],v,c)}function P(c){const m={};for(const v in c)m[v]=c[v];return m}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(c,m){let v,I;for(let F=1;F<arguments.length;F++){I=arguments[F];for(v in I)c[v]=I[v];for(let q=0;q<b.length;q++)v=b[q],Object.prototype.hasOwnProperty.call(I,v)&&(c[v]=I[v])}}function N(c){var m=1;c=c.split(":");const v=[];for(;0<m&&c.length;)v.push(c.shift()),m--;return c.length&&v.push(c.join(":")),v}function O(c){l.setTimeout(()=>{throw c},0)}function D(){var c=lt;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class Ft{constructor(){this.h=this.g=null}add(m,v){const I=An.get();I.set(m,v),this.h?this.h.next=I:this.g=I,this.h=I}}var An=new A(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(m,v){this.h=m,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Se,W=!1,lt=new Ft,J=()=>{const c=l.Promise.resolve(void 0);Se=()=>{c.then(ct)}};var ct=()=>{for(var c;c=D();){try{c.h.call(c.g)}catch(v){O(v)}var m=An;m.j(c),100>m.h&&(m.h++,c.next=m.g,m.g=c)}W=!1};function dt(){this.s=this.s,this.C=this.C}dt.prototype.s=!1,dt.prototype.ma=function(){this.s||(this.s=!0,this.N())},dt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function vt(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}vt.prototype.h=function(){this.defaultPrevented=!0};var bt=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};l.addEventListener("test",v,m),l.removeEventListener("test",v,m)}catch{}return c}();function wt(c,m){if(vt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var v=this.type=c.type,I=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget){if(H){t:{try{j(m.nodeName);var F=!0;break t}catch{}F=!1}F||(m=null)}}else v=="mouseover"?m=c.fromElement:v=="mouseout"&&(m=c.toElement);this.relatedTarget=m,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:pt[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&wt.aa.h.call(this)}}x(wt,vt);var pt={2:"touch",3:"pen",4:"mouse"};wt.prototype.h=function(){wt.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Jn=0;function ec(c,m,v,I,F){this.listener=c,this.proxy=null,this.src=m,this.type=v,this.capture=!!I,this.ha=F,this.key=++Jn,this.da=this.fa=!1}function Ji(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function tr(c){this.src=c,this.g={},this.h=0}tr.prototype.add=function(c,m,v,I,F){var q=c.toString();c=this.g[q],c||(c=this.g[q]=[],this.h++);var tt=ts(c,m,I,F);return-1<tt?(m=c[tt],v||(m.fa=!1)):(m=new ec(m,this.src,q,!!I,F),m.fa=v,c.push(m)),m};function yi(c,m){var v=m.type;if(v in c.g){var I=c.g[v],F=Array.prototype.indexOf.call(I,m,void 0),q;(q=0<=F)&&Array.prototype.splice.call(I,F,1),q&&(Ji(m),c.g[v].length==0&&(delete c.g[v],c.h--))}}function ts(c,m,v,I){for(var F=0;F<c.length;++F){var q=c[F];if(!q.da&&q.listener==m&&q.capture==!!v&&q.ha==I)return F}return-1}var ba="closure_lm_"+(1e6*Math.random()|0),Js={};function Da(c,m,v,I,F){if(I&&I.once)return nc(c,m,v,I,F);if(Array.isArray(m)){for(var q=0;q<m.length;q++)Da(c,m[q],v,I,F);return null}return v=ns(v),c&&c[de]?c.K(m,v,f(I)?!!I.capture:!!I,F):to(c,m,v,!1,I,F)}function to(c,m,v,I,F,q){if(!m)throw Error("Invalid event type");var tt=f(F)?!!F.capture:!!F,Dt=Na(c);if(Dt||(c[ba]=Dt=new tr(c)),v=Dt.add(m,v,I,tt,q),v.proxy)return v;if(I=eo(),v.proxy=I,I.src=c,I.listener=v,c.addEventListener)bt||(F=tt),F===void 0&&(F=!1),c.addEventListener(m.toString(),I,F);else if(c.attachEvent)c.attachEvent(Ma(m.toString()),I);else if(c.addListener&&c.removeListener)c.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return v}function eo(){function c(v){return m.call(c.src,c.listener,v)}const m=ic;return c}function nc(c,m,v,I,F){if(Array.isArray(m)){for(var q=0;q<m.length;q++)nc(c,m[q],v,I,F);return null}return v=ns(v),c&&c[de]?c.L(m,v,f(I)?!!I.capture:!!I,F):to(c,m,v,!0,I,F)}function Va(c,m,v,I,F){if(Array.isArray(m))for(var q=0;q<m.length;q++)Va(c,m[q],v,I,F);else I=f(I)?!!I.capture:!!I,v=ns(v),c&&c[de]?(c=c.i,m=String(m).toString(),m in c.g&&(q=c.g[m],v=ts(q,v,I,F),-1<v&&(Ji(q[v]),Array.prototype.splice.call(q,v,1),q.length==0&&(delete c.g[m],c.h--)))):c&&(c=Na(c))&&(m=c.g[m.toString()],c=-1,m&&(c=ts(m,v,I,F)),(v=-1<c?m[c]:null)&&es(v))}function es(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[de])yi(m.i,c);else{var v=c.type,I=c.proxy;m.removeEventListener?m.removeEventListener(v,I,c.capture):m.detachEvent?m.detachEvent(Ma(v),I):m.addListener&&m.removeListener&&m.removeListener(I),(v=Na(m))?(yi(v,c),v.h==0&&(v.src=null,m[ba]=null)):Ji(c)}}}function Ma(c){return c in Js?Js[c]:Js[c]="on"+c}function ic(c,m){if(c.da)c=!0;else{m=new wt(m,this);var v=c.listener,I=c.ha||c.src;c.fa&&es(c),c=v.call(I,m)}return c}function Na(c){return c=c[ba],c instanceof tr?c:null}var Oa="__closure_events_fn_"+(1e9*Math.random()>>>0);function ns(c){return typeof c=="function"?c:(c[Oa]||(c[Oa]=function(m){return c.handleEvent(m)}),c[Oa])}function ve(){dt.call(this),this.i=new tr(this),this.M=this,this.F=null}x(ve,dt),ve.prototype[de]=!0,ve.prototype.removeEventListener=function(c,m,v,I){Va(this,c,m,v,I)};function Ae(c,m){var v,I=c.F;if(I)for(v=[];I;I=I.F)v.push(I);if(c=c.M,I=m.type||m,typeof m=="string")m=new vt(m,c);else if(m instanceof vt)m.target=m.target||c;else{var F=m;m=new vt(I,c),V(m,F)}if(F=!0,v)for(var q=v.length-1;0<=q;q--){var tt=m.g=v[q];F=no(tt,I,!0,m)&&F}if(tt=m.g=c,F=no(tt,I,!0,m)&&F,F=no(tt,I,!1,m)&&F,v)for(q=0;q<v.length;q++)tt=m.g=v[q],F=no(tt,I,!1,m)&&F}ve.prototype.N=function(){if(ve.aa.N.call(this),this.i){var c=this.i,m;for(m in c.g){for(var v=c.g[m],I=0;I<v.length;I++)Ji(v[I]);delete c.g[m],c.h--}}this.F=null},ve.prototype.K=function(c,m,v,I){return this.i.add(String(c),m,!1,v,I)},ve.prototype.L=function(c,m,v,I){return this.i.add(String(c),m,!0,v,I)};function no(c,m,v,I){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();for(var F=!0,q=0;q<m.length;++q){var tt=m[q];if(tt&&!tt.da&&tt.capture==v){var Dt=tt.listener,Ee=tt.ha||tt.src;tt.fa&&yi(c.i,tt),F=Dt.call(Ee,I)!==!1&&F}}return F&&!I.defaultPrevented}function Fa(c,m,v){if(typeof c=="function")v&&(c=w(c,v));else if(c&&typeof c.handleEvent=="function")c=w(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:l.setTimeout(c,m||0)}function Ba(c){c.g=Fa(()=>{c.g=null,c.i&&(c.i=!1,Ba(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class Jd extends dt{constructor(m,v){super(),this.m=m,this.l=v,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Ba(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function er(c){dt.call(this),this.h=c,this.g={}}x(er,dt);var io=[];function za(c){Y(c.g,function(m,v){this.g.hasOwnProperty(v)&&es(m)},c),c.g={}}er.prototype.N=function(){er.aa.N.call(this),za(this)},er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ua=l.JSON.stringify,is=l.JSON.parse,tf=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function ja(){}ja.prototype.h=null;function $a(c){return c.h||(c.h=c.i())}function qa(){}var nr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ga(){vt.call(this,"d")}x(Ga,vt);function Wa(){vt.call(this,"c")}x(Wa,vt);var vi={},rc=null;function ro(){return rc=rc||new ve}vi.La="serverreachability";function sc(c){vt.call(this,vi.La,c)}x(sc,vt);function wi(c){const m=ro();Ae(m,new sc(m))}vi.STAT_EVENT="statevent";function oc(c,m){vt.call(this,vi.STAT_EVENT,c),this.stat=m}x(oc,vt);function De(c){const m=ro();Ae(m,new oc(m,c))}vi.Ma="timingevent";function ac(c,m){vt.call(this,vi.Ma,c),this.size=m}x(ac,vt);function rs(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},m)}function Ue(){this.g=!0}Ue.prototype.xa=function(){this.g=!1};function at(c,m,v,I,F,q){c.info(function(){if(c.g)if(q)for(var tt="",Dt=q.split("&"),Ee=0;Ee<Dt.length;Ee++){var mt=Dt[Ee].split("=");if(1<mt.length){var Jt=mt[0];mt=mt[1];var xe=Jt.split("_");tt=2<=xe.length&&xe[1]=="type"?tt+(Jt+"="+mt+"&"):tt+(Jt+"=redacted&")}}else tt=null;else tt=q;return"XMLHTTP REQ ("+I+") [attempt "+F+"]: "+m+`
`+v+`
`+tt})}function uc(c,m,v,I,F,q,tt){c.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+F+"]: "+m+`
`+v+`
`+q+" "+tt})}function Ei(c,m,v,I){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+cc(c,v)+(I?" "+I:"")})}function lc(c,m){c.info(function(){return"TIMEOUT: "+m})}Ue.prototype.info=function(){};function cc(c,m){if(!c.g)return m;if(!m)return null;try{var v=JSON.parse(m);if(v){for(c=0;c<v.length;c++)if(Array.isArray(v[c])){var I=v[c];if(!(2>I.length)){var F=I[1];if(Array.isArray(F)&&!(1>F.length)){var q=F[0];if(q!="noop"&&q!="stop"&&q!="close")for(var tt=1;tt<F.length;tt++)F[tt]=""}}}}return Ua(v)}catch{return m}}var ir={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ha={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ti;function ss(){}x(ss,ja),ss.prototype.g=function(){return new XMLHttpRequest},ss.prototype.i=function(){return{}},ti=new ss;function ei(c,m,v,I){this.j=c,this.i=m,this.l=v,this.R=I||1,this.U=new er(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hc}function hc(){this.i=null,this.g="",this.h=!1}var dc={},Ka={};function so(c,m,v){c.L=1,c.v=ni(Un(m)),c.m=v,c.P=!0,fc(c,null)}function fc(c,m){c.F=Date.now(),oo(c),c.A=Un(c.v);var v=c.A,I=c.R;Array.isArray(I)||(I=[String(I)]),ft(v.i,"t",I),c.C=0,v=c.j.J,c.h=new hc,c.g=du(c.j,v?m:null,!c.m),0<c.O&&(c.M=new Jd(w(c.Y,c,c.g),c.O)),m=c.U,v=c.g,I=c.ca;var F="readystatechange";Array.isArray(F)||(F&&(io[0]=F.toString()),F=io);for(var q=0;q<F.length;q++){var tt=Da(v,F[q],I||m.handleEvent,!1,m.h||m);if(!tt)break;m.g[tt.key]=tt}m=c.H?P(c.H):{},c.m?(c.u||(c.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,m)):(c.u="GET",c.g.ea(c.A,c.u,null,m)),wi(),at(c.i,c.u,c.A,c.l,c.R,c.m)}ei.prototype.ca=function(c){c=c.target;const m=this.M;m&&Rn(c)==3?m.j():this.Y(c)},ei.prototype.Y=function(c){try{if(c==this.g)t:{const xe=Rn(this.g);var m=this.g.Ba();const $e=this.g.Z();if(!(3>xe)&&(xe!=3||this.g&&(this.h.h||this.g.oa()||vc(this.g)))){this.J||xe!=4||m==7||(m==8||0>=$e?wi(3):wi(2)),Za(this);var v=this.g.Z();this.X=v;e:if(os(this)){var I=vc(this.g);c="";var F=I.length,q=Rn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zn(this),as(this);var tt="";break e}this.h.i=new l.TextDecoder}for(m=0;m<F;m++)this.h.h=!0,c+=this.h.i.decode(I[m],{stream:!(q&&m==F-1)});I.length=0,this.h.g+=c,this.C=0,tt=this.h.g}else tt=this.g.oa();if(this.o=v==200,uc(this.i,this.u,this.A,this.l,this.R,xe,v),this.o){if(this.T&&!this.K){e:{if(this.g){var Dt,Ee=this.g;if((Dt=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Dt)){var mt=Dt;break e}}mt=null}if(v=mt)Ei(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ti(this,v);else{this.o=!1,this.s=3,De(12),zn(this),as(this);break t}}if(this.P){v=!0;let yn;for(;!this.J&&this.C<tt.length;)if(yn=ef(this,tt),yn==Ka){xe==4&&(this.s=4,De(14),v=!1),Ei(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==dc){this.s=4,De(15),Ei(this.i,this.l,tt,"[Invalid Chunk]"),v=!1;break}else Ei(this.i,this.l,yn,null),Ti(this,yn);if(os(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xe!=4||tt.length!=0||this.h.h||(this.s=1,De(16),v=!1),this.o=this.o&&v,!v)Ei(this.i,this.l,tt,"[Invalid Chunked Response]"),zn(this),as(this);else if(0<tt.length&&!this.W){this.W=!0;var Jt=this.j;Jt.g==this&&Jt.ba&&!Jt.M&&(Jt.j.info("Great, no buffering proxy detected. Bytes received: "+tt.length),cs(Jt),Jt.M=!0,De(11))}}else Ei(this.i,this.l,tt,null),Ti(this,tt);xe==4&&zn(this),this.o&&!this.J&&(xe==4?hu(this.j,this):(this.o=!1,oo(this)))}else au(this.g),v==400&&0<tt.indexOf("Unknown SID")?(this.s=3,De(12)):(this.s=0,De(13)),zn(this),as(this)}}}catch{}finally{}};function os(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function ef(c,m){var v=c.C,I=m.indexOf(`
`,v);return I==-1?Ka:(v=Number(m.substring(v,I)),isNaN(v)?dc:(I+=1,I+v>m.length?Ka:(m=m.slice(I,I+v),c.C=I+v,m)))}ei.prototype.cancel=function(){this.J=!0,zn(this)};function oo(c){c.S=Date.now()+c.I,pc(c,c.I)}function pc(c,m){if(c.B!=null)throw Error("WatchDog timer not null");c.B=rs(w(c.ba,c),m)}function Za(c){c.B&&(l.clearTimeout(c.B),c.B=null)}ei.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(lc(this.i,this.A),this.L!=2&&(wi(),De(17)),zn(this),this.s=2,as(this)):pc(this,this.S-c)};function as(c){c.j.G==0||c.J||hu(c.j,c)}function zn(c){Za(c);var m=c.M;m&&typeof m.ma=="function"&&m.ma(),c.M=null,za(c.U),c.g&&(m=c.g,c.g=null,m.abort(),m.ma())}function Ti(c,m){try{var v=c.j;if(v.G!=0&&(v.g==c||Bt(v.h,c))){if(!c.K&&Bt(v.h,c)&&v.G==3){try{var I=v.Da.g.parse(m)}catch{I=null}if(Array.isArray(I)&&I.length==3){var F=I;if(F[0]==0){t:if(!v.u){if(v.g)if(v.g.F+3e3<c.F)hs(v),fo(v);else break t;_o(v),De(18)}}else v.za=F[1],0<v.za-v.T&&37500>F[2]&&v.F&&v.v==0&&!v.C&&(v.C=rs(w(v.Za,v),6e3));if(1>=At(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else Ci(v,11)}else if((c.K||v.g==c)&&hs(v),!S(m))for(F=v.Da.g.parse(m),m=0;m<F.length;m++){let mt=F[m];if(v.T=mt[0],mt=mt[1],v.G==2)if(mt[0]=="c"){v.K=mt[1],v.ia=mt[2];const Jt=mt[3];Jt!=null&&(v.la=Jt,v.j.info("VER="+v.la));const xe=mt[4];xe!=null&&(v.Aa=xe,v.j.info("SVER="+v.Aa));const $e=mt[5];$e!=null&&typeof $e=="number"&&0<$e&&(I=1.5*$e,v.L=I,v.j.info("backChannelRequestTimeoutMs_="+I)),I=v;const yn=c.g;if(yn){const Gn=yn.g?yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gn){var q=I.h;q.g||Gn.indexOf("spdy")==-1&&Gn.indexOf("quic")==-1&&Gn.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(sr(q,q.h),q.h=null))}if(I.D){const pu=yn.g?yn.g.getResponseHeader("X-HTTP-Session-Id"):null;pu&&(I.ya=pu,Rt(I.I,I.D,pu))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-c.F,v.j.info("Handshake RTT: "+v.R+"ms")),I=v;var tt=c;if(I.qa=Ic(I,I.J?I.ia:null,I.W),tt.K){Ii(I.h,tt);var Dt=tt,Ee=I.L;Ee&&(Dt.I=Ee),Dt.B&&(Za(Dt),oo(Dt)),I.g=tt}else cu(I);0<v.i.length&&mo(v)}else mt[0]!="stop"&&mt[0]!="close"||Ci(v,7);else v.G==3&&(mt[0]=="stop"||mt[0]=="close"?mt[0]=="stop"?Ci(v,7):lu(v):mt[0]!="noop"&&v.l&&v.l.ta(mt),v.v=0)}}wi(4)}catch{}}var mc=class{constructor(c,m){this.g=c,this.map=m}};function Qa(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function rr(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function At(c){return c.h?1:c.g?c.g.size:0}function Bt(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function sr(c,m){c.g?c.g.add(m):c.h=m}function Ii(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}Qa.prototype.cancel=function(){if(this.i=Pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Pi(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const v of c.g.values())m=m.concat(v.D);return m}return R(c.i)}function Ya(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(h(c)){for(var m=[],v=c.length,I=0;I<v;I++)m.push(c[I]);return m}m=[],v=0;for(I in c)m[v++]=c[I];return m}function gt(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(h(c)||typeof c=="string"){var m=[];c=c.length;for(var v=0;v<c;v++)m.push(v);return m}m=[],v=0;for(const I in c)m[v++]=I;return m}}}function Wt(c,m){if(c.forEach&&typeof c.forEach=="function")c.forEach(m,void 0);else if(h(c)||typeof c=="string")Array.prototype.forEach.call(c,m,void 0);else for(var v=gt(c),I=Ya(c),F=I.length,q=0;q<F;q++)m.call(void 0,I[q],v&&v[q],c)}var ao=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uo(c,m){if(c){c=c.split("&");for(var v=0;v<c.length;v++){var I=c[v].indexOf("="),F=null;if(0<=I){var q=c[v].substring(0,I);F=c[v].substring(I+1)}else q=c[v];m(q,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function fe(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof fe){this.h=c.h,Si(this,c.j),this.o=c.o,this.g=c.g,xn(this,c.s),this.l=c.l;var m=c.i,v=new ii;v.i=m.i,m.g&&(v.g=new Map(m.g),v.h=m.h),Xt(this,v),this.m=c.m}else c&&(m=String(c).match(ao))?(this.h=!1,Si(this,m[1]||"",!0),this.o=jn(m[2]||""),this.g=jn(m[3]||"",!0),xn(this,m[4]),this.l=jn(m[5]||"",!0),Xt(this,m[6]||"",!0),this.m=jn(m[7]||"")):(this.h=!1,this.i=new ii(null,this.h))}fe.prototype.toString=function(){var c=[],m=this.j;m&&c.push(Ai(m,lo,!0),":");var v=this.g;return(v||m=="file")&&(c.push("//"),(m=this.o)&&c.push(Ai(m,lo,!0),"@"),c.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&c.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(Ai(v,v.charAt(0)=="/"?co:Xa,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",Ai(v,tu)),c.join("")};function Un(c){return new fe(c)}function Si(c,m,v){c.j=v?jn(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function xn(c,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);c.s=m}else c.s=null}function Xt(c,m,v){m instanceof ii?(c.i=m,Nt(c.i,c.h)):(v||(m=Ai(m,Ja)),c.i=new ii(m,c.h))}function Rt(c,m,v){c.i.set(m,v)}function ni(c){return Rt(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function jn(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ai(c,m,v){return typeof c=="string"?(c=encodeURI(c).replace(m,us),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function us(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var lo=/[#\/\?@]/g,Xa=/[#\?:]/g,co=/[#\?]/g,Ja=/[#\?@]/g,tu=/#/g;function ii(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function $n(c){c.g||(c.g=new Map,c.h=0,c.i&&uo(c.i,function(m,v){c.add(decodeURIComponent(m.replace(/\+/g," ")),v)}))}n=ii.prototype,n.add=function(c,m){$n(this),this.i=null,c=Ve(this,c);var v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(m),this.h+=1,this};function ho(c,m){$n(c),m=Ve(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function _c(c,m){return $n(c),m=Ve(c,m),c.g.has(m)}n.forEach=function(c,m){$n(this),this.g.forEach(function(v,I){v.forEach(function(F){c.call(m,F,I,this)},this)},this)},n.na=function(){$n(this);const c=Array.from(this.g.values()),m=Array.from(this.g.keys()),v=[];for(let I=0;I<m.length;I++){const F=c[I];for(let q=0;q<F.length;q++)v.push(m[I])}return v},n.V=function(c){$n(this);let m=[];if(typeof c=="string")_c(this,c)&&(m=m.concat(this.g.get(Ve(this,c))));else{c=Array.from(this.g.values());for(let v=0;v<c.length;v++)m=m.concat(c[v])}return m},n.set=function(c,m){return $n(this),this.i=null,c=Ve(this,c),_c(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},n.get=function(c,m){return c?(c=this.V(c),0<c.length?String(c[0]):m):m};function ft(c,m,v){ho(c,m),0<v.length&&(c.i=null,c.g.set(Ve(c,m),R(v)),c.h+=v.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(var v=0;v<m.length;v++){var I=m[v];const q=encodeURIComponent(String(I)),tt=this.V(I);for(I=0;I<tt.length;I++){var F=q;tt[I]!==""&&(F+="="+encodeURIComponent(String(tt[I]))),c.push(F)}}return this.i=c.join("&")};function Ve(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function Nt(c,m){m&&!c.j&&($n(c),c.i=null,c.g.forEach(function(v,I){var F=I.toLowerCase();I!=F&&(ho(this,I),ft(this,F,v))},c)),c.j=m}function gc(c,m){const v=new Ue;if(l.Image){const I=new Image;I.onload=E(Cn,v,"TestLoadImage: loaded",!0,m,I),I.onerror=E(Cn,v,"TestLoadImage: error",!1,m,I),I.onabort=E(Cn,v,"TestLoadImage: abort",!1,m,I),I.ontimeout=E(Cn,v,"TestLoadImage: timeout",!1,m,I),l.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=c}else m(!1)}function eu(c,m){const v=new Ue,I=new AbortController,F=setTimeout(()=>{I.abort(),Cn(v,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:I.signal}).then(q=>{clearTimeout(F),q.ok?Cn(v,"TestPingServer: ok",!0,m):Cn(v,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(F),Cn(v,"TestPingServer: error",!1,m)})}function Cn(c,m,v,I,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),I(v)}catch{}}function nu(){this.g=new tf}function xi(c,m,v){const I=v||"";try{Wt(c,function(F,q){let tt=F;f(F)&&(tt=Ua(F)),m.push(I+q+"="+encodeURIComponent(tt))})}catch(F){throw m.push(I+"type="+encodeURIComponent("_badmap")),F}}function or(c){this.l=c.Ub||null,this.j=c.eb||!1}x(or,ja),or.prototype.g=function(){return new ri(this.l,this.j)},or.prototype.i=function(c){return function(){return c}}({});function ri(c,m){ve.call(this),this.D=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(ri,ve),n=ri.prototype,n.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=m,this.readyState=1,ar(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(m.body=c),(this.D||l).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gn(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ar(this)),this.g&&(this.readyState=3,ar(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pe(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function pe(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?gn(this):ar(this),this.readyState==3&&pe(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,gn(this))},n.Qa=function(c){this.g&&(this.response=c,gn(this))},n.ga=function(){this.g&&gn(this)};function gn(c){c.readyState=4,c.l=null,c.j=null,c.v=null,ar(c)}n.setRequestHeader=function(c,m){this.u.append(c,m)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var v=m.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=m.next();return c.join(`\r
`)};function ar(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ri.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function iu(c){let m="";return Y(c,function(v,I){m+=I,m+=":",m+=v,m+=`\r
`}),m}function ru(c,m,v){t:{for(I in v){var I=!1;break t}I=!0}I||(v=iu(v),typeof c=="string"?v!=null&&encodeURIComponent(String(v)):Rt(c,m,v))}function jt(c){ve.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(jt,ve);var su=/^https?$/i,nf=["POST","PUT"];n=jt.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,m,v,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ti.g(),this.v=this.o?$a(this.o):$a(ti),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(q){ou(this,q);return}if(c=v||"",v=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var F in I)v.set(F,I[F]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const q of I.keys())v.set(q,I.get(q));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(v.keys()).find(q=>q.toLowerCase()=="content-type"),F=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(nf,m,void 0))||I||F||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,tt]of v)this.g.setRequestHeader(q,tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ur(this),this.u=!0,this.g.send(c),this.u=!1}catch(q){ou(this,q)}};function ou(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.m=5,Tt(c),je(c)}function Tt(c){c.A||(c.A=!0,Ae(c,"complete"),Ae(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Ae(this,"complete"),Ae(this,"abort"),je(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),je(this,!0)),jt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?yc(this):this.bb())},n.bb=function(){yc(this)};function yc(c){if(c.h&&typeof a<"u"&&(!c.v[1]||Rn(c)!=4||c.Z()!=2)){if(c.u&&Rn(c)==4)Fa(c.Ea,0,c);else if(Ae(c,"readystatechange"),Rn(c)==4){c.h=!1;try{const tt=c.Z();t:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break t;default:m=!1}var v;if(!(v=m)){var I;if(I=tt===0){var F=String(c.D).match(ao)[1]||null;!F&&l.self&&l.self.location&&(F=l.self.location.protocol.slice(0,-1)),I=!su.test(F?F.toLowerCase():"")}v=I}if(v)Ae(c,"complete"),Ae(c,"success");else{c.m=6;try{var q=2<Rn(c)?c.g.statusText:""}catch{q=""}c.l=q+" ["+c.Z()+"]",Tt(c)}}finally{je(c)}}}}function je(c,m){if(c.g){ur(c);const v=c.g,I=c.v[0]?()=>{}:null;c.g=null,c.v=null,m||Ae(c,"ready");try{v.onreadystatechange=I}catch{}}}function ur(c){c.I&&(l.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Rn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Rn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),is(m)}};function vc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function au(c){const m={};c=(c.g&&2<=Rn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<c.length;I++){if(S(c[I]))continue;var v=N(c[I]);const F=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const q=m[F]||[];m[F]=q,q.push(v)}k(m,function(I){return I.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ls(c,m,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||m}function uu(c){this.Aa=0,this.i=[],this.j=new Ue,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ls("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ls("baseRetryDelayMs",5e3,c),this.cb=ls("retryDelaySeedMs",1e4,c),this.Wa=ls("forwardChannelMaxRetries",2,c),this.wa=ls("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Qa(c&&c.concurrentRequestLimit),this.Da=new nu,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=uu.prototype,n.la=8,n.G=1,n.connect=function(c,m,v,I){De(0),this.W=c,this.H=m||{},v&&I!==void 0&&(this.H.OSID=v,this.H.OAID=I),this.F=this.X,this.I=Ic(this,null,this.W),mo(this)};function lu(c){if(po(c),c.G==3){var m=c.U++,v=Un(c.I);if(Rt(v,"SID",c.K),Rt(v,"RID",m),Rt(v,"TYPE","terminate"),lr(c,v),m=new ei(c,c.j,m),m.L=2,m.v=ni(Un(v)),v=!1,l.navigator&&l.navigator.sendBeacon)try{v=l.navigator.sendBeacon(m.v.toString(),"")}catch{}!v&&l.Image&&(new Image().src=m.v,v=!0),v||(m.g=du(m.j,null),m.g.ea(m.v)),m.F=Date.now(),oo(m)}go(c)}function fo(c){c.g&&(cs(c),c.g.cancel(),c.g=null)}function po(c){fo(c),c.u&&(l.clearTimeout(c.u),c.u=null),hs(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function mo(c){if(!rr(c.h)&&!c.s){c.s=!0;var m=c.Ga;Se||J(),W||(Se(),W=!0),lt.add(m,c),c.B=0}}function Ln(c,m){return At(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=m.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=rs(w(c.Ga,c,m),Tc(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const F=new ei(this,this.j,c);let q=this.o;if(this.S&&(q?(q=P(q),V(q,this.S)):q=this.S),this.m!==null||this.O||(F.H=q,q=null),this.P)t:{for(var m=0,v=0;v<this.i.length;v++){e:{var I=this.i[v];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break e}I=void 0}if(I===void 0)break;if(m+=I,4096<m){m=v;break t}if(m===4096||v===this.i.length-1){m=v+1;break t}}m=1e3}else m=1e3;m=qn(this,F,m),v=Un(this.I),Rt(v,"RID",c),Rt(v,"CVER",22),this.D&&Rt(v,"X-HTTP-Session-Id",this.D),lr(this,v),q&&(this.O?m="headers="+encodeURIComponent(String(iu(q)))+"&"+m:this.m&&ru(v,this.m,q)),sr(this.h,F),this.Ua&&Rt(v,"TYPE","init"),this.P?(Rt(v,"$req",m),Rt(v,"SID","null"),F.T=!0,so(F,v,null)):so(F,v,m),this.G=2}}else this.G==3&&(c?wc(this,c):this.i.length==0||rr(this.h)||wc(this))};function wc(c,m){var v;m?v=m.l:v=c.U++;const I=Un(c.I);Rt(I,"SID",c.K),Rt(I,"RID",v),Rt(I,"AID",c.T),lr(c,I),c.m&&c.o&&ru(I,c.m,c.o),v=new ei(c,c.j,v,c.B+1),c.m===null&&(v.H=c.o),m&&(c.i=m.D.concat(c.i)),m=qn(c,v,1e3),v.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),sr(c.h,v),so(v,I,m)}function lr(c,m){c.H&&Y(c.H,function(v,I){Rt(m,I,v)}),c.l&&Wt({},function(v,I){Rt(m,I,v)})}function qn(c,m,v){v=Math.min(c.i.length,v);var I=c.l?w(c.l.Na,c.l,c):null;t:{var F=c.i;let q=-1;for(;;){const tt=["count="+v];q==-1?0<v?(q=F[0].g,tt.push("ofs="+q)):q=0:tt.push("ofs="+q);let Dt=!0;for(let Ee=0;Ee<v;Ee++){let mt=F[Ee].g;const Jt=F[Ee].map;if(mt-=q,0>mt)q=Math.max(0,F[Ee].g-100),Dt=!1;else try{xi(Jt,tt,"req"+mt+"_")}catch{I&&I(Jt)}}if(Dt){I=tt.join("&");break t}}}return c=c.i.splice(0,v),m.D=c,I}function cu(c){if(!c.g&&!c.u){c.Y=1;var m=c.Fa;Se||J(),W||(Se(),W=!0),lt.add(m,c),c.v=0}}function _o(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=rs(w(c.Fa,c),Tc(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,Ec(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=rs(w(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,De(10),fo(this),Ec(this))};function cs(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function Ec(c){c.g=new ei(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var m=Un(c.qa);Rt(m,"RID","rpc"),Rt(m,"SID",c.K),Rt(m,"AID",c.T),Rt(m,"CI",c.F?"0":"1"),!c.F&&c.ja&&Rt(m,"TO",c.ja),Rt(m,"TYPE","xmlhttp"),lr(c,m),c.m&&c.o&&ru(m,c.m,c.o),c.L&&(c.g.I=c.L);var v=c.g;c=c.ia,v.L=1,v.v=ni(Un(m)),v.m=null,v.P=!0,fc(v,c)}n.Za=function(){this.C!=null&&(this.C=null,fo(this),_o(this),De(19))};function hs(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function hu(c,m){var v=null;if(c.g==m){hs(c),cs(c),c.g=null;var I=2}else if(Bt(c.h,m))v=m.D,Ii(c.h,m),I=1;else return;if(c.G!=0){if(m.o)if(I==1){v=m.m?m.m.length:0,m=Date.now()-m.F;var F=c.B;I=ro(),Ae(I,new ac(I,v)),mo(c)}else cu(c);else if(F=m.s,F==3||F==0&&0<m.X||!(I==1&&Ln(c,m)||I==2&&_o(c)))switch(v&&0<v.length&&(m=c.h,m.i=m.i.concat(v)),F){case 1:Ci(c,5);break;case 4:Ci(c,10);break;case 3:Ci(c,6);break;default:Ci(c,2)}}}function Tc(c,m){let v=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(v*=2),v*m}function Ci(c,m){if(c.j.info("Error code "+m),m==2){var v=w(c.fb,c),I=c.Xa;const F=!I;I=new fe(I||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Si(I,"https"),ni(I),F?gc(I.toString(),v):eu(I.toString(),v)}else De(2);c.G=0,c.l&&c.l.sa(m),go(c),po(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),De(2)):(this.j.info("Failed to ping google.com"),De(1))};function go(c){if(c.G=0,c.ka=[],c.l){const m=Pi(c.h);(m.length!=0||c.i.length!=0)&&(z(c.ka,m),z(c.ka,c.i),c.h.i.length=0,R(c.i),c.i.length=0),c.l.ra()}}function Ic(c,m,v){var I=v instanceof fe?Un(v):new fe(v);if(I.g!="")m&&(I.g=m+"."+I.g),xn(I,I.s);else{var F=l.location;I=F.protocol,m=m?m+"."+F.hostname:F.hostname,F=+F.port;var q=new fe(null);I&&Si(q,I),m&&(q.g=m),F&&xn(q,F),v&&(q.l=v),I=q}return v=c.D,m=c.ya,v&&m&&Rt(I,v,m),Rt(I,"VER",c.la),lr(c,I),I}function du(c,m,v){if(m&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Ca&&!c.pa?new jt(new or({eb:v})):new jt(c.pa),m.Ha(c.J),m}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function fu(){}n=fu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ri(){}Ri.prototype.g=function(c,m){return new ae(c,m)};function ae(c,m){ve.call(this),this.g=new uu(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(c?c["X-WebChannel-Client-Profile"]=m.va:c={"X-WebChannel-Client-Profile":m.va}),this.g.S=c,(c=m&&m.Sb)&&!S(c)&&(this.g.m=c),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!S(m)&&(this.g.D=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new we(this)}x(ae,ve),ae.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ae.prototype.close=function(){lu(this.g)},ae.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.u&&(v={},v.__data__=Ua(c),c=v);m.i.push(new mc(m.Ya++,c)),m.G==3&&mo(m)},ae.prototype.N=function(){this.g.l=null,delete this.j,lu(this.g),delete this.g,ae.aa.N.call(this)};function Pc(c){Ga.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){t:{for(const v in m){c=v;break t}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}x(Pc,Ga);function cr(){Wa.call(this),this.status=1}x(cr,Wa);function we(c){this.g=c}x(we,fu),we.prototype.ua=function(){Ae(this.g,"a")},we.prototype.ta=function(c){Ae(this.g,new Pc(c))},we.prototype.sa=function(c){Ae(this.g,new cr)},we.prototype.ra=function(){Ae(this.g,"b")},Ri.prototype.createWebChannel=Ri.prototype.g,ae.prototype.send=ae.prototype.o,ae.prototype.open=ae.prototype.m,ae.prototype.close=ae.prototype.close,aT=function(){return new Ri},oT=function(){return ro()},sT=vi,$p={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ir.NO_ERROR=0,ir.TIMEOUT=8,ir.HTTP_ERROR=6,yh=ir,Ha.COMPLETE="complete",rT=Ha,qa.EventType=nr,nr.OPEN="a",nr.CLOSE="b",nr.ERROR="c",nr.MESSAGE="d",ve.prototype.listen=ve.prototype.K,Nu=qa,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,iT=jt}).apply(typeof th<"u"?th:typeof self<"u"?self:typeof window<"u"?window:{});const sv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ke.UNAUTHENTICATED=new ke(null),ke.GOOGLE_CREDENTIALS=new ke("google-credentials-uid"),ke.FIRST_PARTY=new ke("first-party-uid"),ke.MOCK_USER=new ke("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pa="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=new u_("@firebase/firestore");function xo(){return Br.logLevel}function dC(n){Br.setLogLevel(n)}function Q(n,...t){if(Br.logLevel<=xt.DEBUG){const e=t.map(f_);Br.debug(`Firestore (${Pa}): ${n}`,...e)}}function le(n,...t){if(Br.logLevel<=xt.ERROR){const e=t.map(f_);Br.error(`Firestore (${Pa}): ${n}`,...e)}}function mi(n,...t){if(Br.logLevel<=xt.WARN){const e=t.map(f_);Br.warn(`Firestore (${Pa}): ${n}`,...e)}}function f_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(n="Unexpected state"){const t=`FIRESTORE (${Pa}) INTERNAL ASSERTION FAILED: `+n;throw le(t),new Error(t)}function ot(n,t){n||rt()}function fC(n,t){n||rt()}function nt(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends Hs{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class pC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(ke.UNAUTHENTICATED))}shutdown(){}}class mC{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class _C{constructor(t){this.t=t,this.currentUser=ke.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){ot(this.o===void 0);let i=this.i;const r=h=>this.i!==i?(i=this.i,e(h)):Promise.resolve();let s=new Be;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Be,t.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const h=s;t.enqueueRetryable(async()=>{await h.promise,await r(this.currentUser)})},l=h=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Be)}},0),a()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ot(typeof i.accessToken=="string"),new uT(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ot(t===null||typeof t=="string"),new ke(t)}}class gC{constructor(t,e,i){this.l=t,this.h=e,this.P=i,this.type="FirstParty",this.user=ke.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class yC{constructor(t,e,i){this.l=t,this.h=e,this.P=i}getToken(){return Promise.resolve(new gC(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(ke.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vC{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wC{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){ot(this.o===void 0);const i=s=>{s.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?e(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const r=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(ot(typeof e.token=="string"),this.R=e.token,new vC(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const r=EC(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<e&&(i+=t.charAt(r[s]%t.length))}return i}}function _t(n,t){return n<t?-1:n>t?1:0}function ua(n,t,e){return n.length===t.length&&n.every((i,r)=>e(i,t[r]))}function cT(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Z(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Z(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Z(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Z(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Yt.fromMillis(Date.now())}static fromDate(t){return Yt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new Yt(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?_t(this.nanoseconds,t.nanoseconds):_t(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ut(t)}static min(){return new ut(new Yt(0,0))}static max(){return new ut(new Yt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(t,e,i){e===void 0?e=0:e>t.length&&rt(),i===void 0?i=t.length-e:i>t.length-e&&rt(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return Tl.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Tl?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){const s=t.get(r),a=e.get(r);if(s<a)return-1;if(s>a)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Pt extends Tl{construct(t,e,i){return new Pt(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new Z(G.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(r=>r.length>0))}return new Pt(e)}static emptyPath(){return new Pt([])}}const TC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zt extends Tl{construct(t,e,i){return new Zt(t,e,i)}static isValidIdentifier(t){return TC.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Zt(["__name__"])}static fromServerFormat(t){const e=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Z(G.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let a=!1;for(;r<t.length;){const l=t[r];if(l==="\\"){if(r+1===t.length)throw new Z(G.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[r+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Z(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=h,r+=2}else l==="`"?(a=!a,r++):l!=="."||a?(i+=l,r++):(s(),r++)}if(s(),a)throw new Z(G.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Zt(e)}static emptyPath(){return new Zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(t){this.path=t}static fromPath(t){return new et(Pt.fromString(t))}static fromName(t){return new et(Pt.fromString(t).popFirst(5))}static empty(){return new et(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Pt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Pt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new et(new Pt(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(t,e,i,r){this.indexId=t,this.collectionGroup=e,this.fields=i,this.indexState=r}}function qp(n){return n.fields.find(t=>t.kind===2)}function _s(n){return n.fields.filter(t=>t.kind!==2)}td.UNKNOWN_ID=-1;class vh{constructor(t,e){this.fieldPath=t,this.kind=e}}class Il{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new Il(0,In.min())}}function hT(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=ut.fromTimestamp(i===1e9?new Yt(e+1,0):new Yt(e,i));return new In(r,et.empty(),t)}function dT(n){return new In(n.readTime,n.key,-1)}class In{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new In(ut.min(),et.empty(),-1)}static max(){return new In(ut.max(),et.empty(),-1)}}function p_(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=et.comparator(n.documentKey,t.documentKey),e!==0?e:_t(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qr(n){if(n.code!==G.FAILED_PRECONDITION||n.message!==fT)throw n;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&rt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new U((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(e,s).next(i,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof U?e:U.resolve(e)}catch(e){return U.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):U.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):U.reject(e)}static resolve(t){return new U((e,i)=>{e(t)})}static reject(t){return new U((e,i)=>{i(t)})}static waitFor(t){return new U((e,i)=>{let r=0,s=0,a=!1;t.forEach(l=>{++r,l.next(()=>{++s,a&&s===r&&e()},h=>i(h))}),a=!0,s===r&&e()})}static or(t){let e=U.resolve(!1);for(const i of t)e=e.next(r=>r?U.resolve(r):i());return e}static forEach(t,e){const i=[];return t.forEach((r,s)=>{i.push(e.call(this,r,s))}),this.waitFor(i)}static mapArray(t,e){return new U((i,r)=>{const s=t.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const f=h;e(t[f]).next(_=>{a[f]=_,++l,l===s&&i(a)},_=>r(_))}})}static doWhile(t,e){return new U((i,r)=>{const s=()=>{t()===!0?e().next(()=>{s()},r):i()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Be,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Zu(t,e.error)):this.V.resolve()},this.transaction.onerror=i=>{const r=m_(i.target.error);this.V.reject(new Zu(t,r))}}static open(t,e,i,r){try{return new Ld(e,t.transaction(r,i))}catch(s){throw new Zu(e,s)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(Q("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const e=this.transaction.objectStore(t);return new PC(e)}}class fi{constructor(t,e,i){this.name=t,this.version=e,this.p=i,fi.S(Xh())===12.2&&le("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Q("SimpleDb","Removing database:",t),gs(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!jE())return!1;if(fi.v())return!0;const t=Xh(),e=fi.S(t),i=0<e&&e<10,r=mT(t),s=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||s)}static v(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)===null||t===void 0?void 0:t.C)==="YES"}static F(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(i)}async M(t){return this.db||(Q("SimpleDb","Opening database:",this.name),this.db=await new Promise((e,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const a=s.target.result;e(a)},r.onblocked=()=>{i(new Zu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const a=s.target.error;a.name==="VersionError"?i(new Z(G.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?i(new Z(G.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):i(new Zu(t,a))},r.onupgradeneeded=s=>{Q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.O(a,r.transaction,s.oldVersion,this.version).next(()=>{Q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(t){this.N=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,i,r){const s=e==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(t);const l=Ld.open(this.db,t,s?"readonly":"readwrite",i),h=r(l).next(f=>(l.g(),f)).catch(f=>(l.abort(f),U.reject(f))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,f=h.name!=="FirebaseError"&&a<3;if(Q("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function mT(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}class IC{constructor(t){this.B=t,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(t){this.B=t}done(){this.k=!0}$(t){this.q=t}delete(){return gs(this.B.delete())}}class Zu extends Z{constructor(t,e){super(G.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Yr(n){return n.name==="IndexedDbTransactionError"}class PC{constructor(t){this.store=t}put(t,e){let i;return e!==void 0?(Q("SimpleDb","PUT",this.store.name,t,e),i=this.store.put(e,t)):(Q("SimpleDb","PUT",this.store.name,"<auto-key>",t),i=this.store.put(t)),gs(i)}add(t){return Q("SimpleDb","ADD",this.store.name,t,t),gs(this.store.add(t))}get(t){return gs(this.store.get(t)).next(e=>(e===void 0&&(e=null),Q("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return Q("SimpleDb","DELETE",this.store.name,t),gs(this.store.delete(t))}count(){return Q("SimpleDb","COUNT",this.store.name),gs(this.store.count())}U(t,e){const i=this.options(t,e),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new U((a,l)=>{s.onerror=h=>{l(h.target.error)},s.onsuccess=h=>{a(h.target.result)}})}{const s=this.cursor(i),a=[];return this.W(s,(l,h)=>{a.push(h)}).next(()=>a)}}G(t,e){const i=this.store.getAll(t,e===null?void 0:e);return new U((r,s)=>{i.onerror=a=>{s(a.target.error)},i.onsuccess=a=>{r(a.target.result)}})}j(t,e){Q("SimpleDb","DELETE ALL",this.store.name);const i=this.options(t,e);i.H=!1;const r=this.cursor(i);return this.W(r,(s,a,l)=>l.delete())}J(t,e){let i;e?i=t:(i={},e=t);const r=this.cursor(i);return this.W(r,e)}Y(t){const e=this.cursor({});return new U((i,r)=>{e.onerror=s=>{const a=m_(s.target.error);r(a)},e.onsuccess=s=>{const a=s.target.result;a?t(a.primaryKey,a.value).next(l=>{l?a.continue():i()}):i()}})}W(t,e){const i=[];return new U((r,s)=>{t.onerror=a=>{s(a.target.error)},t.onsuccess=a=>{const l=a.target.result;if(!l)return void r();const h=new IC(l),f=e(l.primaryKey,l.value,h);if(f instanceof U){const _=f.catch(g=>(h.done(),U.reject(g)));i.push(_)}h.isDone?r():h.K===null?l.continue():l.continue(h.K)}}).next(()=>U.waitFor(i))}options(t,e){let i;return t!==void 0&&(typeof t=="string"?i=t:e=t),{index:i,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const i=this.store.index(t.index);return t.H?i.openKeyCursor(t.range,e):i.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function gs(n){return new U((t,e)=>{n.onsuccess=i=>{const r=i.target.result;t(r)},n.onerror=i=>{const r=m_(i.target.error);e(r)}})}let ov=!1;function m_(n){const t=fi.S(Xh());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const i=new Z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ov||(ov=!0,setTimeout(()=>{throw i},0)),i}}return n}class SC{constructor(t,e){this.asyncQueue=t,this.Z=e,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(t){Q("IndexBackfiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,async()=>{this.task=null;try{Q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){Yr(e)?Q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await Qr(e)}await this.X(6e4)})}}class AC{constructor(t,e){this.localStore=t,this.persistence=e}async ee(t=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",e=>this.te(e,t))}te(t,e){const i=new Set;let r=e,s=!0;return U.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(a=>{if(a!==null&&!i.has(a))return Q("IndexBackfiller",`Processing collection: ${a}`),this.ne(t,a,r).next(l=>{r-=l,i.add(a)});s=!1})).next(()=>e-r)}ne(t,e,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(r=>this.localStore.localDocuments.getNextDocuments(t,e,r,i).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(t,a).next(()=>this.re(r,s)).next(l=>(Q("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(t,e,l))).next(()=>a.size)}))}re(t,e){let i=t;return e.changes.forEach((r,s)=>{const a=dT(s);p_(a,i)>0&&(i=a)}),new In(i.readTime,i.documentKey,Math.max(e.batchId,t.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.ie(i),this.se=i=>e.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}hn.oe=-1;function jl(n){return n==null}function Pl(n){return n===0&&1/n==-1/0}function _T(n){return typeof n=="number"&&Number.isInteger(n)&&!Pl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=av(t)),t=xC(n.get(e),t);return av(t)}function xC(n,t){let e=t;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":e+="";break;case"":e+="";break;default:e+=s}}return e}function av(n){return n+""}function li(n){const t=n.length;if(ot(t>=2),t===2)return ot(n.charAt(0)===""&&n.charAt(1)===""),Pt.emptyPath();const e=t-2,i=[];let r="";for(let s=0;s<t;){const a=n.indexOf("",s);switch((a<0||a>e)&&rt(),n.charAt(a+1)){case"":const l=n.substring(s,a);let h;r.length===0?h=l:(r+=l,h=r,r=""),i.push(h);break;case"":r+=n.substring(s,a),r+="\0";break;case"":r+=n.substring(s,a+1);break;default:rt()}s=a+2}return new Pt(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(n,t){return[n,en(t)]}function gT(n,t,e){return[n,en(t),e]}const CC={},RC=["prefixPath","collectionGroup","readTime","documentId"],LC=["prefixPath","collectionGroup","documentId"],kC=["collectionGroup","readTime","prefixPath","documentId"],bC=["canonicalId","targetId"],DC=["targetId","path"],VC=["path","targetId"],MC=["collectionId","parent"],NC=["indexId","uid"],OC=["uid","sequenceNumber"],FC=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],BC=["indexId","uid","orderedDocumentKey"],zC=["userId","collectionPath","documentId"],UC=["userId","collectionPath","largestBatchId"],jC=["userId","collectionGroup","largestBatchId"],yT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],$C=[...yT,"documentOverlays"],vT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],wT=vT,__=[...wT,"indexConfiguration","indexState","indexEntries"],qC=__,GC=[...__,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp extends pT{constructor(t,e){super(),this._e=t,this.currentSequenceNumber=e}}function Pe(n,t){const e=nt(n);return fi.F(e._e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Ks(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function ET(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(t,e){this.comparator=t,this.root=e||Ne.EMPTY}insert(t,e){return new Ut(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ne.BLACK,null,null))}remove(t){return new Ut(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ne.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return e+i.left.size;r<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){const t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new eh(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new eh(this.root,t,this.comparator,!1)}getReverseIterator(){return new eh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new eh(this.root,t,this.comparator,!0)}}class eh{constructor(t,e,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?i(t.key,e):1,e&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ne{constructor(t,e,i,r,s){this.key=t,this.value=e,this.color=i??Ne.RED,this.left=r??Ne.EMPTY,this.right=s??Ne.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,r,s){return new Ne(t??this.key,e??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,e,i),null):s===0?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ne.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),e(t,r.key)===0){if(r.right.isEmpty())return Ne.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ne.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ne.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw rt();const t=this.left.check();if(t!==this.right.check())throw rt();return t+(this.isRed()?0:1)}}Ne.EMPTY=null,Ne.RED=!0,Ne.BLACK=!1;Ne.EMPTY=new class{constructor(){this.size=0}get key(){throw rt()}get value(){throw rt()}get color(){throw rt()}get left(){throw rt()}get right(){throw rt()}copy(t,e,i,r,s){return this}insert(t,e,i){return new Ne(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(t){this.comparator=t,this.data=new Ut(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new cv(this.data.getIterator())}getIteratorFrom(t){return new cv(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof Ot)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const r=e.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Ot(this.comparator);return e.data=t,e}}class cv{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Io(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(t){this.fields=t,t.sort(Zt.comparator)}static empty(){return new dn([])}unionWith(t){let e=new Ot(Zt.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new dn(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return ua(this.fields,t.fields,(e,i)=>e.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new TT("Invalid base64 string: "+s):s}}(t);return new oe(e)}static fromUint8Array(t){const e=function(r){let s="";for(let a=0;a<r.length;++a)s+=String.fromCharCode(r[a]);return s}(t);return new oe(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return _t(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}oe.EMPTY_BYTE_STRING=new oe("");const HC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(n){if(ot(!!n),typeof n=="string"){let t=0;const e=HC.exec(n);if(ot(!!e),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zr(n){return typeof n=="string"?oe.fromBase64String(n):oe.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function g_(n){const t=n.mapValue.fields.__previous_value__;return kd(t)?g_(t):t}function Sl(n){const t=Hi(n.mapValue.fields.__local_write_time__.timestampValue);return new Yt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(t,e,i,r,s,a,l,h,f){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}}class Ur{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Ur("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Ur&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Eh={nullValue:"NULL_VALUE"};function Ns(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?kd(n)?4:IT(n)?9007199254740991:bd(n)?10:11:rt()}function _i(n,t){if(n===t)return!0;const e=Ns(n);if(e!==Ns(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Sl(n).isEqual(Sl(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const a=Hi(r.timestampValue),l=Hi(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(r,s){return zr(r.bytesValue).isEqual(zr(s.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return Ht(r.geoPointValue.latitude)===Ht(s.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Ht(r.integerValue)===Ht(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const a=Ht(r.doubleValue),l=Ht(s.doubleValue);return a===l?Pl(a)===Pl(l):isNaN(a)&&isNaN(l)}return!1}(n,t);case 9:return ua(n.arrayValue.values||[],t.arrayValue.values||[],_i);case 10:case 11:return function(r,s){const a=r.mapValue.fields||{},l=s.mapValue.fields||{};if(lv(a)!==lv(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!_i(a[h],l[h])))return!1;return!0}(n,t);default:return rt()}}function Al(n,t){return(n.values||[]).find(e=>_i(e,t))!==void 0}function jr(n,t){if(n===t)return 0;const e=Ns(n),i=Ns(t);if(e!==i)return _t(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return _t(n.booleanValue,t.booleanValue);case 2:return function(s,a){const l=Ht(s.integerValue||s.doubleValue),h=Ht(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,t);case 3:return hv(n.timestampValue,t.timestampValue);case 4:return hv(Sl(n),Sl(t));case 5:return _t(n.stringValue,t.stringValue);case 6:return function(s,a){const l=zr(s),h=zr(a);return l.compareTo(h)}(n.bytesValue,t.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const _=_t(l[f],h[f]);if(_!==0)return _}return _t(l.length,h.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,a){const l=_t(Ht(s.latitude),Ht(a.latitude));return l!==0?l:_t(Ht(s.longitude),Ht(a.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return dv(n.arrayValue,t.arrayValue);case 10:return function(s,a){var l,h,f,_;const g=s.fields||{},w=a.fields||{},E=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=(h=w.value)===null||h===void 0?void 0:h.arrayValue,R=_t(((f=E==null?void 0:E.values)===null||f===void 0?void 0:f.length)||0,((_=x==null?void 0:x.values)===null||_===void 0?void 0:_.length)||0);return R!==0?R:dv(E,x)}(n.mapValue,t.mapValue);case 11:return function(s,a){if(s===Pr.mapValue&&a===Pr.mapValue)return 0;if(s===Pr.mapValue)return 1;if(a===Pr.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),f=a.fields||{},_=Object.keys(f);h.sort(),_.sort();for(let g=0;g<h.length&&g<_.length;++g){const w=_t(h[g],_[g]);if(w!==0)return w;const E=jr(l[h[g]],f[_[g]]);if(E!==0)return E}return _t(h.length,_.length)}(n.mapValue,t.mapValue);default:throw rt()}}function hv(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return _t(n,t);const e=Hi(n),i=Hi(t),r=_t(e.seconds,i.seconds);return r!==0?r:_t(e.nanos,i.nanos)}function dv(n,t){const e=n.values||[],i=t.values||[];for(let r=0;r<e.length&&r<i.length;++r){const s=jr(e[r],i[r]);if(s)return s}return _t(e.length,i.length)}function la(n){return Wp(n)}function Wp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const i=Hi(e);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return zr(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return et.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let i="[",r=!0;for(const s of e.values||[])r?r=!1:i+=",",i+=Wp(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(e){const i=Object.keys(e.fields||{}).sort();let r="{",s=!0;for(const a of i)s?s=!1:r+=",",r+=`${a}:${Wp(e.fields[a])}`;return r+"}"}(n.mapValue):rt()}function Os(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function Hp(n){return!!n&&"integerValue"in n}function xl(n){return!!n&&"arrayValue"in n}function fv(n){return!!n&&"nullValue"in n}function pv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Th(n){return!!n&&"mapValue"in n}function bd(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="__vector__"}function Qu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Ks(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=Qu(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Qu(n.arrayValue.values[e]);return t}return Object.assign({},n)}function IT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const PT={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function ZC(n){return"nullValue"in n?Eh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Os(Ur.empty(),et.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?bd(n)?PT:{mapValue:{}}:rt()}function QC(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Os(Ur.empty(),et.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?PT:"mapValue"in n?bd(n)?{mapValue:{}}:Pr:rt()}function mv(n,t){const e=jr(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function _v(n,t){const e=jr(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(t){this.value=t}static empty(){return new Oe({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!Th(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Qu(e)}setAll(t){let e=Zt.emptyPath(),i={},r=[];t.forEach((a,l)=>{if(!e.isImmediateParentOf(l)){const h=this.getFieldsMap(e);this.applyChanges(h,i,r),i={},r=[],e=l.popLast()}a?i[l.lastSegment()]=Qu(a):r.push(l.lastSegment())});const s=this.getFieldsMap(e);this.applyChanges(s,i,r)}delete(t){const e=this.field(t.popLast());Th(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return _i(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=e.mapValue.fields[t.get(i)];Th(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,i){Ks(e,(r,s)=>t[r]=s);for(const r of i)delete t[r]}clone(){return new Oe(Qu(this.value))}}function ST(n){const t=[];return Ks(n.fields,(e,i)=>{const r=new Zt([e]);if(Th(i)){const s=ST(i.mapValue).fields;if(s.length===0)t.push(r);else for(const a of s)t.push(r.child(a))}else t.push(r)}),new dn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(t,e,i,r,s,a,l){this.key=t,this.documentType=e,this.version=i,this.readTime=r,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(t){return new qt(t,0,ut.min(),ut.min(),ut.min(),Oe.empty(),0)}static newFoundDocument(t,e,i,r){return new qt(t,1,e,ut.min(),i,r,0)}static newNoDocument(t,e){return new qt(t,2,e,ut.min(),ut.min(),Oe.empty(),0)}static newUnknownDocument(t,e){return new qt(t,3,e,ut.min(),ut.min(),Oe.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(ut.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Oe.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Oe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ut.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof qt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(t,e){this.position=t,this.inclusive=e}}function gv(n,t,e){let i=0;for(let r=0;r<n.position.length;r++){const s=t[r],a=n.position[r];if(s.field.isKeyField()?i=et.comparator(et.fromName(a.referenceValue),e.key):i=jr(a,e.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function yv(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!_i(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(t,e="asc"){this.field=t,this.dir=e}}function YC(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{}class St extends AT{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new XC(t,e,i):e==="array-contains"?new eR(t,i):e==="in"?new bT(t,i):e==="not-in"?new nR(t,i):e==="array-contains-any"?new iR(t,i):new St(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new JC(t,i):new tR(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(jr(e,this.value)):e!==null&&Ns(this.value)===Ns(e)&&this.matchesComparison(jr(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return rt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vt extends AT{constructor(t,e){super(),this.filters=t,this.op=e,this.ae=null}static create(t,e){return new Vt(t,e)}matches(t){return ca(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ca(n){return n.op==="and"}function Kp(n){return n.op==="or"}function y_(n){return xT(n)&&ca(n)}function xT(n){for(const t of n.filters)if(t instanceof Vt)return!1;return!0}function Zp(n){if(n instanceof St)return n.field.canonicalString()+n.op.toString()+la(n.value);if(y_(n))return n.filters.map(t=>Zp(t)).join(",");{const t=n.filters.map(e=>Zp(e)).join(",");return`${n.op}(${t})`}}function CT(n,t){return n instanceof St?function(i,r){return r instanceof St&&i.op===r.op&&i.field.isEqual(r.field)&&_i(i.value,r.value)}(n,t):n instanceof Vt?function(i,r){return r instanceof Vt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,a,l)=>s&&CT(a,r.filters[l]),!0):!1}(n,t):void rt()}function RT(n,t){const e=n.filters.concat(t);return Vt.create(e,n.op)}function LT(n){return n instanceof St?function(e){return`${e.field.canonicalString()} ${e.op} ${la(e.value)}`}(n):n instanceof Vt?function(e){return e.op.toString()+" {"+e.getFilters().map(LT).join(" ,")+"}"}(n):"Filter"}class XC extends St{constructor(t,e,i){super(t,e,i),this.key=et.fromName(i.referenceValue)}matches(t){const e=et.comparator(t.key,this.key);return this.matchesComparison(e)}}class JC extends St{constructor(t,e){super(t,"in",e),this.keys=kT("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class tR extends St{constructor(t,e){super(t,"not-in",e),this.keys=kT("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function kT(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(i=>et.fromName(i.referenceValue))}class eR extends St{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return xl(e)&&Al(e.arrayValue,this.value)}}class bT extends St{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Al(this.value.arrayValue,e)}}class nR extends St{constructor(t,e){super(t,"not-in",e)}matches(t){if(Al(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&!Al(this.value.arrayValue,e)}}class iR extends St{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!xl(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>Al(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(t,e=null,i=[],r=[],s=null,a=null,l=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=a,this.endAt=l,this.ue=null}}function Qp(n,t=null,e=[],i=[],r=null,s=null,a=null){return new rR(n,t,e,i,r,s,a)}function Fs(n){const t=nt(n);if(t.ue===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>Zp(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),jl(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>la(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>la(i)).join(",")),t.ue=e}return t.ue}function $l(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!YC(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!CT(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!yv(n.startAt,t.startAt)&&yv(n.endAt,t.endAt)}function ed(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function nd(n,t){return n.filters.filter(e=>e instanceof St&&e.field.isEqual(t))}function vv(n,t,e){let i=Eh,r=!0;for(const s of nd(n,t)){let a=Eh,l=!0;switch(s.op){case"<":case"<=":a=ZC(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Eh}mv({value:i,inclusive:r},{value:a,inclusive:l})<0&&(i=a,r=l)}if(e!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){const a=e.position[s];mv({value:i,inclusive:r},{value:a,inclusive:e.inclusive})<0&&(i=a,r=e.inclusive);break}}return{value:i,inclusive:r}}function wv(n,t,e){let i=Pr,r=!0;for(const s of nd(n,t)){let a=Pr,l=!0;switch(s.op){case">=":case">":a=QC(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=Pr}_v({value:i,inclusive:r},{value:a,inclusive:l})>0&&(i=a,r=l)}if(e!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){const a=e.position[s];_v({value:i,inclusive:r},{value:a,inclusive:e.inclusive})>0&&(i=a,r=e.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(t,e=null,i=[],r=[],s=null,a="F",l=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function DT(n,t,e,i,r,s,a,l){return new Qi(n,t,e,i,r,s,a,l)}function Sa(n){return new Qi(n)}function Ev(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function v_(n){return n.collectionGroup!==null}function Qo(n){const t=nt(n);if(t.ce===null){t.ce=[];const e=new Set;for(const s of t.explicitOrderBy)t.ce.push(s),e.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Ot(Zt.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(t).forEach(s=>{e.has(s.canonicalString())||s.isKeyField()||t.ce.push(new Cl(s,i))}),e.has(Zt.keyField().canonicalString())||t.ce.push(new Cl(Zt.keyField(),i))}return t.ce}function nn(n){const t=nt(n);return t.le||(t.le=sR(t,Qo(n))),t.le}function sR(n,t){if(n.limitType==="F")return Qp(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new Cl(r.field,s)});const e=n.endAt?new $r(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new $r(n.startAt.position,n.startAt.inclusive):null;return Qp(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function Yp(n,t){const e=n.filters.concat([t]);return new Qi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function id(n,t,e){return new Qi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function ql(n,t){return $l(nn(n),nn(t))&&n.limitType===t.limitType}function VT(n){return`${Fs(nn(n))}|lt:${n.limitType}`}function Co(n){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(r=>LT(r)).join(", ")}]`),jl(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(r=>la(r)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(r=>la(r)).join(",")),`Target(${i})`}(nn(n))}; limitType=${n.limitType})`}function Gl(n,t){return t.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):et.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,t)&&function(i,r){for(const s of Qo(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,t)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(n,t)&&function(i,r){return!(i.startAt&&!function(a,l,h){const f=gv(a,l,h);return a.inclusive?f<=0:f<0}(i.startAt,Qo(i),r)||i.endAt&&!function(a,l,h){const f=gv(a,l,h);return a.inclusive?f>=0:f>0}(i.endAt,Qo(i),r))}(n,t)}function MT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function NT(n){return(t,e)=>{let i=!1;for(const r of Qo(n)){const s=oR(r,t,e);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function oR(n,t,e){const i=n.field.isKeyField()?et.comparator(t.key,e.key):function(s,a,l){const h=a.data.field(s),f=l.data.field(s);return h!==null&&f!==null?jr(h,f):rt()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return rt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[e]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Ks(this.inner,(e,i)=>{for(const[r,s]of i)t(r,s)})}isEmpty(){return ET(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=new Ut(et.comparator);function fn(){return aR}const OT=new Ut(et.comparator);function Ou(...n){let t=OT;for(const e of n)t=t.insert(e.key,e);return t}function FT(n){let t=OT;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function ci(){return Yu()}function BT(){return Yu()}function Yu(){return new Xr(n=>n.toString(),(n,t)=>n.isEqual(t))}const uR=new Ut(et.comparator),lR=new Ot(et.comparator);function yt(...n){let t=lR;for(const e of n)t=t.add(e);return t}const cR=new Ot(_t);function w_(){return cR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pl(t)?"-0":t}}function zT(n){return{integerValue:""+n}}function UT(n,t){return _T(t)?zT(t):E_(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(){this._=void 0}}function hR(n,t,e){return n instanceof ha?function(r,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&kd(s)&&(s=g_(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(e,t):n instanceof Bs?$T(n,t):n instanceof zs?qT(n,t):function(r,s){const a=jT(r,s),l=Tv(a)+Tv(r.Pe);return Hp(a)&&Hp(r.Pe)?zT(l):E_(r.serializer,l)}(n,t)}function dR(n,t,e){return n instanceof Bs?$T(n,t):n instanceof zs?qT(n,t):e}function jT(n,t){return n instanceof da?function(i){return Hp(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class ha extends Dd{}class Bs extends Dd{constructor(t){super(),this.elements=t}}function $T(n,t){const e=GT(t);for(const i of n.elements)e.some(r=>_i(r,i))||e.push(i);return{arrayValue:{values:e}}}class zs extends Dd{constructor(t){super(),this.elements=t}}function qT(n,t){let e=GT(t);for(const i of n.elements)e=e.filter(r=>!_i(r,i));return{arrayValue:{values:e}}}class da extends Dd{constructor(t,e){super(),this.serializer=t,this.Pe=e}}function Tv(n){return Ht(n.integerValue||n.doubleValue)}function GT(n){return xl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(t,e){this.field=t,this.transform=e}}function fR(n,t){return n.field.isEqual(t.field)&&function(i,r){return i instanceof Bs&&r instanceof Bs||i instanceof zs&&r instanceof zs?ua(i.elements,r.elements,_i):i instanceof da&&r instanceof da?_i(i.Pe,r.Pe):i instanceof ha&&r instanceof ha}(n.transform,t.transform)}class pR{constructor(t,e){this.version=t,this.transformResults=e}}class Qt{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Qt}static exists(t){return new Qt(void 0,t)}static updateTime(t){return new Qt(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Ih(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Vd{}function WT(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new xa(n.key,Qt.none()):new Aa(n.key,n.data,Qt.none());{const e=n.data,i=Oe.empty();let r=new Ot(Zt.comparator);for(let s of t.fields)if(!r.has(s)){let a=e.field(s);a===null&&s.length>1&&(s=s.popLast(),a=e.field(s)),a===null?i.delete(s):i.set(s,a),r=r.add(s)}return new Yi(n.key,i,new dn(r.toArray()),Qt.none())}}function mR(n,t,e){n instanceof Aa?function(r,s,a){const l=r.value.clone(),h=Pv(r.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,t,e):n instanceof Yi?function(r,s,a){if(!Ih(r.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Pv(r.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(HT(r)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,t,e):function(r,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,e)}function Xu(n,t,e,i){return n instanceof Aa?function(s,a,l,h){if(!Ih(s.precondition,a))return l;const f=s.value.clone(),_=Sv(s.fieldTransforms,h,a);return f.setAll(_),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,t,e,i):n instanceof Yi?function(s,a,l,h){if(!Ih(s.precondition,a))return l;const f=Sv(s.fieldTransforms,h,a),_=a.data;return _.setAll(HT(s)),_.setAll(f),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,t,e,i):function(s,a,l){return Ih(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,t,e)}function _R(n,t){let e=null;for(const i of n.fieldTransforms){const r=t.data.field(i.field),s=jT(i.transform,r||null);s!=null&&(e===null&&(e=Oe.empty()),e.set(i.field,s))}return e||null}function Iv(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&ua(i,r,(s,a)=>fR(s,a))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Aa extends Vd{constructor(t,e,i,r=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Yi extends Vd{constructor(t,e,i,r,s=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function HT(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}}),t}function Pv(n,t,e){const i=new Map;ot(n.length===e.length);for(let r=0;r<e.length;r++){const s=n[r],a=s.transform,l=t.data.field(s.field);i.set(s.field,dR(a,l,e[r]))}return i}function Sv(n,t,e){const i=new Map;for(const r of n){const s=r.transform,a=e.data.field(r.field);i.set(r.field,hR(s,a,t))}return i}class xa extends Vd{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class T_ extends Vd{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(t,e,i,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(t.key)&&mR(s,t,i[r])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=Xu(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=Xu(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=BT();return this.mutations.forEach(r=>{const s=t.get(r.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=e.has(r.key)?null:l;const h=WT(a,l);h!==null&&i.set(r.key,h),a.isValidDocument()||a.convertToNoDocument(ut.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),yt())}isEqual(t){return this.batchId===t.batchId&&ua(this.mutations,t.mutations,(e,i)=>Iv(e,i))&&ua(this.baseMutations,t.baseMutations,(e,i)=>Iv(e,i))}}class P_{constructor(t,e,i,r){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=r}static from(t,e,i){ot(t.mutations.length===i.length);let r=function(){return uR}();const s=t.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,i[a].version);return new P_(t,e,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _e,Ct;function KT(n){switch(n){default:return rt();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0}}function ZT(n){if(n===void 0)return le("GRPC error has no .code"),G.UNKNOWN;switch(n){case _e.OK:return G.OK;case _e.CANCELLED:return G.CANCELLED;case _e.UNKNOWN:return G.UNKNOWN;case _e.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case _e.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case _e.INTERNAL:return G.INTERNAL;case _e.UNAVAILABLE:return G.UNAVAILABLE;case _e.UNAUTHENTICATED:return G.UNAUTHENTICATED;case _e.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case _e.NOT_FOUND:return G.NOT_FOUND;case _e.ALREADY_EXISTS:return G.ALREADY_EXISTS;case _e.PERMISSION_DENIED:return G.PERMISSION_DENIED;case _e.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case _e.ABORTED:return G.ABORTED;case _e.OUT_OF_RANGE:return G.OUT_OF_RANGE;case _e.UNIMPLEMENTED:return G.UNIMPLEMENTED;case _e.DATA_LOSS:return G.DATA_LOSS;default:return rt()}}(Ct=_e||(_e={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=new Rs([4294967295,4294967295],0);function Av(n){const t=QT().encode(n),e=new nT;return e.update(t),new Uint8Array(e.digest())}function xv(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Rs([e,i],0),new Rs([r,s],0)]}class A_{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new Fu(`Invalid padding: ${e}`);if(i<0)throw new Fu(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Fu(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new Fu(`Invalid padding when bitmap length is 0: ${e}`);this.Ie=8*t.length-e,this.Te=Rs.fromNumber(this.Ie)}Ee(t,e,i){let r=t.add(e.multiply(Rs.fromNumber(i)));return r.compare(yR)===1&&(r=new Rs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const e=Av(t),[i,r]=xv(e);for(let s=0;s<this.hashCount;s++){const a=this.Ee(i,r,s);if(!this.de(a))return!1}return!0}static create(t,e,i){const r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new A_(s,r,e);return i.forEach(l=>a.insert(l)),a}insert(t){if(this.Ie===0)return;const e=Av(t),[i,r]=xv(e);for(let s=0;s<this.hashCount;s++){const a=this.Ee(i,r,s);this.Ae(a)}}Ae(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class Fu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(t,e,i,r,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const r=new Map;return r.set(t,Kl.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new Hl(ut.min(),r,new Ut(_t),fn(),yt())}}class Kl{constructor(t,e,i,r,s){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new Kl(i,e,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(t,e,i,r){this.Re=t,this.removedTargetIds=e,this.key=i,this.Ve=r}}class YT{constructor(t,e){this.targetId=t,this.me=e}}class XT{constructor(t,e,i=oe.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=r}}class Cv{constructor(){this.fe=0,this.ge=Lv(),this.pe=oe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=yt(),e=yt(),i=yt();return this.ge.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:i=i.add(r);break;default:rt()}}),new Kl(this.pe,this.ye,t,e,i)}Ce(){this.we=!1,this.ge=Lv()}Fe(t,e){this.we=!0,this.ge=this.ge.insert(t,e)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,ot(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class vR{constructor(t){this.Le=t,this.Be=new Map,this.ke=fn(),this.qe=Rv(),this.Qe=new Ut(_t)}Ke(t){for(const e of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(e,t.Ve):this.Ue(e,t.key,t.Ve);for(const e of t.removedTargetIds)this.Ue(e,t.key,t.Ve)}We(t){this.forEachTarget(t,e=>{const i=this.Ge(e);switch(t.state){case 0:this.ze(e)&&i.De(t.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(t.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(e);break;case 3:this.ze(e)&&(i.Ne(),i.De(t.resumeToken));break;case 4:this.ze(e)&&(this.je(e),i.De(t.resumeToken));break;default:rt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Be.forEach((i,r)=>{this.ze(r)&&e(r)})}He(t){const e=t.targetId,i=t.me.count,r=this.Je(e);if(r){const s=r.target;if(ed(s))if(i===0){const a=new et(s.path);this.Ue(e,a,qt.newNoDocument(a,ut.min()))}else ot(i===1);else{const a=this.Ye(e);if(a!==i){const l=this.Ze(t),h=l?this.Xe(l,t,a):1;if(h!==0){this.je(e);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(e,f)}}}}}Ze(t){const e=t.me.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=e;let a,l;try{a=zr(i).toUint8Array()}catch(h){if(h instanceof TT)return mi("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new A_(a,r,s)}catch(h){return mi(h instanceof Fu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Ie===0?null:l}Xe(t,e,i){return e.me.count===i-this.nt(t,e.targetId)?0:2}nt(t,e){const i=this.Le.getRemoteKeysForTarget(e);let r=0;return i.forEach(s=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(l)||(this.Ue(e,s,null),r++)}),r}rt(t){const e=new Map;this.Be.forEach((s,a)=>{const l=this.Je(a);if(l){if(s.current&&ed(l.target)){const h=new et(l.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,qt.newNoDocument(h,t))}s.be&&(e.set(a,s.ve()),s.Ce())}});let i=yt();this.qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const f=this.Je(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(i=i.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(t));const r=new Hl(t,e,this.Qe,this.ke,i);return this.ke=fn(),this.qe=Rv(),this.Qe=new Ut(_t),r}$e(t,e){if(!this.ze(t))return;const i=this.it(t,e.key)?2:0;this.Ge(t).Fe(e.key,i),this.ke=this.ke.insert(e.key,e),this.qe=this.qe.insert(e.key,this.st(e.key).add(t))}Ue(t,e,i){if(!this.ze(t))return;const r=this.Ge(t);this.it(t,e)?r.Fe(e,1):r.Me(e),this.qe=this.qe.insert(e,this.st(e).delete(t)),i&&(this.ke=this.ke.insert(e,i))}removeTarget(t){this.Be.delete(t)}Ye(t){const e=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let e=this.Be.get(t);return e||(e=new Cv,this.Be.set(t,e)),e}st(t){let e=this.qe.get(t);return e||(e=new Ot(_t),this.qe=this.qe.insert(t,e)),e}ze(t){const e=this.Je(t)!==null;return e||Q("WatchChangeAggregator","Detected inactive target",t),e}Je(t){const e=this.Be.get(t);return e&&e.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new Cv),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.Ue(t,e,null)})}it(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Rv(){return new Ut(et.comparator)}function Lv(){return new Ut(et.comparator)}const wR=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),ER=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),TR=(()=>({and:"AND",or:"OR"}))();class IR{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Xp(n,t){return n.useProto3Json||jl(t)?t:{value:t}}function fa(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function JT(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function PR(n,t){return fa(n,t.toTimestamp())}function ce(n){return ot(!!n),ut.fromTimestamp(function(e){const i=Hi(e);return new Yt(i.seconds,i.nanos)}(n))}function x_(n,t){return Jp(n,t).canonicalString()}function Jp(n,t){const e=function(r){return new Pt(["projects",r.projectId,"databases",r.database])}(n).child("documents");return t===void 0?e:e.child(t)}function tI(n){const t=Pt.fromString(n);return ot(cI(t)),t}function Rl(n,t){return x_(n.databaseId,t.path)}function pi(n,t){const e=tI(t);if(e.get(1)!==n.databaseId.projectId)throw new Z(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Z(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new et(iI(e))}function eI(n,t){return x_(n.databaseId,t)}function nI(n){const t=tI(n);return t.length===4?Pt.emptyPath():iI(t)}function tm(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function iI(n){return ot(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function kv(n,t,e){return{name:Rl(n,t),fields:e.value.mapValue.fields}}function rI(n,t,e){const i=pi(n,t.name),r=ce(t.updateTime),s=t.createTime?ce(t.createTime):ut.min(),a=new Oe({mapValue:{fields:t.fields}}),l=qt.newFoundDocument(i,r,s,a);return e&&l.setHasCommittedMutations(),e?l.setHasCommittedMutations():l}function SR(n,t){return"found"in t?function(i,r){ot(!!r.found),r.found.name,r.found.updateTime;const s=pi(i,r.found.name),a=ce(r.found.updateTime),l=r.found.createTime?ce(r.found.createTime):ut.min(),h=new Oe({mapValue:{fields:r.found.fields}});return qt.newFoundDocument(s,a,l,h)}(n,t):"missing"in t?function(i,r){ot(!!r.missing),ot(!!r.readTime);const s=pi(i,r.missing),a=ce(r.readTime);return qt.newNoDocument(s,a)}(n,t):rt()}function AR(n,t){let e;if("targetChange"in t){t.targetChange;const i=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:rt()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(f,_){return f.useProto3Json?(ot(_===void 0||typeof _=="string"),oe.fromBase64String(_||"")):(ot(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),oe.fromUint8Array(_||new Uint8Array))}(n,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&function(f){const _=f.code===void 0?G.UNKNOWN:ZT(f.code);return new Z(_,f.message||"")}(a);e=new XT(i,r,s,l||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=pi(n,i.document.name),s=ce(i.document.updateTime),a=i.document.createTime?ce(i.document.createTime):ut.min(),l=new Oe({mapValue:{fields:i.document.fields}}),h=qt.newFoundDocument(r,s,a,l),f=i.targetIds||[],_=i.removedTargetIds||[];e=new Ph(f,_,h.key,h)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=pi(n,i.document),s=i.readTime?ce(i.readTime):ut.min(),a=qt.newNoDocument(r,s),l=i.removedTargetIds||[];e=new Ph([],l,a.key,a)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=pi(n,i.document),s=i.removedTargetIds||[];e=new Ph([],s,r,null)}else{if(!("filter"in t))return rt();{t.filter;const i=t.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,a=new gR(r,s),l=i.targetId;e=new YT(l,a)}}return e}function Ll(n,t){let e;if(t instanceof Aa)e={update:kv(n,t.key,t.value)};else if(t instanceof xa)e={delete:Rl(n,t.key)};else if(t instanceof Yi)e={update:kv(n,t.key,t.data),updateMask:bR(t.fieldMask)};else{if(!(t instanceof T_))return rt();e={verify:Rl(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(s,a){const l=a.transform;if(l instanceof ha)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Bs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof zs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof da)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw rt()}(0,i))),t.precondition.isNone||(e.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:PR(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:rt()}(n,t.precondition)),e}function em(n,t){const e=t.currentDocument?function(s){return s.updateTime!==void 0?Qt.updateTime(ce(s.updateTime)):s.exists!==void 0?Qt.exists(s.exists):Qt.none()}(t.currentDocument):Qt.none(),i=t.updateTransforms?t.updateTransforms.map(r=>function(a,l){let h=null;if("setToServerValue"in l)ot(l.setToServerValue==="REQUEST_TIME"),h=new ha;else if("appendMissingElements"in l){const _=l.appendMissingElements.values||[];h=new Bs(_)}else if("removeAllFromArray"in l){const _=l.removeAllFromArray.values||[];h=new zs(_)}else"increment"in l?h=new da(a,l.increment):rt();const f=Zt.fromServerFormat(l.fieldPath);return new Wl(f,h)}(n,r)):[];if(t.update){t.update.name;const r=pi(n,t.update.name),s=new Oe({mapValue:{fields:t.update.fields}});if(t.updateMask){const a=function(h){const f=h.fieldPaths||[];return new dn(f.map(_=>Zt.fromServerFormat(_)))}(t.updateMask);return new Yi(r,s,a,e,i)}return new Aa(r,s,e,i)}if(t.delete){const r=pi(n,t.delete);return new xa(r,e)}if(t.verify){const r=pi(n,t.verify);return new T_(r,e)}return rt()}function xR(n,t){return n&&n.length>0?(ot(t!==void 0),n.map(e=>function(r,s){let a=r.updateTime?ce(r.updateTime):ce(s);return a.isEqual(ut.min())&&(a=ce(s)),new pR(a,r.transformResults||[])}(e,t))):[]}function sI(n,t){return{documents:[eI(n,t.path)]}}function oI(n,t){const e={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=eI(n,r);const s=function(f){if(f.length!==0)return lI(Vt.create(f,"and"))}(t.filters);s&&(e.structuredQuery.where=s);const a=function(f){if(f.length!==0)return f.map(_=>function(w){return{field:Ro(w.field),direction:RR(w.dir)}}(_))}(t.orderBy);a&&(e.structuredQuery.orderBy=a);const l=Xp(n,t.limit);return l!==null&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(t.endAt)),{_t:e,parent:r}}function aI(n){let t=nI(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let r=null;if(i>0){ot(i===1);const _=e.from[0];_.allDescendants?r=_.collectionId:t=t.child(_.collectionId)}let s=[];e.where&&(s=function(g){const w=uI(g);return w instanceof Vt&&y_(w)?w.getFilters():[w]}(e.where));let a=[];e.orderBy&&(a=function(g){return g.map(w=>function(x){return new Cl(Lo(x.field),function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(w))}(e.orderBy));let l=null;e.limit&&(l=function(g){let w;return w=typeof g=="object"?g.value:g,jl(w)?null:w}(e.limit));let h=null;e.startAt&&(h=function(g){const w=!!g.before,E=g.values||[];return new $r(E,w)}(e.startAt));let f=null;return e.endAt&&(f=function(g){const w=!g.before,E=g.values||[];return new $r(E,w)}(e.endAt)),DT(t,r,a,s,l,"F",h,f)}function CR(n,t){const e=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt()}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function uI(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=Lo(e.unaryFilter.field);return St.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Lo(e.unaryFilter.field);return St.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Lo(e.unaryFilter.field);return St.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Lo(e.unaryFilter.field);return St.create(a,"!=",{nullValue:"NULL_VALUE"});default:return rt()}}(n):n.fieldFilter!==void 0?function(e){return St.create(Lo(e.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rt()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return Vt.create(e.compositeFilter.filters.map(i=>uI(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return rt()}}(e.compositeFilter.op))}(n):rt()}function RR(n){return wR[n]}function LR(n){return ER[n]}function kR(n){return TR[n]}function Ro(n){return{fieldPath:n.canonicalString()}}function Lo(n){return Zt.fromServerFormat(n.fieldPath)}function lI(n){return n instanceof St?function(e){if(e.op==="=="){if(pv(e.value))return{unaryFilter:{field:Ro(e.field),op:"IS_NAN"}};if(fv(e.value))return{unaryFilter:{field:Ro(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(pv(e.value))return{unaryFilter:{field:Ro(e.field),op:"IS_NOT_NAN"}};if(fv(e.value))return{unaryFilter:{field:Ro(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ro(e.field),op:LR(e.op),value:e.value}}}(n):n instanceof Vt?function(e){const i=e.getFilters().map(r=>lI(r));return i.length===1?i[0]:{compositeFilter:{op:kR(e.op),filters:i}}}(n):rt()}function bR(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function cI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(t,e,i,r,s=ut.min(),a=ut.min(),l=oe.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(t){return new Bi(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(t){this.ct=t}}function DR(n,t){let e;if(t.document)e=rI(n.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const i=et.fromSegments(t.noDocument.path),r=js(t.noDocument.readTime);e=qt.newNoDocument(i,r),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return rt();{const i=et.fromSegments(t.unknownDocument.path),r=js(t.unknownDocument.version);e=qt.newUnknownDocument(i,r)}}return t.readTime&&e.setReadTime(function(r){const s=new Yt(r[0],r[1]);return ut.fromTimestamp(s)}(t.readTime)),e}function bv(n,t){const e=t.key,i={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:rd(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document=function(s,a){return{name:Rl(s,a.key),fields:a.data.value.mapValue.fields,updateTime:fa(s,a.version.toTimestamp()),createTime:fa(s,a.createTime.toTimestamp())}}(n.ct,t);else if(t.isNoDocument())i.noDocument={path:e.path.toArray(),readTime:Us(t.version)};else{if(!t.isUnknownDocument())return rt();i.unknownDocument={path:e.path.toArray(),version:Us(t.version)}}return i}function rd(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function Us(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function js(n){const t=new Yt(n.seconds,n.nanoseconds);return ut.fromTimestamp(t)}function ys(n,t){const e=(t.baseMutations||[]).map(s=>em(n.ct,s));for(let s=0;s<t.mutations.length-1;++s){const a=t.mutations[s];if(s+1<t.mutations.length&&t.mutations[s+1].transform!==void 0){const l=t.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const i=t.mutations.map(s=>em(n.ct,s)),r=Yt.fromMillis(t.localWriteTimeMs);return new I_(t.batchId,r,e,i)}function Bu(n){const t=js(n.readTime),e=n.lastLimboFreeSnapshotVersion!==void 0?js(n.lastLimboFreeSnapshotVersion):ut.min();let i;return i=function(s){return s.documents!==void 0}(n.query)?function(s){return ot(s.documents.length===1),nn(Sa(nI(s.documents[0])))}(n.query):function(s){return nn(aI(s))}(n.query),new Bi(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,oe.fromBase64String(n.resumeToken))}function dI(n,t){const e=Us(t.snapshotVersion),i=Us(t.lastLimboFreeSnapshotVersion);let r;r=ed(t.target)?sI(n.ct,t.target):oI(n.ct,t.target)._t;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Fs(t.target),readTime:e,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function C_(n){const t=aI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?id(t,t.limit,"L"):t}function zf(n,t){return new S_(t.largestBatchId,em(n.ct,t.overlayMutation))}function Dv(n,t){const e=t.path.lastSegment();return[n,en(t.path.popLast()),e]}function Vv(n,t,e,i){return{indexId:n,uid:t,sequenceNumber:e,readTime:Us(i.readTime),documentKey:en(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{getBundleMetadata(t,e){return Mv(t).get(e).next(i=>{if(i)return function(s){return{id:s.bundleId,createTime:js(s.createTime),version:s.version}}(i)})}saveBundleMetadata(t,e){return Mv(t).put(function(r){return{bundleId:r.id,createTime:Us(ce(r.createTime)),version:r.version}}(e))}getNamedQuery(t,e){return Nv(t).get(e).next(i=>{if(i)return function(s){return{name:s.name,query:C_(s.bundledQuery),readTime:js(s.readTime)}}(i)})}saveNamedQuery(t,e){return Nv(t).put(function(r){return{name:r.name,readTime:Us(ce(r.readTime)),bundledQuery:r.bundledQuery}}(e))}}function Mv(n){return Pe(n,"bundles")}function Nv(n){return Pe(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(t,e){this.serializer=t,this.userId=e}static lt(t,e){const i=e.uid||"";return new Md(t,i)}getOverlay(t,e){return xu(t).get(Dv(this.userId,e)).next(i=>i?zf(this.serializer,i):null)}getOverlays(t,e){const i=ci();return U.forEach(e,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,e,i){const r=[];return i.forEach((s,a)=>{const l=new S_(e,a);r.push(this.ht(t,l))}),U.waitFor(r)}removeOverlaysForBatchId(t,e,i){const r=new Set;e.forEach(a=>r.add(en(a.getCollectionPath())));const s=[];return r.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,i+1],!1,!0);s.push(xu(t).j("collectionPathOverlayIndex",l))}),U.waitFor(s)}getOverlaysForCollection(t,e,i){const r=ci(),s=en(e),a=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return xu(t).U("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const f=zf(this.serializer,h);r.set(f.getKey(),f)}return r})}getOverlaysForCollectionGroup(t,e,i,r){const s=ci();let a;const l=IDBKeyRange.bound([this.userId,e,i],[this.userId,e,Number.POSITIVE_INFINITY],!0);return xu(t).J({index:"collectionGroupOverlayIndex",range:l},(h,f,_)=>{const g=zf(this.serializer,f);s.size()<r||g.largestBatchId===a?(s.set(g.getKey(),g),a=g.largestBatchId):_.done()}).next(()=>s)}ht(t,e){return xu(t).put(function(r,s,a){const[l,h,f]=Dv(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Ll(r.ct,a.mutation)}}(this.serializer,this.userId,e))}}function xu(n){return Pe(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{Pt(t){return Pe(t,"globals")}getSessionToken(t){return this.Pt(t).get("sessionToken").next(e=>{const i=e==null?void 0:e.value;return i?oe.fromUint8Array(i):oe.EMPTY_BYTE_STRING})}setSessionToken(t,e){return this.Pt(t).put({name:"sessionToken",value:e.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(){}It(t,e){this.Tt(t,e),e.Et()}Tt(t,e){if("nullValue"in t)this.dt(e,5);else if("booleanValue"in t)this.dt(e,10),e.At(t.booleanValue?1:0);else if("integerValue"in t)this.dt(e,15),e.At(Ht(t.integerValue));else if("doubleValue"in t){const i=Ht(t.doubleValue);isNaN(i)?this.dt(e,13):(this.dt(e,15),Pl(i)?e.At(0):e.At(i))}else if("timestampValue"in t){let i=t.timestampValue;this.dt(e,20),typeof i=="string"&&(i=Hi(i)),e.Rt(`${i.seconds||""}`),e.At(i.nanos||0)}else if("stringValue"in t)this.Vt(t.stringValue,e),this.ft(e);else if("bytesValue"in t)this.dt(e,30),e.gt(zr(t.bytesValue)),this.ft(e);else if("referenceValue"in t)this.yt(t.referenceValue,e);else if("geoPointValue"in t){const i=t.geoPointValue;this.dt(e,45),e.At(i.latitude||0),e.At(i.longitude||0)}else"mapValue"in t?IT(t)?this.dt(e,Number.MAX_SAFE_INTEGER):bd(t)?this.wt(t.mapValue,e):(this.St(t.mapValue,e),this.ft(e)):"arrayValue"in t?(this.bt(t.arrayValue,e),this.ft(e)):rt()}Vt(t,e){this.dt(e,25),this.Dt(t,e)}Dt(t,e){e.Rt(t)}St(t,e){const i=t.fields||{};this.dt(e,55);for(const r of Object.keys(i))this.Vt(r,e),this.Tt(i[r],e)}wt(t,e){var i,r;const s=t.fields||{};this.dt(e,53);const a="value",l=((r=(i=s[a].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(e,15),e.At(Ht(l)),this.Vt(a,e),this.Tt(s[a],e)}bt(t,e){const i=t.values||[];this.dt(e,50);for(const r of i)this.Tt(r,e)}yt(t,e){this.dt(e,37),et.fromName(t).path.forEach(i=>{this.dt(e,60),this.Dt(i,e)})}dt(t,e){t.At(e)}ft(t){t.At(2)}}vs.vt=new vs;function NR(n){if(n===0)return 8;let t=0;return!(n>>4)&&(t+=4,n<<=4),!(n>>6)&&(t+=2,n<<=2),!(n>>7)&&(t+=1),t}function Ov(n){const t=64-function(i){let r=0;for(let s=0;s<8;++s){const a=NR(255&i[s]);if(r+=a,a!==8)break}return r}(n);return Math.ceil(t/8)}class OR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Ft(i.value),i=e.next();this.Mt()}xt(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Ot(i.value),i=e.next();this.Nt()}Lt(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(e<"\uD800"||"\uDBFF"<e)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const r=e.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Bt(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Ot(i);else if(i<2048)this.Ot(960|i>>>6),this.Ot(128|63&i);else if(e<"\uD800"||"\uDBFF"<e)this.Ot(480|i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i);else{const r=e.codePointAt(0);this.Ot(240|r>>>18),this.Ot(128|63&r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r)}}this.Nt()}kt(t){const e=this.qt(t),i=Ov(e);this.Qt(1+i),this.buffer[this.position++]=255&i;for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=255&e[r]}Kt(t){const e=this.qt(t),i=Ov(e);this.Qt(1+i),this.buffer[this.position++]=~(255&i);for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=~(255&e[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(t){this.Qt(t.length),this.buffer.set(t,this.position),this.position+=t.length}zt(){return this.buffer.slice(0,this.position)}qt(t){const e=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(t),i=(128&e[0])!=0;e[0]^=i?255:128;for(let r=1;r<e.length;++r)e[r]^=i?255:0;return e}Ft(t){const e=255&t;e===0?(this.Ut(0),this.Ut(255)):e===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}Ot(t){const e=255&t;e===0?(this.Gt(0),this.Gt(255)):e===255?(this.Gt(255),this.Gt(0)):this.Gt(t)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(t){this.Qt(1),this.buffer[this.position++]=t}Gt(t){this.Qt(1),this.buffer[this.position++]=~t}Qt(t){const e=t+this.position;if(e<=this.buffer.length)return;let i=2*this.buffer.length;i<e&&(i=e);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class FR{constructor(t){this.jt=t}gt(t){this.jt.Ct(t)}Rt(t){this.jt.Lt(t)}At(t){this.jt.kt(t)}Et(){this.jt.$t()}}class BR{constructor(t){this.jt=t}gt(t){this.jt.xt(t)}Rt(t){this.jt.Bt(t)}At(t){this.jt.Kt(t)}Et(){this.jt.Wt()}}class Cu{constructor(){this.jt=new OR,this.Ht=new FR(this.jt),this.Jt=new BR(this.jt)}seed(t){this.jt.seed(t)}Yt(t){return t===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(t,e,i,r){this.indexId=t,this.documentKey=e,this.arrayValue=i,this.directionalValue=r}Zt(){const t=this.directionalValue.length,e=t===0||this.directionalValue[t-1]===255?t+1:t,i=new Uint8Array(e);return i.set(this.directionalValue,0),e!==t?i.set([0],this.directionalValue.length):++i[i.length-1],new ws(this.indexId,this.documentKey,this.arrayValue,i)}}function fr(n,t){let e=n.indexId-t.indexId;return e!==0?e:(e=Fv(n.arrayValue,t.arrayValue),e!==0?e:(e=Fv(n.directionalValue,t.directionalValue),e!==0?e:et.comparator(n.documentKey,t.documentKey)))}function Fv(n,t){for(let e=0;e<n.length&&e<t.length;++e){const i=n[e]-t[e];if(i!==0)return i}return n.length-t.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(t){this.Xt=new Ot((e,i)=>Zt.comparator(e.field,i.field)),this.collectionId=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment(),this.en=t.orderBy,this.tn=[];for(const e of t.filters){const i=e;i.isInequality()?this.Xt=this.Xt.add(i):this.tn.push(i)}}get nn(){return this.Xt.size>1}rn(t){if(ot(t.collectionGroup===this.collectionId),this.nn)return!1;const e=qp(t);if(e!==void 0&&!this.sn(e))return!1;const i=_s(t);let r=new Set,s=0,a=0;for(;s<i.length&&this.sn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!r.has(l.field.canonicalString())){const h=i[s];if(!this.on(l,h)||!this._n(this.en[a++],h))return!1}++s}for(;s<i.length;++s){const l=i[s];if(a>=this.en.length||!this._n(this.en[a++],l))return!1}return!0}an(){if(this.nn)return null;let t=new Ot(Zt.comparator);const e=[];for(const i of this.tn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")e.push(new vh(i.field,2));else{if(t.has(i.field))continue;t=t.add(i.field),e.push(new vh(i.field,0))}for(const i of this.en)i.field.isKeyField()||t.has(i.field)||(t=t.add(i.field),e.push(new vh(i.field,i.dir==="asc"?0:1)));return new td(td.UNKNOWN_ID,this.collectionId,e,Il.empty())}sn(t){for(const e of this.tn)if(this.on(e,t))return!0;return!1}on(t,e){if(t===void 0||!t.field.isEqual(e.fieldPath))return!1;const i=t.op==="array-contains"||t.op==="array-contains-any";return e.kind===2===i}_n(t,e){return!!t.field.isEqual(e.fieldPath)&&(e.kind===0&&t.dir==="asc"||e.kind===1&&t.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(n){var t,e;if(ot(n instanceof St||n instanceof Vt),n instanceof St){if(n instanceof bT){const r=((e=(t=n.value.arrayValue)===null||t===void 0?void 0:t.values)===null||e===void 0?void 0:e.map(s=>St.create(n.field,"==",s)))||[];return Vt.create(r,"or")}return n}const i=n.filters.map(r=>fI(r));return Vt.create(i,n.op)}function zR(n){if(n.getFilters().length===0)return[];const t=rm(fI(n));return ot(pI(t)),nm(t)||im(t)?[t]:t.getFilters()}function nm(n){return n instanceof St}function im(n){return n instanceof Vt&&y_(n)}function pI(n){return nm(n)||im(n)||function(e){if(e instanceof Vt&&Kp(e)){for(const i of e.getFilters())if(!nm(i)&&!im(i))return!1;return!0}return!1}(n)}function rm(n){if(ot(n instanceof St||n instanceof Vt),n instanceof St)return n;if(n.filters.length===1)return rm(n.filters[0]);const t=n.filters.map(i=>rm(i));let e=Vt.create(t,n.op);return e=sd(e),pI(e)?e:(ot(e instanceof Vt),ot(ca(e)),ot(e.filters.length>1),e.filters.reduce((i,r)=>R_(i,r)))}function R_(n,t){let e;return ot(n instanceof St||n instanceof Vt),ot(t instanceof St||t instanceof Vt),e=n instanceof St?t instanceof St?function(r,s){return Vt.create([r,s],"and")}(n,t):zv(n,t):t instanceof St?zv(t,n):function(r,s){if(ot(r.filters.length>0&&s.filters.length>0),ca(r)&&ca(s))return RT(r,s.getFilters());const a=Kp(r)?r:s,l=Kp(r)?s:r,h=a.filters.map(f=>R_(f,l));return Vt.create(h,"or")}(n,t),sd(e)}function zv(n,t){if(ca(t))return RT(t,n.getFilters());{const e=t.filters.map(i=>R_(n,i));return Vt.create(e,"or")}}function sd(n){if(ot(n instanceof St||n instanceof Vt),n instanceof St)return n;const t=n.getFilters();if(t.length===1)return sd(t[0]);if(xT(n))return n;const e=t.map(r=>sd(r)),i=[];return e.forEach(r=>{r instanceof St?i.push(r):r instanceof Vt&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:Vt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(){this.un=new L_}addToCollectionParentIndex(t,e){return this.un.add(e),U.resolve()}getCollectionParents(t,e){return U.resolve(this.un.getEntries(e))}addFieldIndex(t,e){return U.resolve()}deleteFieldIndex(t,e){return U.resolve()}deleteAllFieldIndexes(t){return U.resolve()}createTargetIndexes(t,e){return U.resolve()}getDocumentsMatchingTarget(t,e){return U.resolve(null)}getIndexType(t,e){return U.resolve(0)}getFieldIndexes(t,e){return U.resolve([])}getNextCollectionGroupToUpdate(t){return U.resolve(null)}getMinOffset(t,e){return U.resolve(In.min())}getMinOffsetFromCollectionGroup(t,e){return U.resolve(In.min())}updateCollectionGroup(t,e,i){return U.resolve()}updateIndexEntries(t,e){return U.resolve()}}class L_{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e]||new Ot(Pt.comparator),s=!r.has(i);return this.index[e]=r.add(i),s}has(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e];return r&&r.has(i)}getEntries(t){return(this.index[t]||new Ot(Pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nh=new Uint8Array(0);class jR{constructor(t,e){this.databaseId=e,this.cn=new L_,this.ln=new Xr(i=>Fs(i),(i,r)=>$l(i,r)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.cn.has(e)){const i=e.lastSegment(),r=e.popLast();t.addOnCommittedListener(()=>{this.cn.add(e)});const s={collectionId:i,parent:en(r)};return Uv(t).put(s)}return U.resolve()}getCollectionParents(t,e){const i=[],r=IDBKeyRange.bound([e,""],[cT(e),""],!1,!0);return Uv(t).U(r).next(s=>{for(const a of s){if(a.collectionId!==e)break;i.push(li(a.parent))}return i})}addFieldIndex(t,e){const i=Ru(t),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(e);delete r.indexId;const s=i.add(r);if(e.indexState){const a=So(t);return s.next(l=>{a.put(Vv(l,this.uid,e.indexState.sequenceNumber,e.indexState.offset))})}return s.next()}deleteFieldIndex(t,e){const i=Ru(t),r=So(t),s=Po(t);return i.delete(e.indexId).next(()=>r.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}deleteAllFieldIndexes(t){const e=Ru(t),i=Po(t),r=So(t);return e.j().next(()=>i.j()).next(()=>r.j())}createTargetIndexes(t,e){return U.forEach(this.hn(e),i=>this.getIndexType(t,i).next(r=>{if(r===0||r===1){const s=new Bv(i).an();if(s!=null)return this.addFieldIndex(t,s)}}))}getDocumentsMatchingTarget(t,e){const i=Po(t);let r=!0;const s=new Map;return U.forEach(this.hn(e),a=>this.Pn(t,a).next(l=>{r&&(r=!!l),s.set(a,l)})).next(()=>{if(r){let a=yt();const l=[];return U.forEach(s,(h,f)=>{Q("IndexedDbIndexManager",`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(h)} to execute ${Fs(e)}`);const _=function(C,j){const H=qp(j);if(H===void 0)return null;for(const Y of nd(C,H.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(f,h),g=function(C,j){const H=new Map;for(const Y of _s(j))for(const k of nd(C,Y.fieldPath))switch(k.op){case"==":case"in":H.set(Y.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return H.set(Y.fieldPath.canonicalString(),k.value),Array.from(H.values())}return null}(f,h),w=function(C,j){const H=[];let Y=!0;for(const k of _s(j)){const P=k.kind===0?vv(C,k.fieldPath,C.startAt):wv(C,k.fieldPath,C.startAt);H.push(P.value),Y&&(Y=P.inclusive)}return new $r(H,Y)}(f,h),E=function(C,j){const H=[];let Y=!0;for(const k of _s(j)){const P=k.kind===0?wv(C,k.fieldPath,C.endAt):vv(C,k.fieldPath,C.endAt);H.push(P.value),Y&&(Y=P.inclusive)}return new $r(H,Y)}(f,h),x=this.In(h,f,w),R=this.In(h,f,E),z=this.Tn(h,f,g),A=this.En(h.indexId,_,x,w.inclusive,R,E.inclusive,z);return U.forEach(A,S=>i.G(S,e.limit).next(C=>{C.forEach(j=>{const H=et.fromSegments(j.documentKey);a.has(H)||(a=a.add(H),l.push(H))})}))}).next(()=>l)}return U.resolve(null)})}hn(t){let e=this.ln.get(t);return e||(t.filters.length===0?e=[t]:e=zR(Vt.create(t.filters,"and")).map(i=>Qp(t.path,t.collectionGroup,t.orderBy,i.getFilters(),t.limit,t.startAt,t.endAt)),this.ln.set(t,e),e)}En(t,e,i,r,s,a,l){const h=(e!=null?e.length:1)*Math.max(i.length,s.length),f=h/(e!=null?e.length:1),_=[];for(let g=0;g<h;++g){const w=e?this.dn(e[g/f]):nh,E=this.An(t,w,i[g%f],r),x=this.Rn(t,w,s[g%f],a),R=l.map(z=>this.An(t,w,z,!0));_.push(...this.createRange(E,x,R))}return _}An(t,e,i,r){const s=new ws(t,et.empty(),e,i);return r?s:s.Zt()}Rn(t,e,i,r){const s=new ws(t,et.empty(),e,i);return r?s.Zt():s}Pn(t,e){const i=new Bv(e),r=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,r).next(s=>{let a=null;for(const l of s)i.rn(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(t,e){let i=2;const r=this.hn(e);return U.forEach(r,s=>this.Pn(t,s).next(a=>{a?i!==0&&a.fields.length<function(h){let f=new Ot(Zt.comparator),_=!1;for(const g of h.filters)for(const w of g.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?_=!0:f=f.add(w.field));for(const g of h.orderBy)g.field.isKeyField()||(f=f.add(g.field));return f.size+(_?1:0)}(s)&&(i=1):i=0})).next(()=>function(a){return a.limit!==null}(e)&&r.length>1&&i===2?1:i)}Vn(t,e){const i=new Cu;for(const r of _s(t)){const s=e.data.field(r.fieldPath);if(s==null)return null;const a=i.Yt(r.kind);vs.vt.It(s,a)}return i.zt()}dn(t){const e=new Cu;return vs.vt.It(t,e.Yt(0)),e.zt()}mn(t,e){const i=new Cu;return vs.vt.It(Os(this.databaseId,e),i.Yt(function(s){const a=_s(s);return a.length===0?0:a[a.length-1].kind}(t))),i.zt()}Tn(t,e,i){if(i===null)return[];let r=[];r.push(new Cu);let s=0;for(const a of _s(t)){const l=i[s++];for(const h of r)if(this.fn(e,a.fieldPath)&&xl(l))r=this.gn(r,a,l);else{const f=h.Yt(a.kind);vs.vt.It(l,f)}}return this.pn(r)}In(t,e,i){return this.Tn(t,e,i.position)}pn(t){const e=[];for(let i=0;i<t.length;++i)e[i]=t[i].zt();return e}gn(t,e,i){const r=[...t],s=[];for(const a of i.arrayValue.values||[])for(const l of r){const h=new Cu;h.seed(l.zt()),vs.vt.It(a,h.Yt(e.kind)),s.push(h)}return s}fn(t,e){return!!t.filters.find(i=>i instanceof St&&i.field.isEqual(e)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(t,e){const i=Ru(t),r=So(t);return(e?i.U("collectionGroupIndex",IDBKeyRange.bound(e,e)):i.U()).next(s=>{const a=[];return U.forEach(s,l=>r.get([l.indexId,this.uid]).next(h=>{a.push(function(_,g){const w=g?new Il(g.sequenceNumber,new In(js(g.readTime),new et(li(g.documentKey)),g.largestBatchId)):Il.empty(),E=_.fields.map(([x,R])=>new vh(Zt.fromServerFormat(x),R));return new td(_.indexId,_.collectionGroup,E,w)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(e=>e.length===0?null:(e.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:_t(i.collectionGroup,r.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(t,e,i){const r=Ru(t),s=So(t);return this.yn(t).next(a=>r.U("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(l=>U.forEach(l,h=>s.put(Vv(h.indexId,this.uid,a,i)))))}updateIndexEntries(t,e){const i=new Map;return U.forEach(e,(r,s)=>{const a=i.get(r.collectionGroup);return(a?U.resolve(a):this.getFieldIndexes(t,r.collectionGroup)).next(l=>(i.set(r.collectionGroup,l),U.forEach(l,h=>this.wn(t,r,h).next(f=>{const _=this.Sn(s,h);return f.isEqual(_)?U.resolve():this.bn(t,s,h,f,_)}))))})}Dn(t,e,i,r){return Po(t).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(i,e.key),documentKey:e.key.path.toArray()})}vn(t,e,i,r){return Po(t).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(i,e.key),e.key.path.toArray()])}wn(t,e,i){const r=Po(t);let s=new Ot(fr);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.mn(i,e)])},(a,l)=>{s=s.add(new ws(i.indexId,e,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(t,e){let i=new Ot(fr);const r=this.Vn(e,t);if(r==null)return i;const s=qp(e);if(s!=null){const a=t.data.field(s.fieldPath);if(xl(a))for(const l of a.arrayValue.values||[])i=i.add(new ws(e.indexId,t.key,this.dn(l),r))}else i=i.add(new ws(e.indexId,t.key,nh,r));return i}bn(t,e,i,r,s){Q("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);const a=[];return function(h,f,_,g,w){const E=h.getIterator(),x=f.getIterator();let R=Io(E),z=Io(x);for(;R||z;){let A=!1,S=!1;if(R&&z){const C=_(R,z);C<0?S=!0:C>0&&(A=!0)}else R!=null?S=!0:A=!0;A?(g(z),z=Io(x)):S?(w(R),R=Io(E)):(R=Io(E),z=Io(x))}}(r,s,fr,l=>{a.push(this.Dn(t,e,i,l))},l=>{a.push(this.vn(t,e,i,l))}),U.waitFor(a)}yn(t){let e=1;return So(t).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),e=r.sequenceNumber+1}).next(()=>e)}createRange(t,e,i){i=i.sort((a,l)=>fr(a,l)).filter((a,l,h)=>!l||fr(a,h[l-1])!==0);const r=[];r.push(t);for(const a of i){const l=fr(a,t),h=fr(a,e);if(l===0)r[0]=t.Zt();else if(l>0&&h<0)r.push(a),r.push(a.Zt());else if(h>0)break}r.push(e);const s=[];for(let a=0;a<r.length;a+=2){if(this.Cn(r[a],r[a+1]))return[];const l=[r[a].indexId,this.uid,r[a].arrayValue,r[a].directionalValue,nh,[]],h=[r[a+1].indexId,this.uid,r[a+1].arrayValue,r[a+1].directionalValue,nh,[]];s.push(IDBKeyRange.bound(l,h))}return s}Cn(t,e){return fr(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(jv)}getMinOffset(t,e){return U.mapArray(this.hn(e),i=>this.Pn(t,i).next(r=>r||rt())).next(jv)}}function Uv(n){return Pe(n,"collectionParents")}function Po(n){return Pe(n,"indexEntries")}function Ru(n){return Pe(n,"indexConfiguration")}function So(n){return Pe(n,"indexState")}function jv(n){ot(n.length!==0);let t=n[0].indexState.offset,e=t.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;p_(r,t)<0&&(t=r),e<r.largestBatchId&&(e=r.largestBatchId)}return new In(t.readTime,t.documentKey,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class un{constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}static withCacheSize(t){return new un(t,un.DEFAULT_COLLECTION_PERCENTILE,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(n,t,e){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],a=IDBKeyRange.only(e.batchId);let l=0;const h=i.J({range:a},(_,g,w)=>(l++,w.delete()));s.push(h.next(()=>{ot(l===1)}));const f=[];for(const _ of e.mutations){const g=gT(t,_.key.path,e.batchId);s.push(r.delete(g)),f.push(_.key)}return U.waitFor(s).next(()=>f)}function od(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw rt();t=n.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */un.DEFAULT_COLLECTION_PERCENTILE=10,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,un.DEFAULT=new un(41943040,un.DEFAULT_COLLECTION_PERCENTILE,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),un.DISABLED=new un(-1,0,0);class Nd{constructor(t,e,i,r){this.userId=t,this.serializer=e,this.indexManager=i,this.referenceDelegate=r,this.Fn={}}static lt(t,e,i,r){ot(t.uid!=="");const s=t.isAuthenticated()?t.uid:"";return new Nd(s,e,i,r)}checkEmpty(t){let e=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pr(t).J({index:"userMutationsIndex",range:i},(r,s,a)=>{e=!1,a.done()}).next(()=>e)}addMutationBatch(t,e,i,r){const s=ko(t),a=pr(t);return a.add({}).next(l=>{ot(typeof l=="number");const h=new I_(l,e,i,r),f=function(E,x,R){const z=R.baseMutations.map(S=>Ll(E.ct,S)),A=R.mutations.map(S=>Ll(E.ct,S));return{userId:x,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:z,mutations:A}}(this.serializer,this.userId,h),_=[];let g=new Ot((w,E)=>_t(w.canonicalString(),E.canonicalString()));for(const w of r){const E=gT(this.userId,w.key.path,l);g=g.add(w.key.path.popLast()),_.push(a.put(f)),_.push(s.put(E,CC))}return g.forEach(w=>{_.push(this.indexManager.addToCollectionParentIndex(t,w))}),t.addOnCommittedListener(()=>{this.Fn[l]=h.keys()}),U.waitFor(_).next(()=>h)})}lookupMutationBatch(t,e){return pr(t).get(e).next(i=>i?(ot(i.userId===this.userId),ys(this.serializer,i)):null)}Mn(t,e){return this.Fn[e]?U.resolve(this.Fn[e]):this.lookupMutationBatch(t,e).next(i=>{if(i){const r=i.keys();return this.Fn[e]=r,r}return null})}getNextMutationBatchAfterBatchId(t,e){const i=e+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return pr(t).J({index:"userMutationsIndex",range:r},(a,l,h)=>{l.userId===this.userId&&(ot(l.batchId>=i),s=ys(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return pr(t).J({index:"userMutationsIndex",range:e,reverse:!0},(r,s,a)=>{i=s.batchId,a.done()}).next(()=>i)}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return pr(t).U("userMutationsIndex",e).next(i=>i.map(r=>ys(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(t,e){const i=wh(this.userId,e.path),r=IDBKeyRange.lowerBound(i),s=[];return ko(t).J({range:r},(a,l,h)=>{const[f,_,g]=a,w=li(_);if(f===this.userId&&e.path.isEqual(w))return pr(t).get(g).next(E=>{if(!E)throw rt();ot(E.userId===this.userId),s.push(ys(this.serializer,E))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Ot(_t);const r=[];return e.forEach(s=>{const a=wh(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=ko(t).J({range:l},(f,_,g)=>{const[w,E,x]=f,R=li(E);w===this.userId&&s.path.isEqual(R)?i=i.add(x):g.done()});r.push(h)}),U.waitFor(r).next(()=>this.xn(t,i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1,s=wh(this.userId,i),a=IDBKeyRange.lowerBound(s);let l=new Ot(_t);return ko(t).J({range:a},(h,f,_)=>{const[g,w,E]=h,x=li(w);g===this.userId&&i.isPrefixOf(x)?x.length===r&&(l=l.add(E)):_.done()}).next(()=>this.xn(t,l))}xn(t,e){const i=[],r=[];return e.forEach(s=>{r.push(pr(t).get(s).next(a=>{if(a===null)throw rt();ot(a.userId===this.userId),i.push(ys(this.serializer,a))}))}),U.waitFor(r).next(()=>i)}removeMutationBatch(t,e){return mI(t._e,this.userId,e).next(i=>(t.addOnCommittedListener(()=>{this.On(e.batchId)}),U.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(t,r))))}On(t){delete this.Fn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return U.resolve();const i=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),r=[];return ko(t).J({range:i},(s,a,l)=>{if(s[0]===this.userId){const h=li(s[1]);r.push(h)}else l.done()}).next(()=>{ot(r.length===0)})})}containsKey(t,e){return _I(t,this.userId,e)}Nn(t){return gI(t).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function _I(n,t,e){const i=wh(t,e.path),r=i[1],s=IDBKeyRange.lowerBound(i);let a=!1;return ko(n).J({range:s,H:!0},(l,h,f)=>{const[_,g,w]=l;_===t&&g===r&&(a=!0),f.done()}).next(()=>a)}function pr(n){return Pe(n,"mutations")}function ko(n){return Pe(n,"documentMutations")}function gI(n){return Pe(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new $s(0)}static kn(){return new $s(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.qn(t).next(e=>{const i=new $s(e.highestTargetId);return e.highestTargetId=i.next(),this.Qn(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.qn(t).next(e=>ut.fromTimestamp(new Yt(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.qn(t).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,e,i){return this.qn(t).next(r=>(r.highestListenSequenceNumber=e,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.Qn(t,r)))}addTargetData(t,e){return this.Kn(t,e).next(()=>this.qn(t).next(i=>(i.targetCount+=1,this.$n(e,i),this.Qn(t,i))))}updateTargetData(t,e){return this.Kn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>Ao(t).delete(e.targetId)).next(()=>this.qn(t)).next(i=>(ot(i.targetCount>0),i.targetCount-=1,this.Qn(t,i)))}removeTargets(t,e,i){let r=0;const s=[];return Ao(t).J((a,l)=>{const h=Bu(l);h.sequenceNumber<=e&&i.get(h.targetId)===null&&(r++,s.push(this.removeTargetData(t,h)))}).next(()=>U.waitFor(s)).next(()=>r)}forEachTarget(t,e){return Ao(t).J((i,r)=>{const s=Bu(r);e(s)})}qn(t){return qv(t).get("targetGlobalKey").next(e=>(ot(e!==null),e))}Qn(t,e){return qv(t).put("targetGlobalKey",e)}Kn(t,e){return Ao(t).put(dI(this.serializer,e))}$n(t,e){let i=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,i=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,i=!0),i}getTargetCount(t){return this.qn(t).next(e=>e.targetCount)}getTargetData(t,e){const i=Fs(e),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Ao(t).J({range:r,index:"queryTargetsIndex"},(a,l,h)=>{const f=Bu(l);$l(e,f.target)&&(s=f,h.done())}).next(()=>s)}addMatchingKeys(t,e,i){const r=[],s=wr(t);return e.forEach(a=>{const l=en(a.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(t,i,a))}),U.waitFor(r)}removeMatchingKeys(t,e,i){const r=wr(t);return U.forEach(e,s=>{const a=en(s.path);return U.waitFor([r.delete([i,a]),this.referenceDelegate.removeReference(t,i,s)])})}removeMatchingKeysForTargetId(t,e){const i=wr(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(t,e){const i=IDBKeyRange.bound([e],[e+1],!1,!0),r=wr(t);let s=yt();return r.J({range:i,H:!0},(a,l,h)=>{const f=li(a[1]),_=new et(f);s=s.add(_)}).next(()=>s)}containsKey(t,e){const i=en(e.path),r=IDBKeyRange.bound([i],[cT(i)],!1,!0);let s=0;return wr(t).J({index:"documentTargetsIndex",H:!0,range:r},([a,l],h,f)=>{a!==0&&(s++,f.done())}).next(()=>s>0)}ot(t,e){return Ao(t).get(e).next(i=>i?Bu(i):null)}}function Ao(n){return Pe(n,"targets")}function qv(n){return Pe(n,"targetGlobal")}function wr(n){return Pe(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv([n,t],[e,i]){const r=_t(n,e);return r===0?_t(t,i):r}class qR{constructor(t){this.Un=t,this.buffer=new Ot(Gv),this.Wn=0}Gn(){return++this.Wn}zn(t){const e=[t,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();Gv(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class GR{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(t){Q("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Yr(e)?Q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await Qr(e)}await this.Hn(3e5)})}}class WR{constructor(t,e){this.Jn=t,this.params=e}calculateTargetCount(t,e){return this.Jn.Yn(t).next(i=>Math.floor(e/100*i))}nthSequenceNumber(t,e){if(e===0)return U.resolve(hn.oe);const i=new qR(e);return this.Jn.forEachTarget(t,r=>i.zn(r.sequenceNumber)).next(()=>this.Jn.Zn(t,r=>i.zn(r))).next(()=>i.maxValue)}removeTargets(t,e,i){return this.Jn.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.Jn.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve($v)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$v):this.Xn(t,e))}getCacheSize(t){return this.Jn.getCacheSize(t)}Xn(t,e){let i,r,s,a,l,h,f;const _=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,a=Date.now(),this.nthSequenceNumber(t,r))).next(g=>(i=g,l=Date.now(),this.removeTargets(t,i,e))).next(g=>(s=g,h=Date.now(),this.removeOrphanedDocuments(t,i))).next(g=>(f=Date.now(),xo()<=xt.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${r} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${g} documents in `+(f-h)+`ms
Total Duration: ${f-_}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g})))}}function HR(n,t){return new WR(n,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(t,e){this.db=t,this.garbageCollector=HR(this,e)}Yn(t){const e=this.er(t);return this.db.getTargetCache().getTargetCount(t).next(i=>e.next(r=>i+r))}er(t){let e=0;return this.Zn(t,i=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Zn(t,e){return this.tr(t,(i,r)=>e(r))}addReference(t,e,i){return ih(t,i)}removeReference(t,e,i){return ih(t,i)}removeTargets(t,e,i){return this.db.getTargetCache().removeTargets(t,e,i)}markPotentiallyOrphaned(t,e){return ih(t,e)}nr(t,e){return function(r,s){let a=!1;return gI(r).Y(l=>_I(r,l,s).next(h=>(h&&(a=!0),U.resolve(!h)))).next(()=>a)}(t,e)}removeOrphanedDocuments(t,e){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.tr(t,(a,l)=>{if(l<=e){const h=this.nr(t,a).next(f=>{if(!f)return s++,i.getEntry(t,a).next(()=>(i.removeEntry(a,ut.min()),wr(t).delete(function(g){return[0,en(g.path)]}(a))))});r.push(h)}}).next(()=>U.waitFor(r)).next(()=>i.apply(t)).next(()=>s)}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,i)}updateLimboDocument(t,e){return ih(t,e)}tr(t,e){const i=wr(t);let r,s=hn.oe;return i.J({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:f})=>{a===0?(s!==hn.oe&&e(new et(li(r)),s),s=f,r=h):s=hn.oe}).next(()=>{s!==hn.oe&&e(new et(li(r)),s)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function ih(n,t){return wr(n).put(function(i,r){return{targetId:0,path:en(i.path),sequenceNumber:r}}(t,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(){this.changes=new Xr(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,qt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?U.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,i){return ds(t).put(i)}removeEntry(t,e,i){return ds(t).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],rd(a),l[l.length-1]]}(e,i))}updateMetadata(t,e){return this.getMetadata(t).next(i=>(i.byteSize+=e,this.rr(t,i)))}getEntry(t,e){let i=qt.newInvalidDocument(e);return ds(t).J({index:"documentKeyIndex",range:IDBKeyRange.only(Lu(e))},(r,s)=>{i=this.ir(e,s)}).next(()=>i)}sr(t,e){let i={size:0,document:qt.newInvalidDocument(e)};return ds(t).J({index:"documentKeyIndex",range:IDBKeyRange.only(Lu(e))},(r,s)=>{i={document:this.ir(e,s),size:od(s)}}).next(()=>i)}getEntries(t,e){let i=fn();return this._r(t,e,(r,s)=>{const a=this.ir(r,s);i=i.insert(r,a)}).next(()=>i)}ar(t,e){let i=fn(),r=new Ut(et.comparator);return this._r(t,e,(s,a)=>{const l=this.ir(s,a);i=i.insert(s,l),r=r.insert(s,od(a))}).next(()=>({documents:i,ur:r}))}_r(t,e,i){if(e.isEmpty())return U.resolve();let r=new Ot(Kv);e.forEach(h=>r=r.add(h));const s=IDBKeyRange.bound(Lu(r.first()),Lu(r.last())),a=r.getIterator();let l=a.getNext();return ds(t).J({index:"documentKeyIndex",range:s},(h,f,_)=>{const g=et.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&Kv(l,g)<0;)i(l,null),l=a.getNext();l&&l.isEqual(g)&&(i(l,f),l=a.hasNext()?a.getNext():null),l?_.$(Lu(l)):_.done()}).next(()=>{for(;l;)i(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(t,e,i,r,s){const a=e.path,l=[a.popLast().toArray(),a.lastSegment(),rd(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ds(t).U(IDBKeyRange.bound(l,h,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let _=fn();for(const g of f){const w=this.ir(et.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);w.isFoundDocument()&&(Gl(e,w)||r.has(w.key))&&(_=_.insert(w.key,w))}return _})}getAllFromCollectionGroup(t,e,i,r){let s=fn();const a=Hv(e,i),l=Hv(e,In.max());return ds(t).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,f,_)=>{const g=this.ir(et.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(g.key,g),s.size===r&&_.done()}).next(()=>s)}newChangeBuffer(t){return new QR(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(e=>e.byteSize)}getMetadata(t){return Wv(t).get("remoteDocumentGlobalKey").next(e=>(ot(!!e),e))}rr(t,e){return Wv(t).put("remoteDocumentGlobalKey",e)}ir(t,e){if(e){const i=DR(this.serializer,e);if(!(i.isNoDocument()&&i.version.isEqual(ut.min())))return i}return qt.newInvalidDocument(t)}}function vI(n){return new ZR(n)}class QR extends yI{constructor(t,e){super(),this.cr=t,this.trackRemovals=e,this.lr=new Xr(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(t){const e=[];let i=0,r=new Ot((s,a)=>_t(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.lr.get(s);if(e.push(this.cr.removeEntry(t,s,l.readTime)),a.isValidDocument()){const h=bv(this.cr.serializer,a);r=r.add(s.path.popLast());const f=od(h);i+=f-l.size,e.push(this.cr.addEntry(t,s,h))}else if(i-=l.size,this.trackRemovals){const h=bv(this.cr.serializer,a.convertToNoDocument(ut.min()));e.push(this.cr.addEntry(t,s,h))}}),r.forEach(s=>{e.push(this.cr.indexManager.addToCollectionParentIndex(t,s))}),e.push(this.cr.updateMetadata(t,i)),U.waitFor(e)}getFromCache(t,e){return this.cr.sr(t,e).next(i=>(this.lr.set(e,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(t,e){return this.cr.ar(t,e).next(({documents:i,ur:r})=>(r.forEach((s,a)=>{this.lr.set(s,{size:a,readTime:i.get(s).readTime})}),i))}}function Wv(n){return Pe(n,"remoteDocumentGlobal")}function ds(n){return Pe(n,"remoteDocumentsV14")}function Lu(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Hv(n,t){const e=t.documentKey.path.toArray();return[n,rd(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function Kv(n,t){const e=n.path.toArray(),i=t.path.toArray();let r=0;for(let s=0;s<e.length-2&&s<i.length-2;++s)if(r=_t(e[s],i[s]),r)return r;return r=_t(e.length,i.length),r||(r=_t(e[e.length-2],i[i.length-2]),r||_t(e[e.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(t,e,i,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,e))).next(r=>(i!==null&&Xu(i.mutation,r,dn.empty(),Yt.now()),r))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,yt()).next(()=>i))}getLocalViewOfDocuments(t,e,i=yt()){const r=ci();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,i).next(s=>{let a=Ou();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(t,e){const i=ci();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,yt()))}populateOverlays(t,e,i){const r=[];return i.forEach(s=>{e.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(t,r).next(s=>{s.forEach((a,l)=>{e.set(a,l)})})}computeViews(t,e,i,r){let s=fn();const a=Yu(),l=function(){return Yu()}();return e.forEach((h,f)=>{const _=i.get(f.key);r.has(f.key)&&(_===void 0||_.mutation instanceof Yi)?s=s.insert(f.key,f):_!==void 0?(a.set(f.key,_.mutation.getFieldMask()),Xu(_.mutation,f,_.mutation.getFieldMask(),Yt.now())):a.set(f.key,dn.empty())}),this.recalculateAndSaveOverlays(t,s).next(h=>(h.forEach((f,_)=>a.set(f,_)),e.forEach((f,_)=>{var g;return l.set(f,new YR(_,(g=a.get(f))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(t,e){const i=Yu();let r=new Ut((a,l)=>a-l),s=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(a=>{for(const l of a)l.keys().forEach(h=>{const f=e.get(h);if(f===null)return;let _=i.get(h)||dn.empty();_=l.applyToLocalView(f,_),i.set(h,_);const g=(r.get(l.batchId)||yt()).add(h);r=r.insert(l.batchId,g)})}).next(()=>{const a=[],l=r.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,_=h.value,g=BT();_.forEach(w=>{if(!s.has(w)){const E=WT(e.get(w),i.get(w));E!==null&&g.set(w,E),s=s.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(t,f,g))}return U.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i,r){return function(a){return et.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):v_(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,r):this.getDocumentsMatchingCollectionQuery(t,e,i,r)}getNextDocuments(t,e,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,r).next(s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,r-s.size):U.resolve(ci());let l=-1,h=s;return a.next(f=>U.forEach(f,(_,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),s.get(_)?U.resolve():this.remoteDocumentCache.getEntry(t,_).next(w=>{h=h.insert(_,w)}))).next(()=>this.populateOverlays(t,f,s)).next(()=>this.computeViews(t,h,f,yt())).next(_=>({batchId:l,changes:FT(_)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new et(e)).next(i=>{let r=Ou();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,e,i,r){const s=e.collectionGroup;let a=Ou();return this.indexManager.getCollectionParents(t,s).next(l=>U.forEach(l,h=>{const f=function(g,w){return new Qi(w,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(e,h.child(s));return this.getDocumentsMatchingCollectionQuery(t,f,i,r).next(_=>{_.forEach((g,w)=>{a=a.insert(g,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,e,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,s,r))).next(a=>{s.forEach((h,f)=>{const _=f.getKey();a.get(_)===null&&(a=a.insert(_,qt.newInvalidDocument(_)))});let l=Ou();return a.forEach((h,f)=>{const _=s.get(h);_!==void 0&&Xu(_.mutation,f,dn.empty(),Yt.now()),Gl(e,f)&&(l=l.insert(h,f))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,e){return U.resolve(this.hr.get(e))}saveBundleMetadata(t,e){return this.hr.set(e.id,function(r){return{id:r.id,version:r.version,createTime:ce(r.createTime)}}(e)),U.resolve()}getNamedQuery(t,e){return U.resolve(this.Pr.get(e))}saveNamedQuery(t,e){return this.Pr.set(e.name,function(r){return{name:r.name,query:C_(r.bundledQuery),readTime:ce(r.readTime)}}(e)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(){this.overlays=new Ut(et.comparator),this.Ir=new Map}getOverlay(t,e){return U.resolve(this.overlays.get(e))}getOverlays(t,e){const i=ci();return U.forEach(e,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((r,s)=>{this.ht(t,e,s)}),U.resolve()}removeOverlaysForBatchId(t,e,i){const r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),U.resolve()}getOverlaysForCollection(t,e,i){const r=ci(),s=e.length+1,a=new et(e.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!e.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>i&&r.set(h.getKey(),h)}return U.resolve(r)}getOverlaysForCollectionGroup(t,e,i,r){let s=new Ut((f,_)=>f-_);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===e&&f.largestBatchId>i){let _=s.get(f.largestBatchId);_===null&&(_=ci(),s=s.insert(f.largestBatchId,_)),_.set(f.getKey(),f)}}const l=ci(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,_)=>l.set(f,_)),!(l.size()>=r)););return U.resolve(l)}ht(t,e,i){const r=this.overlays.get(i.key);if(r!==null){const a=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new S_(e,i));let s=this.Ir.get(e);s===void 0&&(s=yt(),this.Ir.set(e,s)),this.Ir.set(e,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this.sessionToken=oe.EMPTY_BYTE_STRING}getSessionToken(t){return U.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(){this.Tr=new Ot(Re.Er),this.dr=new Ot(Re.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,e){const i=new Re(t,e);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.Vr(new Re(t,e))}mr(t,e){t.forEach(i=>this.removeReference(i,e))}gr(t){const e=new et(new Pt([])),i=new Re(e,t),r=new Re(e,t+1),s=[];return this.dr.forEachInRange([i,r],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const e=new et(new Pt([])),i=new Re(e,t),r=new Re(e,t+1);let s=yt();return this.dr.forEachInRange([i,r],a=>{s=s.add(a.key)}),s}containsKey(t){const e=new Re(t,0),i=this.Tr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class Re{constructor(t,e){this.key=t,this.wr=e}static Er(t,e){return et.comparator(t.key,e.key)||_t(t.wr,e.wr)}static Ar(t,e){return _t(t.wr,e.wr)||et.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Sr=1,this.br=new Ot(Re.Er)}checkEmpty(t){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,r){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new I_(s,e,i,r);this.mutationQueue.push(a);for(const l of r)this.br=this.br.add(new Re(l.key,s)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return U.resolve(a)}lookupMutationBatch(t,e){return U.resolve(this.Dr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,r=this.vr(i),s=r<0?0:r;return U.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Re(e,0),r=new Re(e,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],a=>{const l=this.Dr(a.wr);s.push(l)}),U.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Ot(_t);return e.forEach(r=>{const s=new Re(r,0),a=new Re(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],l=>{i=i.add(l.wr)})}),U.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1;let s=i;et.isDocumentKey(s)||(s=s.child(""));const a=new Re(new et(s),0);let l=new Ot(_t);return this.br.forEachWhile(h=>{const f=h.key.path;return!!i.isPrefixOf(f)&&(f.length===r&&(l=l.add(h.wr)),!0)},a),U.resolve(this.Cr(l))}Cr(t){const e=[];return t.forEach(i=>{const r=this.Dr(i);r!==null&&e.push(r)}),e}removeMutationBatch(t,e){ot(this.Fr(e.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return U.forEach(e.mutations,r=>{const s=new Re(r.key,e.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.br=i})}On(t){}containsKey(t,e){const i=new Re(e,0),r=this.br.firstAfterOrEqual(i);return U.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,U.resolve()}Fr(t,e){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const e=this.vr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(t){this.Mr=t,this.docs=function(){return new Ut(et.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,r=this.docs.get(i),s=r?r.size:0,a=this.Mr(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return U.resolve(i?i.document.mutableCopy():qt.newInvalidDocument(e))}getEntries(t,e){let i=fn();return e.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():qt.newInvalidDocument(r))}),U.resolve(i)}getDocumentsMatchingQuery(t,e,i,r){let s=fn();const a=e.path,l=new et(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:_}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||p_(dT(_),i)<=0||(r.has(_.key)||Gl(e,_))&&(s=s.insert(_.key,_.mutableCopy()))}return U.resolve(s)}getAllFromCollectionGroup(t,e,i,r){rt()}Or(t,e){return U.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new iL(this)}getSize(t){return U.resolve(this.size)}}class iL extends yI{constructor(t){super(),this.cr=t}applyChanges(t){const e=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?e.push(this.cr.addEntry(t,r)):this.cr.removeEntry(i)}),U.waitFor(e)}getFromCache(t,e){return this.cr.getEntry(t,e)}getAllFromCache(t,e){return this.cr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(t){this.persistence=t,this.Nr=new Xr(e=>Fs(e),$l),this.lastRemoteSnapshotVersion=ut.min(),this.highestTargetId=0,this.Lr=0,this.Br=new k_,this.targetCount=0,this.kr=$s.Bn()}forEachTarget(t,e){return this.Nr.forEach((i,r)=>e(r)),U.resolve()}getLastRemoteSnapshotVersion(t){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return U.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.Lr&&(this.Lr=e),U.resolve()}Kn(t){this.Nr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.kr=new $s(e),this.highestTargetId=e),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,e){return this.Kn(e),this.targetCount+=1,U.resolve()}updateTargetData(t,e){return this.Kn(e),U.resolve()}removeTargetData(t,e){return this.Nr.delete(e.target),this.Br.gr(e.targetId),this.targetCount-=1,U.resolve()}removeTargets(t,e,i){let r=0;const s=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=e&&i.get(l.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(t,l.targetId)),r++)}),U.waitFor(s).next(()=>r)}getTargetCount(t){return U.resolve(this.targetCount)}getTargetData(t,e){const i=this.Nr.get(e)||null;return U.resolve(i)}addMatchingKeys(t,e,i){return this.Br.Rr(e,i),U.resolve()}removeMatchingKeys(t,e,i){this.Br.mr(e,i);const r=this.persistence.referenceDelegate,s=[];return r&&e.forEach(a=>{s.push(r.markPotentiallyOrphaned(t,a))}),U.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.Br.gr(e),U.resolve()}getMatchingKeysForTargetId(t,e){const i=this.Br.yr(e);return U.resolve(i)}containsKey(t,e){return U.resolve(this.Br.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(t,e){this.qr={},this.overlays={},this.Qr=new hn(0),this.Kr=!1,this.Kr=!0,this.$r=new tL,this.referenceDelegate=t(this),this.Ur=new rL(this),this.indexManager=new UR,this.remoteDocumentCache=function(r){return new nL(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new hI(e),this.Gr=new XR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new JR,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.qr[t.toKey()];return i||(i=new eL(e,this.referenceDelegate),this.qr[t.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,e,i){Q("MemoryPersistence","Starting transaction:",t);const r=new sL(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(t,e){return U.or(Object.values(this.qr).map(i=>()=>i.containsKey(t,e)))}}class sL extends pT{constructor(t){super(),this.currentSequenceNumber=t}}class Od{constructor(t){this.persistence=t,this.Jr=new k_,this.Yr=null}static Zr(t){return new Od(t)}get Xr(){if(this.Yr)return this.Yr;throw rt()}addReference(t,e,i){return this.Jr.addReference(i,e),this.Xr.delete(i.toString()),U.resolve()}removeReference(t,e,i){return this.Jr.removeReference(i,e),this.Xr.add(i.toString()),U.resolve()}markPotentiallyOrphaned(t,e){return this.Xr.add(e.toString()),U.resolve()}removeTarget(t,e){this.Jr.gr(e.targetId).forEach(r=>this.Xr.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(t,e))}zr(){this.Yr=new Set}jr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,i=>{const r=et.fromPath(i);return this.ei(t,r).next(s=>{s||e.removeEntry(r,ut.min())})}).next(()=>(this.Yr=null,e.apply(t)))}updateLimboDocument(t,e){return this.ei(t,e).next(i=>{i?this.Xr.delete(e.toString()):this.Xr.add(e.toString())})}Wr(t){return 0}ei(t,e){return U.or([()=>U.resolve(this.Jr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Hr(t,e)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(t){this.serializer=t}O(t,e,i,r){const s=new Ld("createOrUpgrade",e);i<1&&r>=1&&(function(h){h.createObjectStore("owner")}(t),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uv,{unique:!0}),h.createObjectStore("documentMutations")}(t),Zv(t),function(h){h.createObjectStore("remoteDocuments")}(t));let a=U.resolve();return i<3&&r>=3&&(i!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(t),Zv(t)),a=a.next(()=>function(h){const f=h.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ut.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",_)}(s))),i<4&&r>=4&&(i!==0&&(a=a.next(()=>function(h,f){return f.store("mutations").U().next(_=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uv,{unique:!0});const g=f.store("mutations"),w=_.map(E=>g.put(E));return U.waitFor(w)})}(t,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(t)})),i<5&&r>=5&&(a=a.next(()=>this.ni(s))),i<6&&r>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(t),this.ri(s)))),i<7&&r>=7&&(a=a.next(()=>this.ii(s))),i<8&&r>=8&&(a=a.next(()=>this.si(t,s))),i<9&&r>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(t)})),i<10&&r>=10&&(a=a.next(()=>this.oi(s))),i<11&&r>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),i<12&&r>=12&&(a=a.next(()=>{(function(h){const f=h.createObjectStore("documentOverlays",{keyPath:zC});f.createIndex("collectionPathOverlayIndex",UC,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",jC,{unique:!1})})(t)})),i<13&&r>=13&&(a=a.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:RC});f.createIndex("documentKeyIndex",LC),f.createIndex("collectionGroupIndex",kC)}(t)).next(()=>this._i(t,s)).next(()=>t.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(a=a.next(()=>this.ai(t,s))),i<15&&r>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:NC}).createIndex("sequenceNumberIndex",OC,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:FC}).createIndex("documentKeyIndex",BC,{unique:!1})}(t))),i<16&&r>=16&&(a=a.next(()=>{e.objectStore("indexState").clear()}).next(()=>{e.objectStore("indexEntries").clear()})),i<17&&r>=17&&(a=a.next(()=>{(function(h){h.createObjectStore("globals",{keyPath:"name"})})(t)})),a}ri(t){let e=0;return t.store("remoteDocuments").J((i,r)=>{e+=od(r)}).next(()=>{const i={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}ni(t){const e=t.store("mutationQueues"),i=t.store("mutations");return e.U().next(r=>U.forEach(r,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",a).next(l=>U.forEach(l,h=>{ot(h.userId===s.userId);const f=ys(this.serializer,h);return mI(t,s.userId,f).next(()=>{})}))}))}ii(t){const e=t.store("targetDocuments"),i=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.J((a,l)=>{const h=new Pt(a),f=function(g){return[0,en(g)]}(h);s.push(e.get(f).next(_=>_?U.resolve():(g=>e.put({targetId:0,path:en(g),sequenceNumber:r.highestListenSequenceNumber}))(h)))}).next(()=>U.waitFor(s))})}si(t,e){t.createObjectStore("collectionParents",{keyPath:MC});const i=e.store("collectionParents"),r=new L_,s=a=>{if(r.add(a)){const l=a.lastSegment(),h=a.popLast();return i.put({collectionId:l,parent:en(h)})}};return e.store("remoteDocuments").J({H:!0},(a,l)=>{const h=new Pt(a);return s(h.popLast())}).next(()=>e.store("documentMutations").J({H:!0},([a,l,h],f)=>{const _=li(l);return s(_.popLast())}))}oi(t){const e=t.store("targets");return e.J((i,r)=>{const s=Bu(r),a=dI(this.serializer,s);return e.put(a)})}_i(t,e){const i=e.store("remoteDocuments"),r=[];return i.J((s,a)=>{const l=e.store("remoteDocumentsV14"),h=function(g){return g.document?new et(Pt.fromString(g.document.name).popFirst(5)):g.noDocument?et.fromSegments(g.noDocument.path):g.unknownDocument?et.fromSegments(g.unknownDocument.path):rt()}(a).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};r.push(l.put(f))}).next(()=>U.waitFor(r))}ai(t,e){const i=e.store("mutations"),r=vI(this.serializer),s=new EI(Od.Zr,this.serializer.ct);return i.U().next(a=>{const l=new Map;return a.forEach(h=>{var f;let _=(f=l.get(h.userId))!==null&&f!==void 0?f:yt();ys(this.serializer,h).keys().forEach(g=>_=_.add(g)),l.set(h.userId,_)}),U.forEach(l,(h,f)=>{const _=new ke(f),g=Md.lt(this.serializer,_),w=s.getIndexManager(_),E=Nd.lt(_,this.serializer,w,s.referenceDelegate);return new wI(r,E,g,w).recalculateAndSaveOverlaysForDocumentKeys(new Gp(e,hn.oe),h).next()})})}}function Zv(n){n.createObjectStore("targetDocuments",{keyPath:DC}).createIndex("documentTargetsIndex",VC,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",bC,{unique:!0}),n.createObjectStore("targetGlobal")}const Uf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class b_{constructor(t,e,i,r,s,a,l,h,f,_,g=17){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=i,this.ui=s,this.window=a,this.document=l,this.ci=f,this.li=_,this.hi=g,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=w=>Promise.resolve(),!b_.D())throw new Z(G.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new KR(this,r),this.Ai=e+"main",this.serializer=new hI(h),this.Ri=new fi(this.Ai,this.hi,new oL(this.serializer)),this.$r=new MR,this.Ur=new $R(this.referenceDelegate,this.serializer),this.remoteDocumentCache=vI(this.serializer),this.Gr=new VR,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,_===!1&&le("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Z(G.FAILED_PRECONDITION,Uf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Ur.getHighestSequenceNumber(t))}).then(t=>{this.Qr=new hn(t,this.ci)}).then(()=>{this.Kr=!0}).catch(t=>(this.Ri&&this.Ri.close(),Promise.reject(t)))}yi(t){return this.di=async e=>{if(this.started)return t(e)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ri.L(async e=>{e.newVersion===null&&await t()})}setNetworkEnabled(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>rh(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(t).next(e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(t)).next(e=>this.isPrimary&&!e?this.bi(t).next(()=>!1):!!e&&this.Di(t).next(()=>!0))).catch(t=>{if(Yr(t))return Q("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return Q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.ui.enqueueRetryable(()=>this.di(t)),this.isPrimary=t})}wi(t){return ku(t).get("owner").next(e=>U.resolve(this.vi(e)))}Ci(t){return rh(t).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const i=Pe(e,"clientMetadata");return i.U().next(r=>{const s=this.xi(r,18e5),a=r.filter(l=>s.indexOf(l)===-1);return U.forEach(a,l=>i.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const e of t)this.Vi.removeItem(this.Oi(e.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(t){return!!t&&t.ownerId===this.clientId}Si(t){return this.li?U.resolve(!0):ku(t).get("owner").next(e=>{if(e!==null&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)){if(this.vi(e)&&this.networkEnabled)return!0;if(!this.vi(e)){if(!e.allowTabSynchronization)throw new Z(G.FAILED_PRECONDITION,Uf);return!1}}return!(!this.networkEnabled||!this.inForeground)||rh(t).U().next(i=>this.xi(i,5e3).find(r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,a=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(e=>(this.isPrimary!==e&&Q("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const e=new Gp(t,hn.oe);return this.bi(e).next(()=>this.Ci(e))}),this.Ri.close(),this.qi()}xi(t,e){return t.filter(i=>this.Mi(i.updateTimeMs,e)&&!this.Ni(i.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",t=>rh(t).U().next(e=>this.xi(e,18e5).map(i=>i.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(t,e){return Nd.lt(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new jR(t,this.serializer.ct.databaseId)}getDocumentOverlayCache(t){return Md.lt(this.serializer,t)}getBundleCache(){return this.Gr}runTransaction(t,e,i){Q("IndexedDbPersistence","Starting transaction:",t);const r=e==="readonly"?"readonly":"readwrite",s=function(h){return h===17?GC:h===16?qC:h===15?__:h===14?wT:h===13?vT:h===12?$C:h===11?yT:void rt()}(this.hi);let a;return this.Ri.runTransaction(t,r,s,l=>(a=new Gp(l,this.Qr?this.Qr.next():hn.oe),e==="readwrite-primary"?this.wi(a).next(h=>!!h||this.Si(a)).next(h=>{if(!h)throw le(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Z(G.FAILED_PRECONDITION,fT);return i(a)}).next(h=>this.Di(a).next(()=>h)):this.Ki(a).next(()=>i(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Ki(t){return ku(t).get("owner").next(e=>{if(e!==null&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Z(G.FAILED_PRECONDITION,Uf)})}Di(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ku(t).put("owner",e)}static D(){return fi.D()}bi(t){const e=ku(t);return e.get("owner").next(i=>this.vi(i)?(Q("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):U.resolve())}Mi(t,e){const i=Date.now();return!(t<i-e)&&(!(t>i)||(le(`Detected an update time that is in the future: ${t} > ${i}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var t;typeof((t=this.window)===null||t===void 0?void 0:t.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;UE()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(t){var e;try{const i=((e=this.Vi)===null||e===void 0?void 0:e.getItem(this.Oi(t)))!==null;return Q("IndexedDbPersistence",`Client '${t}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return le("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(t){le("Failed to set zombie client id.",t)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function ku(n){return Pe(n,"owner")}function rh(n){return Pe(n,"clientMetadata")}function D_(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(t,e,i,r){this.targetId=t,this.fromCache=e,this.$i=i,this.Ui=r}static Wi(t,e){let i=yt(),r=yt();for(const s of e.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new V_(t,e.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return UE()?8:mT(Xh())>0?6:4}()}initialize(t,e){this.Ji=t,this.indexManager=e,this.Gi=!0}getDocumentsMatchingQuery(t,e,i,r){const s={result:null};return this.Yi(t,e).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(t,e,r,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new aL;return this.Xi(t,e,a).next(l=>{if(s.result=l,this.zi)return this.es(t,e,a,l.size)})}).next(()=>s.result)}es(t,e,i,r){return i.documentReadCount<this.ji?(xo()<=xt.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",Co(e),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(xo()<=xt.DEBUG&&Q("QueryEngine","Query:",Co(e),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(xo()<=xt.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",Co(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,nn(e))):U.resolve())}Yi(t,e){if(Ev(e))return U.resolve(null);let i=nn(e);return this.indexManager.getIndexType(t,i).next(r=>r===0?null:(e.limit!==null&&r===1&&(e=id(e,null,"F"),i=nn(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const a=yt(...s);return this.Ji.getDocuments(t,a).next(l=>this.indexManager.getMinOffset(t,i).next(h=>{const f=this.ts(e,l);return this.ns(e,f,a,h.readTime)?this.Yi(t,id(e,null,"F")):this.rs(t,f,e,h)}))})))}Zi(t,e,i,r){return Ev(e)||r.isEqual(ut.min())?U.resolve(null):this.Ji.getDocuments(t,i).next(s=>{const a=this.ts(e,s);return this.ns(e,a,i,r)?U.resolve(null):(xo()<=xt.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Co(e)),this.rs(t,a,e,hT(r,-1)).next(l=>l))})}ts(t,e){let i=new Ot(NT(t));return e.forEach((r,s)=>{Gl(t,s)&&(i=i.add(s))}),i}ns(t,e,i,r){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const s=t.limitType==="F"?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(t,e,i){return xo()<=xt.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",Co(e)),this.Ji.getDocumentsMatchingQuery(t,e,In.min(),i)}rs(t,e,i,r){return this.Ji.getDocumentsMatchingQuery(t,i,r).next(s=>(e.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(t,e,i,r){this.persistence=t,this.ss=e,this.serializer=r,this.os=new Ut(_t),this._s=new Xr(s=>Fs(s),$l),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(i)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new wI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.os))}}function II(n,t,e,i){return new uL(n,t,e,i)}async function PI(n,t){const e=nt(n);return await e.persistence.runTransaction("Handle user change","readonly",i=>{let r;return e.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,e.ls(t),e.mutationQueue.getAllMutationBatches(i))).next(s=>{const a=[],l=[];let h=yt();for(const f of r){a.push(f.batchId);for(const _ of f.mutations)h=h.add(_.key)}for(const f of s){l.push(f.batchId);for(const _ of f.mutations)h=h.add(_.key)}return e.localDocuments.getDocuments(i,h).next(f=>({hs:f,removedBatchIds:a,addedBatchIds:l}))})})}function lL(n,t){const e=nt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),s=e.cs.newChangeBuffer({trackRemovals:!0});return function(l,h,f,_){const g=f.batch,w=g.keys();let E=U.resolve();return w.forEach(x=>{E=E.next(()=>_.getEntry(h,x)).next(R=>{const z=f.docVersions.get(x);ot(z!==null),R.version.compareTo(z)<0&&(g.applyToRemoteDocument(R,f),R.isValidDocument()&&(R.setReadTime(f.commitVersion),_.addEntry(R)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(h,g))}(e,i,t,s).next(()=>s.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(l){let h=yt();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(t))).next(()=>e.localDocuments.getDocuments(i,r))})}function SI(n){const t=nt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function cL(n,t){const e=nt(n),i=t.snapshotVersion;let r=e.os;return e.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=e.cs.newChangeBuffer({trackRemovals:!0});r=e.os;const l=[];t.targetChanges.forEach((_,g)=>{const w=r.get(g);if(!w)return;l.push(e.Ur.removeMatchingKeys(s,_.removedDocuments,g).next(()=>e.Ur.addMatchingKeys(s,_.addedDocuments,g)));let E=w.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(g)!==null?E=E.withResumeToken(oe.EMPTY_BYTE_STRING,ut.min()).withLastLimboFreeSnapshotVersion(ut.min()):_.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(_.resumeToken,i)),r=r.insert(g,E),function(R,z,A){return R.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(w,E,_)&&l.push(e.Ur.updateTargetData(s,E))});let h=fn(),f=yt();if(t.documentUpdates.forEach(_=>{t.resolvedLimboDocuments.has(_)&&l.push(e.persistence.referenceDelegate.updateLimboDocument(s,_))}),l.push(AI(s,a,t.documentUpdates).next(_=>{h=_.Ps,f=_.Is})),!i.isEqual(ut.min())){const _=e.Ur.getLastRemoteSnapshotVersion(s).next(g=>e.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));l.push(_)}return U.waitFor(l).next(()=>a.apply(s)).next(()=>e.localDocuments.getLocalViewOfDocuments(s,h,f)).next(()=>h)}).then(s=>(e.os=r,s))}function AI(n,t,e){let i=yt(),r=yt();return e.forEach(s=>i=i.add(s)),t.getEntries(n,i).next(s=>{let a=fn();return e.forEach((l,h)=>{const f=s.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(r=r.add(l)),h.isNoDocument()&&h.version.isEqual(ut.min())?(t.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(h),a=a.insert(l,h)):Q("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{Ps:a,Is:r}})}function hL(n,t){const e=nt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function pa(n,t){const e=nt(n);return e.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return e.Ur.getTargetData(i,t).next(s=>s?(r=s,U.resolve(r)):e.Ur.allocateTargetId(i).next(a=>(r=new Bi(t,a,"TargetPurposeListen",i.currentSequenceNumber),e.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=e.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(e.os=e.os.insert(i.targetId,i),e._s.set(t,i.targetId)),i})}async function ma(n,t,e){const i=nt(n),r=i.os.get(t),s=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!Yr(a))throw a;Q("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}i.os=i.os.remove(t),i._s.delete(r.target)}function ad(n,t,e){const i=nt(n);let r=ut.min(),s=yt();return i.persistence.runTransaction("Execute query","readwrite",a=>function(h,f,_){const g=nt(h),w=g._s.get(_);return w!==void 0?U.resolve(g.os.get(w)):g.Ur.getTargetData(f,_)}(i,a,nn(t)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>i.ss.getDocumentsMatchingQuery(a,t,e?r:ut.min(),e?s:yt())).next(l=>(RI(i,MT(t),l),{documents:l,Ts:s})))}function xI(n,t){const e=nt(n),i=nt(e.Ur),r=e.os.get(t);return r?Promise.resolve(r.target):e.persistence.runTransaction("Get target data","readonly",s=>i.ot(s,t).next(a=>a?a.target:null))}function CI(n,t){const e=nt(n),i=e.us.get(t)||ut.min();return e.persistence.runTransaction("Get new document changes","readonly",r=>e.cs.getAllFromCollectionGroup(r,t,hT(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(RI(e,t,r),r))}function RI(n,t,e){let i=n.us.get(t)||ut.min();e.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(t,i)}async function dL(n,t,e,i){const r=nt(n);let s=yt(),a=fn();for(const f of e){const _=t.Es(f.metadata.name);f.document&&(s=s.add(_));const g=t.ds(f);g.setReadTime(t.As(f.metadata.readTime)),a=a.insert(_,g)}const l=r.cs.newChangeBuffer({trackRemovals:!0}),h=await pa(r,function(_){return nn(Sa(Pt.fromString(`__bundle__/docs/${_}`)))}(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",f=>AI(f,l,a).next(_=>(l.apply(f),_)).next(_=>r.Ur.removeMatchingKeysForTargetId(f,h.targetId).next(()=>r.Ur.addMatchingKeys(f,s,h.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(f,_.Ps,_.Is)).next(()=>_.Ps)))}async function fL(n,t,e=yt()){const i=await pa(n,nn(C_(t.bundledQuery))),r=nt(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const a=ce(t.readTime);if(i.snapshotVersion.compareTo(a)>=0)return r.Gr.saveNamedQuery(s,t);const l=i.withResumeToken(oe.EMPTY_BYTE_STRING,a);return r.os=r.os.insert(l.targetId,l),r.Ur.updateTargetData(s,l).next(()=>r.Ur.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Ur.addMatchingKeys(s,e,i.targetId)).next(()=>r.Gr.saveNamedQuery(s,t))})}function Qv(n,t){return`firestore_clients_${n}_${t}`}function Yv(n,t,e){let i=`firestore_mutations_${n}_${e}`;return t.isAuthenticated()&&(i+=`_${t.uid}`),i}function jf(n,t){return`firestore_targets_${n}_${t}`}class ud{constructor(t,e,i,r){this.user=t,this.batchId=e,this.state=i,this.error=r}static Rs(t,e,i){const r=JSON.parse(i);let s,a=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(s=new Z(r.error.code,r.error.message))),a?new ud(t,e,r.state,s):(le("SharedClientState",`Failed to parse mutation state for ID '${e}': ${i}`),null)}Vs(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Ju{constructor(t,e,i){this.targetId=t,this.state=e,this.error=i}static Rs(t,e){const i=JSON.parse(e);let r,s=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(r=new Z(i.error.code,i.error.message))),s?new Ju(t,i.state,r):(le("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}Vs(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class ld{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Rs(t,e){const i=JSON.parse(e);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=w_();for(let a=0;r&&a<i.activeTargetIds.length;++a)r=_T(i.activeTargetIds[a]),s=s.add(i.activeTargetIds[a]);return r?new ld(t,s):(le("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class M_{constructor(t,e){this.clientId=t,this.onlineState=e}static Rs(t){const e=JSON.parse(t);return typeof e=="object"&&["Unknown","Online","Offline"].indexOf(e.onlineState)!==-1&&typeof e.clientId=="string"?new M_(e.clientId,e.onlineState):(le("SharedClientState",`Failed to parse online state: ${t}`),null)}}class sm{constructor(){this.activeTargetIds=w_()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class $f{constructor(t,e,i,r,s){this.window=t,this.ui=e,this.persistenceKey=i,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ut(_t),this.started=!1,this.bs=[];const a=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=Qv(this.persistenceKey,this.ps),this.vs=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new sm),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.Os=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(t){return!(!t||!t.localStorage)}async start(){const t=await this.syncEngine.Qi();for(const i of t){if(i===this.ps)continue;const r=this.getItem(Qv(this.persistenceKey,i));if(r){const s=ld.Rs(i,r);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const e=this.storage.getItem(this.xs);if(e){const i=this.Ls(e);i&&this.Bs(i)}for(const i of this.bs)this.ws(i);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(t){this.setItem(this.vs,JSON.stringify(t))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(t){let e=!1;return this.Ss.forEach((i,r)=>{r.activeTargetIds.has(t)&&(e=!0)}),e}addPendingMutation(t){this.qs(t,"pending")}updateMutationState(t,e,i){this.qs(t,e,i),this.Qs(t)}addLocalQueryTarget(t,e=!0){let i="not-current";if(this.isActiveQueryTarget(t)){const r=this.storage.getItem(jf(this.persistenceKey,t));if(r){const s=Ju.Rs(t,r);s&&(i=s.state)}}return e&&this.Ks.fs(t),this.Ns(),i}removeLocalQueryTarget(t){this.Ks.gs(t),this.Ns()}isLocalQueryTarget(t){return this.Ks.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(jf(this.persistenceKey,t))}updateQueryState(t,e,i){this.$s(t,e,i)}handleUserChange(t,e,i){e.forEach(r=>{this.Qs(r)}),this.currentUser=t,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(t){this.Us(t)}notifyBundleLoaded(t){this.Ws(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(t){const e=this.storage.getItem(t);return Q("SharedClientState","READ",t,e),e}setItem(t,e){Q("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){Q("SharedClientState","REMOVE",t),this.storage.removeItem(t)}ws(t){const e=t;if(e.storageArea===this.storage){if(Q("SharedClientState","EVENT",e.key,e.newValue),e.key===this.Ds)return void le("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(e.key!==null){if(this.Cs.test(e.key)){if(e.newValue==null){const i=this.Gs(e.key);return this.zs(i,null)}{const i=this.js(e.key,e.newValue);if(i)return this.zs(i.clientId,i)}}else if(this.Fs.test(e.key)){if(e.newValue!==null){const i=this.Hs(e.key,e.newValue);if(i)return this.Js(i)}}else if(this.Ms.test(e.key)){if(e.newValue!==null){const i=this.Ys(e.key,e.newValue);if(i)return this.Zs(i)}}else if(e.key===this.xs){if(e.newValue!==null){const i=this.Ls(e.newValue);if(i)return this.Bs(i)}}else if(e.key===this.vs){const i=function(s){let a=hn.oe;if(s!=null)try{const l=JSON.parse(s);ot(typeof l=="number"),a=l}catch(l){le("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(e.newValue);i!==hn.oe&&this.sequenceNumberHandler(i)}else if(e.key===this.Os){const i=this.Xs(e.newValue);await Promise.all(i.map(r=>this.syncEngine.eo(r)))}}}else this.bs.push(e)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(t,e,i){const r=new ud(this.currentUser,t,e,i),s=Yv(this.persistenceKey,this.currentUser,t);this.setItem(s,r.Vs())}Qs(t){const e=Yv(this.persistenceKey,this.currentUser,t);this.removeItem(e)}Us(t){const e={clientId:this.ps,onlineState:t};this.storage.setItem(this.xs,JSON.stringify(e))}$s(t,e,i){const r=jf(this.persistenceKey,t),s=new Ju(t,e,i);this.setItem(r,s.Vs())}Ws(t){const e=JSON.stringify(Array.from(t));this.setItem(this.Os,e)}Gs(t){const e=this.Cs.exec(t);return e?e[1]:null}js(t,e){const i=this.Gs(t);return ld.Rs(i,e)}Hs(t,e){const i=this.Fs.exec(t),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return ud.Rs(new ke(s),r,e)}Ys(t,e){const i=this.Ms.exec(t),r=Number(i[1]);return Ju.Rs(r,e)}Ls(t){return M_.Rs(t)}Xs(t){return JSON.parse(t)}async Js(t){if(t.user.uid===this.currentUser.uid)return this.syncEngine.no(t.batchId,t.state,t.error);Q("SharedClientState",`Ignoring mutation for non-active user ${t.user.uid}`)}Zs(t){return this.syncEngine.ro(t.targetId,t.state,t.error)}zs(t,e){const i=e?this.Ss.insert(t,e):this.Ss.remove(t),r=this.ks(this.Ss),s=this.ks(i),a=[],l=[];return s.forEach(h=>{r.has(h)||a.push(h)}),r.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.io(a,l).then(()=>{this.Ss=i})}Bs(t){this.Ss.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}ks(t){let e=w_();return t.forEach((i,r)=>{e=e.unionWith(r.activeTargetIds)}),e}}class LI{constructor(){this.so=new sm,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,e,i){this.oo[t]=e}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new sm,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sh=null;function qf(){return sh===null?sh=function(){return 268435456+Math.round(2147483648*Math.random())}():sh++,"0x"+sh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const We="WebChannelConnection";class gL extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+e.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(e,i,r,s,a){const l=qf(),h=this.xo(e,i.toUriEncodedString());Q("RestConnection",`Sending RPC '${e}' ${l}:`,h,r);const f={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(f,s,a),this.No(e,h,f,r).then(_=>(Q("RestConnection",`Received RPC '${e}' ${l}: `,_),_),_=>{throw mi("RestConnection",`RPC '${e}' ${l} failed with error: `,_,"url: ",h,"request:",r),_})}Lo(e,i,r,s,a,l){return this.Mo(e,i,r,s,a)}Oo(e,i,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,a)=>e[a]=s),r&&r.headers.forEach((s,a)=>e[a]=s)}xo(e,i){const r=mL[e];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,e,i,r){const s=qf();return new Promise((a,l)=>{const h=new iT;h.setWithCredentials(!0),h.listenOnce(rT.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case yh.NO_ERROR:const _=h.getResponseJson();Q(We,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(_)),a(_);break;case yh.TIMEOUT:Q(We,`RPC '${t}' ${s} timed out`),l(new Z(G.DEADLINE_EXCEEDED,"Request time out"));break;case yh.HTTP_ERROR:const g=h.getStatus();if(Q(We,`RPC '${t}' ${s} failed with status:`,g,"response text:",h.getResponseText()),g>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const E=w==null?void 0:w.error;if(E&&E.status&&E.message){const x=function(z){const A=z.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(A)>=0?A:G.UNKNOWN}(E.status);l(new Z(x,E.message))}else l(new Z(G.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Z(G.UNAVAILABLE,"Connection failed."));break;default:rt()}}finally{Q(We,`RPC '${t}' ${s} completed.`)}});const f=JSON.stringify(r);Q(We,`RPC '${t}' ${s} sending request:`,r),h.send(e,"POST",f,i,15)})}Bo(t,e,i){const r=qf(),s=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=aT(),l=oT(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Oo(h.initMessageHeaders,e,i),h.encodeInitMessageHeaders=!0;const _=s.join("");Q(We,`Creating RPC '${t}' stream ${r}: ${_}`,h);const g=a.createWebChannel(_,h);let w=!1,E=!1;const x=new _L({Io:z=>{E?Q(We,`Not sending because RPC '${t}' stream ${r} is closed:`,z):(w||(Q(We,`Opening RPC '${t}' stream ${r} transport.`),g.open(),w=!0),Q(We,`RPC '${t}' stream ${r} sending:`,z),g.send(z))},To:()=>g.close()}),R=(z,A,S)=>{z.listen(A,C=>{try{S(C)}catch(j){setTimeout(()=>{throw j},0)}})};return R(g,Nu.EventType.OPEN,()=>{E||(Q(We,`RPC '${t}' stream ${r} transport opened.`),x.yo())}),R(g,Nu.EventType.CLOSE,()=>{E||(E=!0,Q(We,`RPC '${t}' stream ${r} transport closed`),x.So())}),R(g,Nu.EventType.ERROR,z=>{E||(E=!0,mi(We,`RPC '${t}' stream ${r} transport errored:`,z),x.So(new Z(G.UNAVAILABLE,"The operation could not be completed")))}),R(g,Nu.EventType.MESSAGE,z=>{var A;if(!E){const S=z.data[0];ot(!!S);const C=S,j=C.error||((A=C[0])===null||A===void 0?void 0:A.error);if(j){Q(We,`RPC '${t}' stream ${r} received error:`,j);const H=j.status;let Y=function(b){const V=_e[b];if(V!==void 0)return ZT(V)}(H),k=j.message;Y===void 0&&(Y=G.INTERNAL,k="Unknown error status: "+H+" with message "+j.message),E=!0,x.So(new Z(Y,k)),g.close()}else Q(We,`RPC '${t}' stream ${r} received:`,S),x.bo(S)}}),R(l,sT.STAT_EVENT,z=>{z.stat===$p.PROXY?Q(We,`RPC '${t}' stream ${r} detected buffering proxy`):z.stat===$p.NOPROXY&&Q(We,`RPC '${t}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(){return typeof window<"u"?window:null}function Sh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(n){return new IR(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(t,e,i=1e3,r=1.5,s=6e4){this.ui=t,this.timerId=e,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const e=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,e-i);r>0&&Q("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(t,e,i,r,s,a,l,h){this.ui=t,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new N_(t,e)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,e){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():e&&e.code===G.RESOURCE_EXHAUSTED?(le(e.toString()),le("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):e&&e.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(e)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),e=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===e&&this.P_(i,r)},i=>{t(()=>{const r=new Z(G.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(t,e){const i=this.h_(this.Yo);this.stream=this.T_(t,e),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return Q("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return e=>{this.ui.enqueueAndForget(()=>this.Yo===t?e():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yL extends bI{constructor(t,e,i,r,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,r,a),this.serializer=s}T_(t,e){return this.connection.Bo("Listen",t,e)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const e=AR(this.serializer,t),i=function(s){if(!("targetChange"in s))return ut.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ut.min():a.readTime?ce(a.readTime):ut.min()}(t);return this.listener.d_(e,i)}A_(t){const e={};e.database=tm(this.serializer),e.addTarget=function(s,a){let l;const h=a.target;if(l=ed(h)?{documents:sI(s,h)}:{query:oI(s,h)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=JT(s,a.resumeToken);const f=Xp(s,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(ut.min())>0){l.readTime=fa(s,a.snapshotVersion.toTimestamp());const f=Xp(s,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,t);const i=CR(this.serializer,t);i&&(e.labels=i),this.a_(e)}R_(t){const e={};e.database=tm(this.serializer),e.removeTarget=t,this.a_(e)}}class vL extends bI{constructor(t,e,i,r,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,r,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,e){return this.connection.Bo("Write",t,e)}E_(t){return ot(!!t.streamToken),this.lastStreamToken=t.streamToken,ot(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){ot(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const e=xR(t.writeResults,t.commitTime),i=ce(t.commitTime);return this.listener.g_(i,e)}p_(){const t={};t.database=tm(this.serializer),this.a_(t)}m_(t){const e={streamToken:this.lastStreamToken,writes:t.map(i=>Ll(this.serializer,i))};this.a_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL extends class{}{constructor(t,e,i,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Z(G.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,e,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(t,Jp(e,i),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Z(G.UNKNOWN,s.toString())})}Lo(t,e,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(t,Jp(e,i),r,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Z(G.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class EL{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(le(e),this.D_=!1):Q("OnlineStateTracker",e)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(t,e,i,r,s){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{i.enqueueAndForget(async()=>{Jr(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(h){const f=nt(h);f.L_.add(4),await Ca(f),f.q_.set("Unknown"),f.L_.delete(4),await Ql(f)}(this))})}),this.q_=new EL(i,r)}}async function Ql(n){if(Jr(n))for(const t of n.B_)await t(!0)}async function Ca(n){for(const t of n.B_)await t(!1)}function Fd(n,t){const e=nt(n);e.N_.has(t.targetId)||(e.N_.set(t.targetId,t),B_(e)?F_(e):La(e).r_()&&O_(e,t))}function _a(n,t){const e=nt(n),i=La(e);e.N_.delete(t),i.r_()&&DI(e,t),e.N_.size===0&&(i.r_()?i.o_():Jr(e)&&e.q_.set("Unknown"))}function O_(n,t){if(n.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ut.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}La(n).A_(t)}function DI(n,t){n.Q_.xe(t),La(n).R_(t)}function F_(n){n.Q_=new vR({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>n.N_.get(t)||null,tt:()=>n.datastore.serializer.databaseId}),La(n).start(),n.q_.v_()}function B_(n){return Jr(n)&&!La(n).n_()&&n.N_.size>0}function Jr(n){return nt(n).L_.size===0}function VI(n){n.Q_=void 0}async function IL(n){n.q_.set("Online")}async function PL(n){n.N_.forEach((t,e)=>{O_(n,t)})}async function SL(n,t){VI(n),B_(n)?(n.q_.M_(t),F_(n)):n.q_.set("Unknown")}async function AL(n,t,e){if(n.q_.set("Online"),t instanceof XT&&t.state===2&&t.cause)try{await async function(r,s){const a=s.cause;for(const l of s.targetIds)r.N_.has(l)&&(await r.remoteSyncer.rejectListen(l,a),r.N_.delete(l),r.Q_.removeTarget(l))}(n,t)}catch(i){Q("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await cd(n,i)}else if(t instanceof Ph?n.Q_.Ke(t):t instanceof YT?n.Q_.He(t):n.Q_.We(t),!e.isEqual(ut.min()))try{const i=await SI(n.localStore);e.compareTo(i)>=0&&await function(s,a){const l=s.Q_.rt(a);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const _=s.N_.get(f);_&&s.N_.set(f,_.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,f)=>{const _=s.N_.get(h);if(!_)return;s.N_.set(h,_.withResumeToken(oe.EMPTY_BYTE_STRING,_.snapshotVersion)),DI(s,h);const g=new Bi(_.target,h,f,_.sequenceNumber);O_(s,g)}),s.remoteSyncer.applyRemoteEvent(l)}(n,e)}catch(i){Q("RemoteStore","Failed to raise snapshot:",i),await cd(n,i)}}async function cd(n,t,e){if(!Yr(t))throw t;n.L_.add(1),await Ca(n),n.q_.set("Offline"),e||(e=()=>SI(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await e(),n.L_.delete(1),await Ql(n)})}function MI(n,t){return t().catch(e=>cd(n,e,t))}async function Ra(n){const t=nt(n),e=qr(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;xL(t);)try{const r=await hL(t.localStore,i);if(r===null){t.O_.length===0&&e.o_();break}i=r.batchId,CL(t,r)}catch(r){await cd(t,r)}NI(t)&&OI(t)}function xL(n){return Jr(n)&&n.O_.length<10}function CL(n,t){n.O_.push(t);const e=qr(n);e.r_()&&e.V_&&e.m_(t.mutations)}function NI(n){return Jr(n)&&!qr(n).n_()&&n.O_.length>0}function OI(n){qr(n).start()}async function RL(n){qr(n).p_()}async function LL(n){const t=qr(n);for(const e of n.O_)t.m_(e.mutations)}async function kL(n,t,e){const i=n.O_.shift(),r=P_.from(i,t,e);await MI(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Ra(n)}async function bL(n,t){t&&qr(n).V_&&await async function(i,r){if(function(a){return KT(a)&&a!==G.ABORTED}(r.code)){const s=i.O_.shift();qr(i).s_(),await MI(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Ra(i)}}(n,t),NI(n)&&OI(n)}async function Jv(n,t){const e=nt(n);e.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const i=Jr(e);e.L_.add(3),await Ca(e),i&&e.q_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.L_.delete(3),await Ql(e)}async function om(n,t){const e=nt(n);t?(e.L_.delete(2),await Ql(e)):t||(e.L_.add(2),await Ca(e),e.q_.set("Unknown"))}function La(n){return n.K_||(n.K_=function(e,i,r){const s=nt(e);return s.w_(),new yL(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:IL.bind(null,n),Ro:PL.bind(null,n),mo:SL.bind(null,n),d_:AL.bind(null,n)}),n.B_.push(async t=>{t?(n.K_.s_(),B_(n)?F_(n):n.q_.set("Unknown")):(await n.K_.stop(),VI(n))})),n.K_}function qr(n){return n.U_||(n.U_=function(e,i,r){const s=nt(e);return s.w_(),new vL(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:RL.bind(null,n),mo:bL.bind(null,n),f_:LL.bind(null,n),g_:kL.bind(null,n)}),n.B_.push(async t=>{t?(n.U_.s_(),await Ra(n)):(await n.U_.stop(),n.O_.length>0&&(Q("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(t,e,i,r,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Be,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,r,s){const a=Date.now()+i,l=new z_(t,e,a,r,s);return l.start(i),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(G.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ka(n,t){if(le("AsyncQueue",`${t}: ${n}`),Yr(n))return new Z(G.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(t){this.comparator=t?(e,i)=>t(e,i)||et.comparator(e.key,i.key):(e,i)=>et.comparator(e.key,i.key),this.keyedMap=Ou(),this.sortedSet=new Ut(this.comparator)}static emptySet(t){return new Yo(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,i)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Yo)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const r=e.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new Yo;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(){this.W_=new Ut(et.comparator)}track(t){const e=t.doc.key,i=this.W_.get(e);i?t.type!==0&&i.type===3?this.W_=this.W_.insert(e,t):t.type===3&&i.type!==1?this.W_=this.W_.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.W_=this.W_.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.W_=this.W_.remove(e):t.type===1&&i.type===2?this.W_=this.W_.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):rt():this.W_=this.W_.insert(e,t)}G_(){const t=[];return this.W_.inorderTraversal((e,i)=>{t.push(i)}),t}}class ga{constructor(t,e,i,r,s,a,l,h,f){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(t,e,i,r,s){const a=[];return e.forEach(l=>{a.push({type:0,doc:l})}),new ga(t,e,Yo.emptySet(e),a,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ql(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==i[r].type||!e[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class VL{constructor(){this.queries=ew(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(e,i){const r=nt(e),s=r.queries;r.queries=ew(),s.forEach((a,l)=>{for(const h of l.j_)h.onError(i)})})(this,new Z(G.ABORTED,"Firestore shutting down"))}}function ew(){return new Xr(n=>VT(n),ql)}async function U_(n,t){const e=nt(n);let i=3;const r=t.query;let s=e.queries.get(r);s?!s.H_()&&t.J_()&&(i=2):(s=new DL,i=t.J_()?0:1);try{switch(i){case 0:s.z_=await e.onListen(r,!0);break;case 1:s.z_=await e.onListen(r,!1);break;case 2:await e.onFirstRemoteStoreListen(r)}}catch(a){const l=ka(a,`Initialization of query '${Co(t.query)}' failed`);return void t.onError(l)}e.queries.set(r,s),s.j_.push(t),t.Z_(e.onlineState),s.z_&&t.X_(s.z_)&&$_(e)}async function j_(n,t){const e=nt(n),i=t.query;let r=3;const s=e.queries.get(i);if(s){const a=s.j_.indexOf(t);a>=0&&(s.j_.splice(a,1),s.j_.length===0?r=t.J_()?0:1:!s.H_()&&t.J_()&&(r=2))}switch(r){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function ML(n,t){const e=nt(n);let i=!1;for(const r of t){const s=r.query,a=e.queries.get(s);if(a){for(const l of a.j_)l.X_(r)&&(i=!0);a.z_=r}}i&&$_(e)}function NL(n,t,e){const i=nt(n),r=i.queries.get(t);if(r)for(const s of r.j_)s.onError(e);i.queries.delete(t)}function $_(n){n.Y_.forEach(t=>{t.next()})}var am,nw;(nw=am||(am={})).ea="default",nw.Cache="cache";class q_{constructor(t,e,i){this.query=t,this.ta=e,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new ga(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.na?this.ia(t)&&(this.ta.next(t),e=!0):this.sa(t,this.onlineState)&&(this.oa(t),e=!0),this.ra=t,e}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let e=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),e=!0),e}sa(t,e){if(!t.fromCache||!this.J_())return!0;const i=e!=="Offline";return(!this.options._a||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const e=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}oa(t){t=ga.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==am.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{constructor(t,e){this.aa=t,this.byteLength=e}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(t){this.serializer=t}Es(t){return pi(this.serializer,t)}ds(t){return t.metadata.exists?rI(this.serializer,t.document,!1):qt.newNoDocument(this.Es(t.metadata.name),this.As(t.metadata.readTime))}As(t){return ce(t)}}class FL{constructor(t,e,i){this.ca=t,this.localStore=e,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=FI(t)}la(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.aa.namedQuery)this.queries.push(t.aa.namedQuery);else if(t.aa.documentMetadata){this.documents.push({metadata:t.aa.documentMetadata}),t.aa.documentMetadata.exists||++e;const i=Pt.fromString(t.aa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else t.aa.document&&(this.documents[this.documents.length-1].document=t.aa.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null}ha(t){const e=new Map,i=new iw(this.serializer);for(const r of t)if(r.metadata.queries){const s=i.Es(r.metadata.name);for(const a of r.metadata.queries){const l=(e.get(a)||yt()).add(s);e.set(a,l)}}return e}async complete(){const t=await dL(this.localStore,new iw(this.serializer),this.documents,this.ca.id),e=this.ha(this.documents);for(const i of this.queries)await fL(this.localStore,i,e.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:t}}}function FI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(t){this.key=t}}class zI{constructor(t){this.key=t}}class UI{constructor(t,e){this.query=t,this.Ta=e,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=yt(),this.mutatedKeys=yt(),this.Aa=NT(t),this.Ra=new Yo(this.Aa)}get Va(){return this.Ta}ma(t,e){const i=e?e.fa:new tw,r=e?e.Ra:this.Ra;let s=e?e.mutatedKeys:this.mutatedKeys,a=r,l=!1;const h=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,f=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((_,g)=>{const w=r.get(_),E=Gl(this.query,g)?g:null,x=!!w&&this.mutatedKeys.has(w.key),R=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let z=!1;w&&E?w.data.isEqual(E.data)?x!==R&&(i.track({type:3,doc:E}),z=!0):this.ga(w,E)||(i.track({type:2,doc:E}),z=!0,(h&&this.Aa(E,h)>0||f&&this.Aa(E,f)<0)&&(l=!0)):!w&&E?(i.track({type:0,doc:E}),z=!0):w&&!E&&(i.track({type:1,doc:w}),z=!0,(h||f)&&(l=!0)),z&&(E?(a=a.add(E),s=R?s.add(_):s.delete(_)):(a=a.delete(_),s=s.delete(_)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const _=this.query.limitType==="F"?a.last():a.first();a=a.delete(_.key),s=s.delete(_.key),i.track({type:1,doc:_})}return{Ra:a,fa:i,ns:l,mutatedKeys:s}}ga(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,r){const s=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const a=t.fa.G_();a.sort((_,g)=>function(E,x){const R=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt()}};return R(E)-R(x)}(_.type,g.type)||this.Aa(_.doc,g.doc)),this.pa(i),r=r!=null&&r;const l=e&&!r?this.ya():[],h=this.da.size===0&&this.current&&!r?1:0,f=h!==this.Ea;return this.Ea=h,a.length!==0||f?{snapshot:new ga(this.query,t.Ra,s,a,t.mutatedKeys,h===0,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new tw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=yt(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});const e=[];return t.forEach(i=>{this.da.has(i)||e.push(new zI(i))}),this.da.forEach(i=>{t.has(i)||e.push(new BI(i))}),e}ba(t){this.Ta=t.Ts,this.da=yt();const e=this.ma(t.documents);return this.applyChanges(e,!0)}Da(){return ga.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class BL{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class zL{constructor(t){this.key=t,this.va=!1}}class UL{constructor(t,e,i,r,s,a){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Xr(l=>VT(l),ql),this.Ma=new Map,this.xa=new Set,this.Oa=new Ut(et.comparator),this.Na=new Map,this.La=new k_,this.Ba={},this.ka=new Map,this.qa=$s.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function jL(n,t,e=!0){const i=Bd(n);let r;const s=i.Fa.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=await jI(i,t,e,!0),r}async function $L(n,t){const e=Bd(n);await jI(e,t,!0,!1)}async function jI(n,t,e,i){const r=await pa(n.localStore,nn(t)),s=r.targetId,a=n.sharedClientState.addLocalQueryTarget(s,e);let l;return i&&(l=await G_(n,t,s,a==="current",r.resumeToken)),n.isPrimaryClient&&e&&Fd(n.remoteStore,r),l}async function G_(n,t,e,i,r){n.Ka=(g,w,E)=>async function(R,z,A,S){let C=z.view.ma(A);C.ns&&(C=await ad(R.localStore,z.query,!1).then(({documents:k})=>z.view.ma(k,C)));const j=S&&S.targetChanges.get(z.targetId),H=S&&S.targetMismatches.get(z.targetId)!=null,Y=z.view.applyChanges(C,R.isPrimaryClient,j,H);return um(R,z.targetId,Y.wa),Y.snapshot}(n,g,w,E);const s=await ad(n.localStore,t,!0),a=new UI(t,s.Ts),l=a.ma(s.documents),h=Kl.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",r),f=a.applyChanges(l,n.isPrimaryClient,h);um(n,e,f.wa);const _=new BL(t,e,a);return n.Fa.set(t,_),n.Ma.has(e)?n.Ma.get(e).push(t):n.Ma.set(e,[t]),f.snapshot}async function qL(n,t,e){const i=nt(n),r=i.Fa.get(t),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(a=>!ql(a,t))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await ma(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),e&&_a(i.remoteStore,r.targetId),ya(i,r.targetId)}).catch(Qr)):(ya(i,r.targetId),await ma(i.localStore,r.targetId,!0))}async function GL(n,t){const e=nt(n),i=e.Fa.get(t),r=e.Ma.get(i.targetId);e.isPrimaryClient&&r.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),_a(e.remoteStore,i.targetId))}async function WL(n,t,e){const i=Z_(n);try{const r=await function(a,l){const h=nt(a),f=Yt.now(),_=l.reduce((E,x)=>E.add(x.key),yt());let g,w;return h.persistence.runTransaction("Locally write mutations","readwrite",E=>{let x=fn(),R=yt();return h.cs.getEntries(E,_).next(z=>{x=z,x.forEach((A,S)=>{S.isValidDocument()||(R=R.add(A))})}).next(()=>h.localDocuments.getOverlayedDocuments(E,x)).next(z=>{g=z;const A=[];for(const S of l){const C=_R(S,g.get(S.key).overlayedDocument);C!=null&&A.push(new Yi(S.key,C,ST(C.value.mapValue),Qt.exists(!0)))}return h.mutationQueue.addMutationBatch(E,f,A,l)}).next(z=>{w=z;const A=z.applyToLocalDocumentSet(g,R);return h.documentOverlayCache.saveOverlays(E,z.batchId,A)})}).then(()=>({batchId:w.batchId,changes:FT(g)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(a,l,h){let f=a.Ba[a.currentUser.toKey()];f||(f=new Ut(_t)),f=f.insert(l,h),a.Ba[a.currentUser.toKey()]=f}(i,r.batchId,e),await Xi(i,r.changes),await Ra(i.remoteStore)}catch(r){const s=ka(r,"Failed to persist write");e.reject(s)}}async function $I(n,t){const e=nt(n);try{const i=await cL(e.localStore,t);t.targetChanges.forEach((r,s)=>{const a=e.Na.get(s);a&&(ot(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.va=!0:r.modifiedDocuments.size>0?ot(a.va):r.removedDocuments.size>0&&(ot(a.va),a.va=!1))}),await Xi(e,i,t)}catch(i){await Qr(i)}}function rw(n,t,e){const i=nt(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const r=[];i.Fa.forEach((s,a)=>{const l=a.view.Z_(t);l.snapshot&&r.push(l.snapshot)}),function(a,l){const h=nt(a);h.onlineState=l;let f=!1;h.queries.forEach((_,g)=>{for(const w of g.j_)w.Z_(l)&&(f=!0)}),f&&$_(h)}(i.eventManager,t),r.length&&i.Ca.d_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function HL(n,t,e){const i=nt(n);i.sharedClientState.updateQueryState(t,"rejected",e);const r=i.Na.get(t),s=r&&r.key;if(s){let a=new Ut(et.comparator);a=a.insert(s,qt.newNoDocument(s,ut.min()));const l=yt().add(s),h=new Hl(ut.min(),new Map,new Ut(_t),a,l);await $I(i,h),i.Oa=i.Oa.remove(s),i.Na.delete(t),K_(i)}else await ma(i.localStore,t,!1).then(()=>ya(i,t,e)).catch(Qr)}async function KL(n,t){const e=nt(n),i=t.batch.batchId;try{const r=await lL(e.localStore,t);H_(e,i,null),W_(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await Xi(e,r)}catch(r){await Qr(r)}}async function ZL(n,t,e){const i=nt(n);try{const r=await function(a,l){const h=nt(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let _;return h.mutationQueue.lookupMutationBatch(f,l).next(g=>(ot(g!==null),_=g.keys(),h.mutationQueue.removeMutationBatch(f,g))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,_,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,_)).next(()=>h.localDocuments.getDocuments(f,_))})}(i.localStore,t);H_(i,t,e),W_(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await Xi(i,r)}catch(r){await Qr(r)}}async function QL(n,t){const e=nt(n);Jr(e.remoteStore)||Q("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await function(a){const l=nt(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(e.localStore);if(i===-1)return void t.resolve();const r=e.ka.get(i)||[];r.push(t),e.ka.set(i,r)}catch(i){const r=ka(i,"Initialization of waitForPendingWrites() operation failed");t.reject(r)}}function W_(n,t){(n.ka.get(t)||[]).forEach(e=>{e.resolve()}),n.ka.delete(t)}function H_(n,t,e){const i=nt(n);let r=i.Ba[i.currentUser.toKey()];if(r){const s=r.get(t);s&&(e?s.reject(e):s.resolve(),r=r.remove(t)),i.Ba[i.currentUser.toKey()]=r}}function ya(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Ma.get(t))n.Fa.delete(i),e&&n.Ca.$a(i,e);n.Ma.delete(t),n.isPrimaryClient&&n.La.gr(t).forEach(i=>{n.La.containsKey(i)||qI(n,i)})}function qI(n,t){n.xa.delete(t.path.canonicalString());const e=n.Oa.get(t);e!==null&&(_a(n.remoteStore,e),n.Oa=n.Oa.remove(t),n.Na.delete(e),K_(n))}function um(n,t,e){for(const i of e)i instanceof BI?(n.La.addReference(i.key,t),YL(n,i)):i instanceof zI?(Q("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,t),n.La.containsKey(i.key)||qI(n,i.key)):rt()}function YL(n,t){const e=t.key,i=e.path.canonicalString();n.Oa.get(e)||n.xa.has(i)||(Q("SyncEngine","New document in limbo: "+e),n.xa.add(i),K_(n))}function K_(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const t=n.xa.values().next().value;n.xa.delete(t);const e=new et(Pt.fromString(t)),i=n.qa.next();n.Na.set(i,new zL(e)),n.Oa=n.Oa.insert(e,i),Fd(n.remoteStore,new Bi(nn(Sa(e.path)),i,"TargetPurposeLimboResolution",hn.oe))}}async function Xi(n,t,e){const i=nt(n),r=[],s=[],a=[];i.Fa.isEmpty()||(i.Fa.forEach((l,h)=>{a.push(i.Ka(h,t,e).then(f=>{var _;if((f||e)&&i.isPrimaryClient){const g=f?!f.fromCache:(_=e==null?void 0:e.targetChanges.get(h.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(h.targetId,g?"current":"not-current")}if(f){r.push(f);const g=V_.Wi(h.targetId,f);s.push(g)}}))}),await Promise.all(a),i.Ca.d_(r),await async function(h,f){const _=nt(h);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>U.forEach(f,w=>U.forEach(w.$i,E=>_.persistence.referenceDelegate.addReference(g,w.targetId,E)).next(()=>U.forEach(w.Ui,E=>_.persistence.referenceDelegate.removeReference(g,w.targetId,E)))))}catch(g){if(!Yr(g))throw g;Q("LocalStore","Failed to update sequence numbers: "+g)}for(const g of f){const w=g.targetId;if(!g.fromCache){const E=_.os.get(w),x=E.snapshotVersion,R=E.withLastLimboFreeSnapshotVersion(x);_.os=_.os.insert(w,R)}}}(i.localStore,s))}async function XL(n,t){const e=nt(n);if(!e.currentUser.isEqual(t)){Q("SyncEngine","User change. New user:",t.toKey());const i=await PI(e.localStore,t);e.currentUser=t,function(s,a){s.ka.forEach(l=>{l.forEach(h=>{h.reject(new Z(G.CANCELLED,a))})}),s.ka.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await Xi(e,i.hs)}}function JL(n,t){const e=nt(n),i=e.Na.get(t);if(i&&i.va)return yt().add(i.key);{let r=yt();const s=e.Ma.get(t);if(!s)return r;for(const a of s){const l=e.Fa.get(a);r=r.unionWith(l.view.Va)}return r}}async function tk(n,t){const e=nt(n),i=await ad(e.localStore,t.query,!0),r=t.view.ba(i);return e.isPrimaryClient&&um(e,t.targetId,r.wa),r}async function ek(n,t){const e=nt(n);return CI(e.localStore,t).then(i=>Xi(e,i))}async function nk(n,t,e,i){const r=nt(n),s=await function(l,h){const f=nt(l),_=nt(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",g=>_.Mn(g,h).next(w=>w?f.localDocuments.getDocuments(g,w):U.resolve(null)))}(r.localStore,t);s!==null?(e==="pending"?await Ra(r.remoteStore):e==="acknowledged"||e==="rejected"?(H_(r,t,i||null),W_(r,t),function(l,h){nt(nt(l).mutationQueue).On(h)}(r.localStore,t)):rt(),await Xi(r,s)):Q("SyncEngine","Cannot apply mutation batch with id: "+t)}async function ik(n,t){const e=nt(n);if(Bd(e),Z_(e),t===!0&&e.Qa!==!0){const i=e.sharedClientState.getAllActiveQueryTargets(),r=await sw(e,i.toArray());e.Qa=!0,await om(e.remoteStore,!0);for(const s of r)Fd(e.remoteStore,s)}else if(t===!1&&e.Qa!==!1){const i=[];let r=Promise.resolve();e.Ma.forEach((s,a)=>{e.sharedClientState.isLocalQueryTarget(a)?i.push(a):r=r.then(()=>(ya(e,a),ma(e.localStore,a,!0))),_a(e.remoteStore,a)}),await r,await sw(e,i),function(a){const l=nt(a);l.Na.forEach((h,f)=>{_a(l.remoteStore,f)}),l.La.pr(),l.Na=new Map,l.Oa=new Ut(et.comparator)}(e),e.Qa=!1,await om(e.remoteStore,!1)}}async function sw(n,t,e){const i=nt(n),r=[],s=[];for(const a of t){let l;const h=i.Ma.get(a);if(h&&h.length!==0){l=await pa(i.localStore,nn(h[0]));for(const f of h){const _=i.Fa.get(f),g=await tk(i,_);g.snapshot&&s.push(g.snapshot)}}else{const f=await xI(i.localStore,a);l=await pa(i.localStore,f),await G_(i,GI(f),a,!1,l.resumeToken)}r.push(l)}return i.Ca.d_(s),r}function GI(n){return DT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function rk(n){return function(e){return nt(nt(e).persistence).Qi()}(nt(n).localStore)}async function sk(n,t,e,i){const r=nt(n);if(r.Qa)return void Q("SyncEngine","Ignoring unexpected query state notification.");const s=r.Ma.get(t);if(s&&s.length>0)switch(e){case"current":case"not-current":{const a=await CI(r.localStore,MT(s[0])),l=Hl.createSynthesizedRemoteEventForCurrentChange(t,e==="current",oe.EMPTY_BYTE_STRING);await Xi(r,a,l);break}case"rejected":await ma(r.localStore,t,!0),ya(r,t,i);break;default:rt()}}async function ok(n,t,e){const i=Bd(n);if(i.Qa){for(const r of t){if(i.Ma.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){Q("SyncEngine","Adding an already active target "+r);continue}const s=await xI(i.localStore,r),a=await pa(i.localStore,s);await G_(i,GI(s),a.targetId,!1,a.resumeToken),Fd(i.remoteStore,a)}for(const r of e)i.Ma.has(r)&&await ma(i.localStore,r,!1).then(()=>{_a(i.remoteStore,r),ya(i,r)}).catch(Qr)}}function Bd(n){const t=nt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=$I.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=JL.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=HL.bind(null,t),t.Ca.d_=ML.bind(null,t.eventManager),t.Ca.$a=NL.bind(null,t.eventManager),t}function Z_(n){const t=nt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=KL.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ZL.bind(null,t),t}function ak(n,t,e){const i=nt(n);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(E,x){const R=nt(E),z=ce(x.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",A=>R.Gr.getBundleMetadata(A,x.id)).then(A=>!!A&&A.createTime.compareTo(z)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(E){return{taskState:"Success",documentsLoaded:E.totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(FI(h));const f=new FL(h,s.localStore,a.serializer);let _=await a.Ua();for(;_;){const w=await f.la(_);w&&l._updateProgress(w),_=await a.Ua()}const g=await f.complete();return await Xi(s,g.Ia,void 0),await function(E,x){const R=nt(E);return R.persistence.runTransaction("Save bundle","readwrite",z=>R.Gr.saveBundleMetadata(z,x))}(s.localStore,h),l._completeWith(g.progress),Promise.resolve(g.Pa)}catch(h){return mi("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(i,t,e).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}class kl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Zl(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,e){return null}Ha(t,e){return null}za(t){return II(this.persistence,new TI,t.initialUser,this.serializer)}Ga(t){return new EI(Od.Zr,this.serializer)}Wa(t){return new LI}async terminate(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kl.provider={build:()=>new kl};class WI extends kl{constructor(t,e,i){super(),this.Ja=t,this.cacheSizeBytes=e,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await this.Ja.initialize(this,t),await Z_(this.Ja.syncEngine),await Ra(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(t){return II(this.persistence,new TI,t.initialUser,this.serializer)}ja(t,e){const i=this.persistence.referenceDelegate.garbageCollector;return new GR(i,t.asyncQueue,e)}Ha(t,e){const i=new AC(e,this.persistence);return new SC(t.asyncQueue,i)}Ga(t){const e=D_(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?un.withCacheSize(this.cacheSizeBytes):un.DEFAULT;return new b_(this.synchronizeTabs,e,t.clientId,i,t.asyncQueue,kI(),Sh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(t){return new LI}}class uk extends WI{constructor(t,e){super(t,e,!1),this.Ja=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}async initialize(t){await super.initialize(t);const e=this.Ja.syncEngine;this.sharedClientState instanceof $f&&(this.sharedClientState.syncEngine={no:nk.bind(null,e),ro:sk.bind(null,e),io:ok.bind(null,e),Qi:rk.bind(null,e),eo:ek.bind(null,e)},await this.sharedClientState.start()),await this.persistence.yi(async i=>{await ik(this.Ja.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())})}Wa(t){const e=kI();if(!$f.D(e))throw new Z(G.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=D_(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new $f(e,t.asyncQueue,i,t.clientId,t.initialUser)}}class bl{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>rw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=XL.bind(null,this.syncEngine),await om(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new VL}()}createDatastore(t){const e=Zl(t.databaseInfo.databaseId),i=function(s){return new gL(s)}(t.databaseInfo);return function(s,a,l,h){return new wL(s,a,l,h)}(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return function(i,r,s,a,l){return new TL(i,r,s,a,l)}(this.localStore,this.datastore,t.asyncQueue,e=>rw(this.syncEngine,e,0),function(){return Xv.D()?new Xv:new pL}())}createSyncEngine(t,e){return function(r,s,a,l,h,f,_){const g=new UL(r,s,a,l,h,f);return _&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(r){const s=nt(r);Q("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ca(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(e=this.eventManager)===null||e===void 0||e.terminate()}}bl.provider={build:()=>new bl};function ow(n,t=10240){let e=0;return{async read(){if(e<n.byteLength){const i={value:n.slice(e,e+t),done:!1};return e+=t,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):le("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,e){setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(t,e){this.Xa=t,this.serializer=e,this.metadata=new Be,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(i=>{i&&i.ua()?this.metadata.resolve(i.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.aa)}`))},i=>this.metadata.reject(i))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const t=await this.nu();if(t===null)return null;const e=this.eu.decode(t),i=Number(e);isNaN(i)&&this.ru(`length string (${e}) is not valid number`);const r=await this.iu(i);return new OL(JSON.parse(r),t.length+i)}su(){return this.buffer.findIndex(t=>t==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const t=this.su();t<0&&this.ru("Reached the end of bundle when a length string is expected.");const e=this.buffer.slice(0,t);return this.buffer=this.buffer.slice(t),e}async iu(t){for(;this.buffer.length<t;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const e=this.eu.decode(this.buffer.slice(0,t));return this.buffer=this.buffer.slice(t),e}ru(t){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${t}`)}async ou(){const t=await this.Xa.read();if(!t.done){const e=new Uint8Array(this.buffer.length+t.value.length);e.set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e}return t.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Z(G.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const e=await async function(r,s){const a=nt(r),l={documents:s.map(g=>Rl(a.serializer,g))},h=await a.Lo("BatchGetDocuments",a.serializer.databaseId,Pt.emptyPath(),l,s.length),f=new Map;h.forEach(g=>{const w=SR(a.serializer,g);f.set(w.key.toString(),w)});const _=[];return s.forEach(g=>{const w=f.get(g.toString());ot(!!w),_.push(w)}),_}(this.datastore,t);return e.forEach(i=>this.recordVersion(i)),e}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new xa(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((e,i)=>{const r=et.fromPath(i);this.mutations.push(new T_(r,this.precondition(r)))}),await async function(i,r){const s=nt(i),a={writes:r.map(l=>Ll(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,Pt.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw rt();e=ut.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!e.isEqual(i))throw new Z(G.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(ut.min())?Qt.exists(!1):Qt.updateTime(e):Qt.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ut.min()))throw new Z(G.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qt.updateTime(e)}return Qt.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(t,e,i,r,s){this.asyncQueue=t,this.datastore=e,this.options=i,this.updateFunction=r,this.deferred=s,this._u=i.maxAttempts,this.t_=new N_(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const t=new ck(this.datastore),e=this.cu(t);e&&e.then(i=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.lu(r)}))}).catch(i=>{this.lu(i)})})}cu(t){try{const e=this.updateFunction(t);return!jl(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}lu(t){this._u>0&&this.hu(t)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(t)}hu(t){if(t.name==="FirebaseError"){const e=t.code;return e==="aborted"||e==="failed-precondition"||e==="already-exists"||!KT(e)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(t,e,i,r,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=r,this.user=ke.UNAUTHENTICATED,this.clientId=lT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async a=>{Q("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(Q("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Be;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=ka(e,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function Gf(n,t){n.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await PI(t.localStore,r),i=r)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function aw(n,t){n.asyncQueue.verifyOperationInProgress();const e=await Q_(n);Q("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(i=>Jv(t.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>Jv(t.remoteStore,r)),n._onlineComponents=t}async function Q_(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await Gf(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!function(r){return r.name==="FirebaseError"?r.code===G.FAILED_PRECONDITION||r.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(e))throw e;mi("Error using user provided cache. Falling back to memory cache: "+e),await Gf(n,new kl)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await Gf(n,new kl);return n._offlineComponents}async function Ud(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await aw(n,n._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await aw(n,new bl))),n._onlineComponents}function HI(n){return Q_(n).then(t=>t.persistence)}function Y_(n){return Q_(n).then(t=>t.localStore)}function KI(n){return Ud(n).then(t=>t.remoteStore)}function X_(n){return Ud(n).then(t=>t.syncEngine)}function fk(n){return Ud(n).then(t=>t.datastore)}async function va(n){const t=await Ud(n),e=t.eventManager;return e.onListen=jL.bind(null,t.syncEngine),e.onUnlisten=qL.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=$L.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=GL.bind(null,t.syncEngine),e}function pk(n){return n.asyncQueue.enqueue(async()=>{const t=await HI(n),e=await KI(n);return t.setNetworkEnabled(!0),function(r){const s=nt(r);return s.L_.delete(0),Ql(s)}(e)})}function mk(n){return n.asyncQueue.enqueue(async()=>{const t=await HI(n),e=await KI(n);return t.setNetworkEnabled(!1),async function(r){const s=nt(r);s.L_.add(0),await Ca(s),s.q_.set("Offline")}(e)})}function _k(n,t){const e=new Be;return n.asyncQueue.enqueueAndForget(async()=>async function(r,s,a){try{const l=await function(f,_){const g=nt(f);return g.persistence.runTransaction("read document","readonly",w=>g.localDocuments.getDocument(w,_))}(r,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new Z(G.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=ka(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await Y_(n),t,e)),e.promise}function ZI(n,t,e={}){const i=new Be;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const _=new zd({next:w=>{_.Za(),a.enqueueAndForget(()=>j_(s,g));const E=w.docs.has(l);!E&&w.fromCache?f.reject(new Z(G.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&w.fromCache&&h&&h.source==="server"?f.reject(new Z(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(w)},error:w=>f.reject(w)}),g=new q_(Sa(l.path),_,{includeMetadataChanges:!0,_a:!0});return U_(s,g)}(await va(n),n.asyncQueue,t,e,i)),i.promise}function gk(n,t){const e=new Be;return n.asyncQueue.enqueueAndForget(async()=>async function(r,s,a){try{const l=await ad(r,s,!0),h=new UI(s,l.Ts),f=h.ma(l.documents),_=h.applyChanges(f,!1);a.resolve(_.snapshot)}catch(l){const h=ka(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Y_(n),t,e)),e.promise}function QI(n,t,e={}){const i=new Be;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const _=new zd({next:w=>{_.Za(),a.enqueueAndForget(()=>j_(s,g)),w.fromCache&&h.source==="server"?f.reject(new Z(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(w)},error:w=>f.reject(w)}),g=new q_(l,_,{includeMetadataChanges:!0,_a:!0});return U_(s,g)}(await va(n),n.asyncQueue,t,e,i)),i.promise}function yk(n,t){const e=new zd(t);return n.asyncQueue.enqueueAndForget(async()=>function(r,s){nt(r).Y_.add(s),s.next()}(await va(n),e)),()=>{e.Za(),n.asyncQueue.enqueueAndForget(async()=>function(r,s){nt(r).Y_.delete(s)}(await va(n),e))}}function vk(n,t,e,i){const r=function(a,l){let h;return h=typeof a=="string"?QT().encode(a):a,function(_,g){return new lk(_,g)}(function(_,g){if(_ instanceof Uint8Array)return ow(_,g);if(_ instanceof ArrayBuffer)return ow(new Uint8Array(_),g);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(e,Zl(t));n.asyncQueue.enqueueAndForget(async()=>{ak(await X_(n),r,i)})}function wk(n,t){return n.asyncQueue.enqueue(async()=>function(i,r){const s=nt(i);return s.persistence.runTransaction("Get named query","readonly",a=>s.Gr.getNamedQuery(a,r))}(await Y_(n),t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(n,t,e){if(!e)throw new Z(G.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function XI(n,t,e,i){if(t===!0&&i===!0)throw new Z(G.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function lw(n){if(!et.isDocumentKey(n))throw new Z(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cw(n){if(et.isDocumentKey(n))throw new Z(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function jd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":rt()}function kt(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Z(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=jd(n);throw new Z(G.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function JI(n,t){if(t<=0)throw new Z(G.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(t){var e,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Z(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Z(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}XI("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=YI((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Yl{constructor(t,e,i,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Z(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hw(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new pC;switch(i.type){case"firstParty":return new yC(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Z(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=uw.get(e);i&&(Q("ComponentProvider","Removing Datastore"),uw.delete(e),i.terminate())}(this),Promise.resolve()}}function Ek(n,t,e,i={}){var r;const s=(n=kt(n,Yl))._getSettings(),a=`${t}:${e}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&mi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let l,h;if(typeof i.mockUserToken=="string")l=i.mockUserToken,h=ke.MOCK_USER;else{l=VA(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new Z(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ke(f)}n._authCredentials=new mC(new uT(l,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rn=class t1{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new t1(this.firestore,t,this._query)}},ne=class e1{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new e1(this.firestore,t,this._key)}},Vr=class n1 extends rn{constructor(t,e,i){super(t,e,Sa(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ne(this.firestore,null,new et(t))}withConverter(t){return new n1(this.firestore,t,this._path)}};function i1(n,t,...e){if(n=ye(n),J_("collection","path",t),n instanceof Yl){const i=Pt.fromString(t,...e);return cw(i),new Vr(n,null,i)}{if(!(n instanceof ne||n instanceof Vr))throw new Z(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Pt.fromString(t,...e));return cw(i),new Vr(n.firestore,null,i)}}function Tk(n,t){if(n=kt(n,Yl),J_("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Z(G.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new rn(n,null,function(i){return new Qi(Pt.emptyPath(),i)}(t))}function hd(n,t,...e){if(n=ye(n),arguments.length===1&&(t=lT.newId()),J_("doc","path",t),n instanceof Yl){const i=Pt.fromString(t,...e);return lw(i),new ne(n,null,new et(i))}{if(!(n instanceof ne||n instanceof Vr))throw new Z(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Pt.fromString(t,...e));return lw(i),new ne(n.firestore,n instanceof Vr?n.converter:null,new et(i))}}function r1(n,t){return n=ye(n),t=ye(t),(n instanceof ne||n instanceof Vr)&&(t instanceof ne||t instanceof Vr)&&n.firestore===t.firestore&&n.path===t.path&&n.converter===t.converter}function s1(n,t){return n=ye(n),t=ye(t),n instanceof rn&&t instanceof rn&&n.firestore===t.firestore&&ql(n._query,t._query)&&n.converter===t.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new N_(this,"async_queue_retry"),this.Vu=()=>{const i=Sh();i&&Q("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=t;const e=Sh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const e=Sh();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const e=new Be;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Yr(t))throw t;Q("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const e=this.mu.then(()=>(this.du=!0,t().catch(i=>{this.Eu=i,this.du=!1;const r=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(i);throw le("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=e,e}enqueueAfterDelay(t,e,i){this.fu(),this.Ru.indexOf(t)>-1&&(e=0);const r=z_.createAndSchedule(this,t,e,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&rt()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const e of this.Tu)if(e.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(const e of this.Tu)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const e=this.Tu.indexOf(t);this.Tu.splice(e,1)}}function lm(n){return function(e,i){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}class Ik{constructor(){this._progressObserver={},this._taskCompletionResolver=new Be,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,i){this._progressObserver={next:t,error:e,complete:i}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=-1;let he=class extends Yl{constructor(t,e,i,r){super(t,e,i,r),this.type="firestore",this._queue=new dw,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new dw(t),this._firestoreClient=void 0,await t}}};function Ze(n){if(n._terminated)throw new Z(G.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||o1(n),n._firestoreClient}function o1(n){var t,e,i;const r=n._freezeSettings(),s=function(l,h,f,_){return new KC(l,h,f,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,YI(_.experimentalLongPollingOptions),_.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((e=r.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new dk(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const h=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(h),_online:h}}(n._componentsProvider))}function Sk(n,t){mi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();return a1(n,bl.provider,{build:i=>new WI(i,e.cacheSizeBytes,t==null?void 0:t.forceOwnership)}),Promise.resolve()}async function Ak(n){mi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();a1(n,bl.provider,{build:e=>new uk(e,t.cacheSizeBytes)})}function a1(n,t,e){if((n=kt(n,he))._firestoreClient||n._terminated)throw new Z(G.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Z(G.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:t,_offline:e},o1(n)}function xk(n){if(n._initialized&&!n._terminated)throw new Z(G.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Be;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(i){if(!fi.D())return Promise.resolve();const r=i+"main";await fi.delete(r)}(D_(n._databaseId,n._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}function Ck(n){return function(e){const i=new Be;return e.asyncQueue.enqueueAndForget(async()=>QL(await X_(e),i)),i.promise}(Ze(n=kt(n,he)))}function Rk(n){return pk(Ze(n=kt(n,he)))}function Lk(n){return mk(Ze(n=kt(n,he)))}function kk(n,t){const e=Ze(n=kt(n,he)),i=new Ik;return vk(e,n._databaseId,t,i),i}function bk(n,t){return wk(Ze(n=kt(n,he)),t).then(e=>e?new rn(n,null,e.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(t){this._byteString=t}static fromBase64String(t){try{return new gi(oe.fromBase64String(t))}catch(e){throw new Z(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new gi(oe.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gr=class{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new Z(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zs=class{constructor(t){this._methodName=t}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Z(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Z(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return _t(this._lat,t._lat)||_t(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=/^__.*__$/;class Vk{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new Yi(t,this.data,this.fieldMask,e,this.fieldTransforms):new Aa(t,this.data,e,this.fieldTransforms)}}class u1{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new Yi(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function l1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt()}}class qd{constructor(t,e,i,r,s,a){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new qd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),r=this.Fu({path:i,xu:!1});return r.Ou(t),r}Nu(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return dd(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(l1(this.Cu)&&Dk.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class Mk{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||Zl(t)}Qu(t,e,i,r=!1){return new qd({Cu:t,methodName:e,qu:i,path:Zt.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qs(n){const t=n._freezeSettings(),e=Zl(n._databaseId);return new Mk(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Gd(n,t,e,i,r,s={}){const a=n.Qu(s.merge||s.mergeFields?2:0,t,e,r);ag("Data must be an object, but it was:",a,i);const l=d1(i,a);let h,f;if(s.merge)h=new dn(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const _=[];for(const g of s.mergeFields){const w=cm(t,g,e);if(!a.contains(w))throw new Z(G.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);p1(_,w)||_.push(w)}h=new dn(_),f=a.fieldTransforms.filter(g=>h.covers(g.field))}else h=null,f=a.fieldTransforms;return new Vk(new Oe(l),h,f)}class Xl extends Zs{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Xl}}function c1(n,t,e){return new qd({Cu:3,qu:t.settings.qu,methodName:n._methodName,xu:e},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class eg extends Zs{_toFieldTransform(t){return new Wl(t.path,new ha)}isEqual(t){return t instanceof eg}}class ng extends Zs{constructor(t,e){super(t),this.Ku=e}_toFieldTransform(t){const e=c1(this,t,!0),i=this.Ku.map(s=>Ys(s,e)),r=new Bs(i);return new Wl(t.path,r)}isEqual(t){return t instanceof ng&&yl(this.Ku,t.Ku)}}class ig extends Zs{constructor(t,e){super(t),this.Ku=e}_toFieldTransform(t){const e=c1(this,t,!0),i=this.Ku.map(s=>Ys(s,e)),r=new zs(i);return new Wl(t.path,r)}isEqual(t){return t instanceof ig&&yl(this.Ku,t.Ku)}}class rg extends Zs{constructor(t,e){super(t),this.$u=e}_toFieldTransform(t){const e=new da(t.serializer,UT(t.serializer,this.$u));return new Wl(t.path,e)}isEqual(t){return t instanceof rg&&this.$u===t.$u}}function sg(n,t,e,i){const r=n.Qu(1,t,e);ag("Data must be an object, but it was:",r,i);const s=[],a=Oe.empty();Ks(i,(h,f)=>{const _=ug(t,h,e);f=ye(f);const g=r.Nu(_);if(f instanceof Xl)s.push(_);else{const w=Ys(f,g);w!=null&&(s.push(_),a.set(_,w))}});const l=new dn(s);return new u1(a,l,r.fieldTransforms)}function og(n,t,e,i,r,s){const a=n.Qu(1,t,e),l=[cm(t,i,e)],h=[r];if(s.length%2!=0)throw new Z(G.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)l.push(cm(t,s[w])),h.push(s[w+1]);const f=[],_=Oe.empty();for(let w=l.length-1;w>=0;--w)if(!p1(f,l[w])){const E=l[w];let x=h[w];x=ye(x);const R=a.Nu(E);if(x instanceof Xl)f.push(E);else{const z=Ys(x,R);z!=null&&(f.push(E),_.set(E,z))}}const g=new dn(f);return new u1(_,g,a.fieldTransforms)}function h1(n,t,e,i=!1){return Ys(e,n.Qu(i?4:3,t))}function Ys(n,t){if(f1(n=ye(n)))return ag("Unsupported field value:",t,n),d1(n,t);if(n instanceof Zs)return function(i,r){if(!l1(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(i,r){const s=[];let a=0;for(const l of i){let h=Ys(l,r.Lu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,t)}return function(i,r){if((i=ye(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return UT(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Yt.fromDate(i);return{timestampValue:fa(r.serializer,s)}}if(i instanceof Yt){const s=new Yt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:fa(r.serializer,s)}}if(i instanceof $d)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof gi)return{bytesValue:JT(r.serializer,i._byteString)};if(i instanceof ne){const s=r.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw r.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:x_(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof tg)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw l.Bu("VectorValues must only contain numeric values.");return E_(l.serializer,h)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${jd(i)}`)}(n,t)}function d1(n,t){const e={};return ET(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ks(n,(i,r)=>{const s=Ys(r,t.Mu(i));s!=null&&(e[i]=s)}),{mapValue:{fields:e}}}function f1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Yt||n instanceof $d||n instanceof gi||n instanceof ne||n instanceof Zs||n instanceof tg)}function ag(n,t,e){if(!f1(e)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(e)){const i=jd(e);throw i==="an object"?t.Bu(n+" a custom object"):t.Bu(n+" "+i)}}function cm(n,t,e){if((t=ye(t))instanceof Gr)return t._internalPath;if(typeof t=="string")return ug(n,t);throw dd("Field path arguments must be of type string or ",n,!1,void 0,e)}const Nk=new RegExp("[~\\*/\\[\\]]");function ug(n,t,e){if(t.search(Nk)>=0)throw dd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Gr(...t.split("."))._internalPath}catch{throw dd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function dd(n,t,e,i,r){const s=i&&!i.isEmpty(),a=r!==void 0;let l=`Function ${t}() called with invalid data`;e&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${i}`),a&&(h+=` in document ${r}`),h+=")"),new Z(G.INVALID_ARGUMENT,l+n+h)}function p1(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(t,e,i,r,s){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Ok(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Wd("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class Ok extends Dl{data(){return super.data()}}function Wd(n,t){return typeof t=="string"?ug(n,t):t instanceof Gr?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Z(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lg{}class Jl extends lg{}function mr(n,t,...e){let i=[];t instanceof lg&&i.push(t),i=i.concat(e),function(s){const a=s.filter(h=>h instanceof cg).length,l=s.filter(h=>h instanceof Hd).length;if(a>1||a>0&&l>0)throw new Z(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class Hd extends Jl{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new Hd(t,e,i)}_apply(t){const e=this._parse(t);return g1(t._query,e),new rn(t.firestore,t.converter,Yp(t._query,e))}_parse(t){const e=Qs(t.firestore);return function(s,a,l,h,f,_,g){let w;if(f.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Z(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){pw(g,_);const E=[];for(const x of g)E.push(fw(h,s,x));w={arrayValue:{values:E}}}else w=fw(h,s,g)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||pw(g,_),w=h1(l,a,g,_==="in"||_==="not-in");return St.create(f,_,w)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function Fk(n,t,e){const i=t,r=Wd("where",n);return Hd._create(r,i,e)}class cg extends lg{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new cg(t,e)}_parse(t){const e=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return e.length===1?e[0]:Vt.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(r,s){let a=r;const l=s.getFlattenedFilters();for(const h of l)g1(a,h),a=Yp(a,h)}(t._query,e),new rn(t.firestore,t.converter,Yp(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hg extends Jl{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new hg(t,e)}_apply(t){const e=function(r,s,a){if(r.startAt!==null)throw new Z(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Z(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cl(s,a)}(t._query,this._field,this._direction);return new rn(t.firestore,t.converter,function(r,s){const a=r.explicitOrderBy.concat([s]);return new Qi(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function Bk(n,t="asc"){const e=t,i=Wd("orderBy",n);return hg._create(i,e)}class Kd extends Jl{constructor(t,e,i){super(),this.type=t,this._limit=e,this._limitType=i}static _create(t,e,i){return new Kd(t,e,i)}_apply(t){return new rn(t.firestore,t.converter,id(t._query,this._limit,this._limitType))}}function zk(n){return JI("limit",n),Kd._create("limit",n,"F")}function Uk(n){return JI("limitToLast",n),Kd._create("limitToLast",n,"L")}class Zd extends Jl{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new Zd(t,e,i)}_apply(t){const e=_1(t,this.type,this._docOrFields,this._inclusive);return new rn(t.firestore,t.converter,function(r,s){return new Qi(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(t._query,e))}}function jk(...n){return Zd._create("startAt",n,!0)}function $k(...n){return Zd._create("startAfter",n,!1)}class Qd extends Jl{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new Qd(t,e,i)}_apply(t){const e=_1(t,this.type,this._docOrFields,this._inclusive);return new rn(t.firestore,t.converter,function(r,s){return new Qi(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(t._query,e))}}function qk(...n){return Qd._create("endBefore",n,!1)}function Gk(...n){return Qd._create("endAt",n,!0)}function _1(n,t,e,i){if(e[0]=ye(e[0]),e[0]instanceof Dl)return function(s,a,l,h,f){if(!h)throw new Z(G.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const _=[];for(const g of Qo(s))if(g.field.isKeyField())_.push(Os(a,h.key));else{const w=h.data.field(g.field);if(kd(w))throw new Z(G.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(w===null){const E=g.field.canonicalString();throw new Z(G.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}_.push(w)}return new $r(_,f)}(n._query,n.firestore._databaseId,t,e[0]._document,i);{const r=Qs(n.firestore);return function(a,l,h,f,_,g){const w=a.explicitOrderBy;if(_.length>w.length)throw new Z(G.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let x=0;x<_.length;x++){const R=_[x];if(w[x].field.isKeyField()){if(typeof R!="string")throw new Z(G.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof R}`);if(!v_(a)&&R.indexOf("/")!==-1)throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${R}' contains a slash.`);const z=a.path.child(Pt.fromString(R));if(!et.isDocumentKey(z))throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${z}' is not because it contains an odd number of segments.`);const A=new et(z);E.push(Os(l,A))}else{const z=h1(h,f,R);E.push(z)}}return new $r(E,g)}(n._query,n.firestore._databaseId,r,t,e,i)}}function fw(n,t,e){if(typeof(e=ye(e))=="string"){if(e==="")throw new Z(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v_(t)&&e.indexOf("/")!==-1)throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(Pt.fromString(e));if(!et.isDocumentKey(i))throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Os(n,new et(i))}if(e instanceof ne)return Os(n,e._key);throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jd(e)}.`)}function pw(n,t){if(!Array.isArray(n)||n.length===0)throw new Z(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function g1(n,t){const e=function(r,s){for(const a of r)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new Z(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Z(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class dg{convertValue(t,e="none"){switch(Ns(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ht(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(zr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw rt()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return Ks(t,(r,s)=>{i[r]=this.convertValue(s,e)}),i}convertVectorValue(t){var e,i,r;const s=(r=(i=(e=t.fields)===null||e===void 0?void 0:e.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(a=>Ht(a.doubleValue));return new tg(s)}convertGeoPoint(t){return new $d(Ht(t.latitude),Ht(t.longitude))}convertArray(t,e){return(t.values||[]).map(i=>this.convertValue(i,e))}convertServerTimestamp(t,e){switch(e){case"previous":const i=g_(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Sl(t));default:return null}}convertTimestamp(t){const e=Hi(t);return new Yt(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=Pt.fromString(t);ot(cI(i));const r=new Ur(i.get(1),i.get(3)),s=new et(i.popFirst(5));return r.isEqual(e)||le(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}class Wk extends dg{constructor(t){super(),this.firestore=t}convertBytes(t){return new gi(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ne(this.firestore,null,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}let Ki=class extends Dl{constructor(t,e,i,r,s,a){super(t,e,i,r,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new tl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(Wd("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}},tl=class extends Ki{data(t={}){return super.data(t)}},Wr=class{constructor(t,e,i,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Ss(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(i=>{t.call(e,new tl(this._firestore,this._userDataWriter,i.key,i,new Ss(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Z(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>{const h=new tl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ss(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new tl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ss(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let f=-1,_=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),_=a.indexOf(l.doc.key)),{type:Hk(l.type),doc:h,oldIndex:f,newIndex:_}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}};function Hk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt()}}function y1(n,t){return n instanceof Ki&&t instanceof Ki?n._firestore===t._firestore&&n._key.isEqual(t._key)&&(n._document===null?t._document===null:n._document.isEqual(t._document))&&n._converter===t._converter:n instanceof Wr&&t instanceof Wr&&n._firestore===t._firestore&&s1(n.query,t.query)&&n.metadata.isEqual(t.metadata)&&n._snapshot.isEqual(t._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(n){n=kt(n,ne);const t=kt(n.firestore,he);return ZI(Ze(t),n._key).then(e=>fg(t,n,e))}class Xs extends dg{constructor(t){super(),this.firestore=t}convertBytes(t){return new gi(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ne(this.firestore,null,e)}}function Zk(n){n=kt(n,ne);const t=kt(n.firestore,he),e=Ze(t),i=new Xs(t);return _k(e,n._key).then(r=>new Ki(t,i,n._key,r,new Ss(r!==null&&r.hasLocalMutations,!0),n.converter))}function Qk(n){n=kt(n,ne);const t=kt(n.firestore,he);return ZI(Ze(t),n._key,{source:"server"}).then(e=>fg(t,n,e))}function Yk(n){n=kt(n,rn);const t=kt(n.firestore,he),e=Ze(t),i=new Xs(t);return m1(n._query),QI(e,n._query).then(r=>new Wr(t,i,n,r))}function Xk(n){n=kt(n,rn);const t=kt(n.firestore,he),e=Ze(t),i=new Xs(t);return gk(e,n._query).then(r=>new Wr(t,i,n,r))}function Jk(n){n=kt(n,rn);const t=kt(n.firestore,he),e=Ze(t),i=new Xs(t);return QI(e,n._query,{source:"server"}).then(r=>new Wr(t,i,n,r))}function mw(n,t,e){n=kt(n,ne);const i=kt(n.firestore,he),r=Yd(n.converter,t,e);return tc(i,[Gd(Qs(i),"setDoc",n._key,r,n.converter!==null,e).toMutation(n._key,Qt.none())])}function _w(n,t,e,...i){n=kt(n,ne);const r=kt(n.firestore,he),s=Qs(r);let a;return a=typeof(t=ye(t))=="string"||t instanceof Gr?og(s,"updateDoc",n._key,t,e,i):sg(s,"updateDoc",n._key,t),tc(r,[a.toMutation(n._key,Qt.exists(!0))])}function tb(n){return tc(kt(n.firestore,he),[new xa(n._key,Qt.none())])}function eb(n,t){const e=kt(n.firestore,he),i=hd(n),r=Yd(n.converter,t);return tc(e,[Gd(Qs(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Qt.exists(!1))]).then(()=>i)}function v1(n,...t){var e,i,r;n=ye(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof t[a]!="object"||lm(t[a])||(s=t[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(lm(t[a])){const g=t[a];t[a]=(e=g.next)===null||e===void 0?void 0:e.bind(g),t[a+1]=(i=g.error)===null||i===void 0?void 0:i.bind(g),t[a+2]=(r=g.complete)===null||r===void 0?void 0:r.bind(g)}let h,f,_;if(n instanceof ne)f=kt(n.firestore,he),_=Sa(n._key.path),h={next:g=>{t[a]&&t[a](fg(f,n,g))},error:t[a+1],complete:t[a+2]};else{const g=kt(n,rn);f=kt(g.firestore,he),_=g._query;const w=new Xs(f);h={next:E=>{t[a]&&t[a](new Wr(f,w,g,E))},error:t[a+1],complete:t[a+2]},m1(n._query)}return function(w,E,x,R){const z=new zd(R),A=new q_(E,z,x);return w.asyncQueue.enqueueAndForget(async()=>U_(await va(w),A)),()=>{z.Za(),w.asyncQueue.enqueueAndForget(async()=>j_(await va(w),A))}}(Ze(f),_,l,h)}function nb(n,t){return yk(Ze(n=kt(n,he)),lm(t)?t:{next:t})}function tc(n,t){return function(i,r){const s=new Be;return i.asyncQueue.enqueueAndForget(async()=>WL(await X_(i),r,s)),s.promise}(Ze(n),t)}function fg(n,t,e){const i=e.docs.get(t._key),r=new Xs(n);return new Ki(n,r,t._key,i,new Ss(e.hasPendingWrites,e.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rb=class{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Qs(t)}set(t,e,i){this._verifyNotCommitted();const r=Er(t,this._firestore),s=Yd(r.converter,e,i),a=Gd(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(a.toMutation(r._key,Qt.none())),this}update(t,e,i,...r){this._verifyNotCommitted();const s=Er(t,this._firestore);let a;return a=typeof(e=ye(e))=="string"||e instanceof Gr?og(this._dataReader,"WriteBatch.update",s._key,e,i,r):sg(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(a.toMutation(s._key,Qt.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=Er(t,this._firestore);return this._mutations=this._mutations.concat(new xa(e._key,Qt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Z(G.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Er(n,t){if((n=ye(n)).firestore!==t)throw new Z(G.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sb=class extends class{constructor(e,i){this._firestore=e,this._transaction=i,this._dataReader=Qs(e)}get(e){const i=Er(e,this._firestore),r=new Wk(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||s.length!==1)return rt();const a=s[0];if(a.isFoundDocument())return new Dl(this._firestore,r,a.key,a,i.converter);if(a.isNoDocument())return new Dl(this._firestore,r,i._key,null,i.converter);throw rt()})}set(e,i,r){const s=Er(e,this._firestore),a=Yd(s.converter,i,r),l=Gd(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,r);return this._transaction.set(s._key,l),this}update(e,i,r,...s){const a=Er(e,this._firestore);let l;return l=typeof(i=ye(i))=="string"||i instanceof Gr?og(this._dataReader,"Transaction.update",a._key,i,r,s):sg(this._dataReader,"Transaction.update",a._key,i),this._transaction.update(a._key,l),this}delete(e){const i=Er(e,this._firestore);return this._transaction.delete(i._key),this}}{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=Er(t,this._firestore),i=new Xs(this._firestore);return super.get(t).then(r=>new Ki(this._firestore,i,e._key,r._document,new Ss(!1,!1),e.converter))}};function ob(n,t,e){n=kt(n,he);const i=Object.assign(Object.assign({},ib),e);return function(s){if(s.maxAttempts<1)throw new Z(G.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,a,l){const h=new Be;return s.asyncQueue.enqueueAndForget(async()=>{const f=await fk(s);new hk(s.asyncQueue,f,l,a,h).au()}),h.promise}(Ze(n),r=>t(new sb(n,r)),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(){return new Xl("deleteField")}function ub(){return new eg("serverTimestamp")}function lb(...n){return new ng("arrayUnion",n)}function cb(...n){return new ig("arrayRemove",n)}function hb(n){return new rg("increment",n)}(function(t,e=!0){(function(r){Pa=r})(c_),aa(new Ms("firestore",(i,{instanceIdentifier:r,options:s})=>{const a=i.getProvider("app").getImmediate(),l=new he(new _C(i.getProvider("auth-internal")),new wC(i.getProvider("app-check-internal")),function(f,_){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Z(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ur(f.options.projectId,_)}(a,r),a);return s=Object.assign({useFetchStreams:e},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Ui(sv,"4.7.3",t),Ui(sv,"4.7.3","esm2017")})();const db="@firebase/firestore-compat",fb="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(n,t){if(t===void 0)return{merge:!1};if(t.mergeFields!==void 0&&t.merge!==void 0)throw new Z("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(){if(typeof Uint8Array>"u")throw new Z("unimplemented","Uint8Arrays are not available in this environment.")}function yw(){if(!WC())throw new Z("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Vl{constructor(t){this._delegate=t}static fromBase64String(t){return yw(),new Vl(gi.fromBase64String(t))}static fromUint8Array(t){return gw(),new Vl(gi.fromUint8Array(t))}toBase64(){return yw(),this._delegate.toBase64()}toUint8Array(){return gw(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(n){return pb(n,["next","error","complete"])}function pb(n,t){if(typeof n!="object"||n===null)return!1;const e=n;for(const i of t)if(i in e&&typeof e[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{enableIndexedDbPersistence(t,e){return Sk(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return Ak(t._delegate)}clearIndexedDbPersistence(t){return xk(t._delegate)}}class w1{constructor(t,e,i){this._delegate=e,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},t instanceof Ur||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){const e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&mi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&(t=Object.assign(Object.assign({},e),t),delete t.merge),this._delegate._setSettings(t)}useEmulator(t,e,i={}){Ek(this._delegate,t,e,i)}enableNetwork(){return Rk(this._delegate)}disableNetwork(){return Lk(this._delegate)}enablePersistence(t){let e=!1,i=!1;return t&&(e=!!t.synchronizeTabs,i=!!t.experimentalForceOwningTab,XI("synchronizeTabs",e,"experimentalForceOwningTab",i)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Ck(this._delegate)}onSnapshotsInSync(t){return nb(this._delegate,t)}get app(){if(!this._appCompat)throw new Z("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new wa(this,i1(this._delegate,t))}catch(e){throw Je(e,"collection()","Firestore.collection()")}}doc(t){try{return new Mn(this,hd(this._delegate,t))}catch(e){throw Je(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new Xe(this,Tk(this._delegate,t))}catch(e){throw Je(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return ob(this._delegate,e=>t(new E1(this,e)))}batch(){return Ze(this._delegate),new T1(new rb(this._delegate,t=>tc(this._delegate,t)))}loadBundle(t){return kk(this._delegate,t)}namedQuery(t){return bk(this._delegate,t).then(e=>e?new Xe(this,e):null)}}class Xd extends dg{constructor(t){super(),this.firestore=t}convertBytes(t){return new Vl(new gi(t))}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return Mn.forKey(e,this.firestore,null)}}function _b(n){dC(n)}class E1{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Xd(t)}get(t){const e=As(t);return this._delegate.get(e).then(i=>new Ml(this._firestore,new Ki(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,e.converter)))}set(t,e,i){const r=As(t);return i?(pg("Transaction.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){const s=As(t);return arguments.length===2?this._delegate.update(s,e):this._delegate.update(s,e,i,...r),this}delete(t){const e=As(t);return this._delegate.delete(e),this}}class T1{constructor(t){this._delegate=t}set(t,e,i){const r=As(t);return i?(pg("WriteBatch.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){const s=As(t);return arguments.length===2?this._delegate.update(s,e):this._delegate.update(s,e,i,...r),this}delete(t){const e=As(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}}class qs{constructor(t,e,i){this._firestore=t,this._userDataWriter=e,this._delegate=i}fromFirestore(t,e){const i=new tl(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Nl(this._firestore,i),e??{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){const i=qs.INSTANCES;let r=i.get(t);r||(r=new WeakMap,i.set(t,r));let s=r.get(e);return s||(s=new qs(t,new Xd(t),e),r.set(e,s)),s}}qs.INSTANCES=new WeakMap;class Mn{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Xd(t)}static forPath(t,e,i){if(t.length%2!==0)throw new Z("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new Mn(e,new ne(e._delegate,i,new et(t)))}static forKey(t,e,i){return new Mn(e,new ne(e._delegate,i,t))}get id(){return this._delegate.id}get parent(){return new wa(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new wa(this.firestore,i1(this._delegate,t))}catch(e){throw Je(e,"collection()","DocumentReference.collection()")}}isEqual(t){return t=ye(t),t instanceof ne?r1(this._delegate,t):!1}set(t,e){e=pg("DocumentReference.set",e);try{return e?mw(this._delegate,t,e):mw(this._delegate,t)}catch(i){throw Je(i,"setDoc()","DocumentReference.set()")}}update(t,e,...i){try{return arguments.length===1?_w(this._delegate,t):_w(this._delegate,t,e,...i)}catch(r){throw Je(r,"updateDoc()","DocumentReference.update()")}}delete(){return tb(this._delegate)}onSnapshot(...t){const e=I1(t),i=P1(t,r=>new Ml(this.firestore,new Ki(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return v1(this._delegate,e,i)}get(t){let e;return(t==null?void 0:t.source)==="cache"?e=Zk(this._delegate):(t==null?void 0:t.source)==="server"?e=Qk(this._delegate):e=Kk(this._delegate),e.then(i=>new Ml(this.firestore,new Ki(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(t){return new Mn(this.firestore,t?this._delegate.withConverter(qs.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}function Je(n,t,e){return n.message=n.message.replace(t,e),n}function I1(n){for(const t of n)if(typeof t=="object"&&!hm(t))return t;return{}}function P1(n,t){var e,i;let r;return hm(n[0])?r=n[0]:hm(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(t(s))},error:(e=r.error)===null||e===void 0?void 0:e.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}class Ml{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new Mn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return y1(this._delegate,t._delegate)}}class Nl extends Ml{data(t){const e=this._delegate.data(t);return this._delegate._converter||fC(e!==void 0),e}}class Xe{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Xd(t)}where(t,e,i){try{return new Xe(this.firestore,mr(this._delegate,Fk(t,e,i)))}catch(r){throw Je(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new Xe(this.firestore,mr(this._delegate,Bk(t,e)))}catch(i){throw Je(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new Xe(this.firestore,mr(this._delegate,zk(t)))}catch(e){throw Je(e,"limit()","Query.limit()")}}limitToLast(t){try{return new Xe(this.firestore,mr(this._delegate,Uk(t)))}catch(e){throw Je(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new Xe(this.firestore,mr(this._delegate,jk(...t)))}catch(e){throw Je(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new Xe(this.firestore,mr(this._delegate,$k(...t)))}catch(e){throw Je(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new Xe(this.firestore,mr(this._delegate,qk(...t)))}catch(e){throw Je(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new Xe(this.firestore,mr(this._delegate,Gk(...t)))}catch(e){throw Je(e,"endAt()","Query.endAt()")}}isEqual(t){return s1(this._delegate,t._delegate)}get(t){let e;return(t==null?void 0:t.source)==="cache"?e=Xk(this._delegate):(t==null?void 0:t.source)==="server"?e=Jk(this._delegate):e=Yk(this._delegate),e.then(i=>new dm(this.firestore,new Wr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...t){const e=I1(t),i=P1(t,r=>new dm(this.firestore,new Wr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return v1(this._delegate,e,i)}withConverter(t){return new Xe(this.firestore,t?this._delegate.withConverter(qs.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}class gb{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new Nl(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class dm{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new Xe(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new Nl(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(e=>new gb(this._firestore,e))}forEach(t,e){this._delegate.forEach(i=>{t.call(e,new Nl(this._firestore,i))})}isEqual(t){return y1(this._delegate,t._delegate)}}class wa extends Xe{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const t=this._delegate.parent;return t?new Mn(this.firestore,t):null}doc(t){try{return t===void 0?new Mn(this.firestore,hd(this._delegate)):new Mn(this.firestore,hd(this._delegate,t))}catch(e){throw Je(e,"doc()","CollectionReference.doc()")}}add(t){return eb(this._delegate,t).then(e=>new Mn(this.firestore,e))}isEqual(t){return r1(this._delegate,t._delegate)}withConverter(t){return new wa(this.firestore,t?this._delegate.withConverter(qs.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}function As(n){return kt(n,ne)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(...t){this._delegate=new Gr(...t)}static documentId(){return new mg(Zt.keyField().canonicalString())}isEqual(t){return t=ye(t),t instanceof Gr?this._delegate._internalPath.isEqual(t._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(t){this._delegate=t}static serverTimestamp(){const t=ub();return t._methodName="FieldValue.serverTimestamp",new Es(t)}static delete(){const t=ab();return t._methodName="FieldValue.delete",new Es(t)}static arrayUnion(...t){const e=lb(...t);return e._methodName="FieldValue.arrayUnion",new Es(e)}static arrayRemove(...t){const e=cb(...t);return e._methodName="FieldValue.arrayRemove",new Es(e)}static increment(t){const e=hb(t);return e._methodName="FieldValue.increment",new Es(e)}isEqual(t){return this._delegate.isEqual(t._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb={Firestore:w1,GeoPoint:$d,Timestamp:Yt,Blob:Vl,Transaction:E1,WriteBatch:T1,DocumentReference:Mn,DocumentSnapshot:Ml,Query:Xe,QueryDocumentSnapshot:Nl,QuerySnapshot:dm,CollectionReference:wa,FieldPath:mg,FieldValue:Es,setLogLevel:_b,CACHE_SIZE_UNLIMITED:Pk};function vb(n,t){n.INTERNAL.registerComponent(new Ms("firestore-compat",e=>{const i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(i,r)},"PUBLIC").setServiceProps(Object.assign({},yb)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(n){vb(n,(t,e)=>new w1(t,e,new mb)),n.registerVersion(db,fb)}wb(El);const Eb={apiKey:"AIzaSyAg-VG3laAp8kvel5mC9Q_kWhLv6xvFTPY",authDomain:"bench-rating.firebaseapp.com",projectId:"bench-rating",storageBucket:"bench-rating.firebasestorage.app",messagingSenderId:"601862513386",appId:"1:601862513386:web:485fa761244ea436a4ad93"};El.apps.length||El.initializeApp(Eb);const vw=El.firestore(),ww=["comfort","ambience","view"],Tb=()=>{const n=Vi.useRef(null),t=Vi.useRef(null);Vi.useState("");const[e,i]=Vi.useState(!0),r=Vi.useRef(new Set);Vi.useEffect(()=>{n.current||(n.current=Jc.map("map",{maxBounds:[[48.5,-11],[61.5,4]],maxBoundsViscosity:1}).setView([54.5,-3],6),Jc.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://carto.com/">CARTO</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',maxZoom:19}).addTo(n.current),t.current=Jc.markerClusterGroup({spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,maxClusterRadius:40}),n.current.addLayer(t.current),n.current.on("moveend",()=>{w()}),w(),setTimeout(()=>i(!1),2500))},[]);function s(E){return String(E).replace(/\//g,"_")}function a(E){try{return localStorage.getItem(E)}catch{return null}}function l(E,x){try{localStorage.setItem(E,x)}catch{}}function h(E,x){return`benchRatedNum_${E}_${x}`}function f(E,x,R){R&&(R.innerHTML='<span class="spinner"></span>',vw.collection("benchRatings").doc(E).get().then(z=>{let A=0,S=0;if(z.exists&&z.data()[x]){const C=z.data()[x];A=C.total/C.count,S=C.count}R.innerHTML=S>0?`Avg: ${A.toFixed(2)} (${S})`:"No ratings yet"}))}function _(E,x,R,z,A){const S=parseInt(R.value,10);if(isNaN(S)||S<1||S>5){R.style.border="2px solid #e74c3c",setTimeout(()=>{R.style.border=""},1400);return}if(a(h(E,x)))return;z.disabled=!0,R.disabled=!0,z.innerHTML='<span class="spinner"></span>';const C=vw.collection("benchRatings").doc(E);C.get().then(j=>{let H={};if(j.exists){const k=j.data()[x]||{total:0,count:0};H[x]={total:k.total+S,count:k.count+1}}else H[x]={total:S,count:1};C.set(H,{merge:!0}).then(()=>{l(h(E,x),"1"),z.innerHTML="Submitted",f(E,x,document.getElementById(`avg-${x}-${E}`)),A&&(A.classList.remove("hidden"),setTimeout(()=>A.classList.add("hidden"),1800))})})}function g(E,x){const z=["material","colour","seats","backrest"].filter(C=>E[C]).map(C=>`<span>${C.charAt(0).toUpperCase()+C.slice(1)}: ${E[C]}</span>`).join(""),A="Bench";let S=ww.map(C=>{const j=h(x,C),H=!!a(j);return`
        <div class="rating-row">
          <label for="input-${C}-${x}">${C.charAt(0).toUpperCase()+C.slice(1)}</label>
          <input class="rating-input" id="input-${C}-${x}" type="number" min="1" max="5" ${H?"disabled":""} />
          <button class="rating-btn" id="btn-${C}-${x}" data-bench="${x}" data-cat="${C}" ${H?"disabled":""}>Submit</button>
          <span class="avg-pill" id="avg-${C}-${x}"></span>
        </div>
      `}).join("");return`
      <div class="bench-popup">
        <div class="bench-title" id="bench-title-${x}">${A}</div>
        <div class="bench-details">${z}</div>
        <div class="rating-instructions">Rate this bench <b>15</b></div>
        ${S}
        <div id="thanks-${x}" class="thanks-message hidden" aria-live="polite">Thanks for rating!</div>
      </div>
    `}function w(){if(!n.current||!t.current)return;const E=n.current.getBounds(),x=10,R=10,z=48.5,A=61.5,S=-11,C=4,j=(A-z)/x,H=(C-S)/R;let Y=Math.floor((E.getSouth()-z)/j),k=Math.floor((E.getNorth()-z)/j),P=Math.floor((E.getWest()-S)/H),b=Math.floor((E.getEast()-S)/H);Y=Math.max(0,Y),k=Math.min(x-1,k),P=Math.max(0,P),b=Math.min(R-1,b);for(let V=Y;V<=k;V++)for(let N=P;N<=b;N++){const O=`data/tile_${V}_${N}.geojson`;r.current.has(O)||(r.current.add(O),fetch(O).then(D=>D.ok?D.json():Promise.reject(D.status)).then(D=>{D.features.forEach(Ft=>{if(!Ft.geometry||!Ft.geometry.coordinates)return;const[An,re]=Ft.geometry.coordinates,Se=Ft.properties||{},W=s(Se.id||`${V}_${N}_${re}_${An}`),lt=Jc.marker([re,An]);t.current.addLayer(lt),lt.bindPopup(g(Se,W),{maxWidth:320}),lt.on("popupopen",()=>{ww.forEach(J=>{const ct=document.getElementById(`btn-${J}-${W}`),dt=document.getElementById(`input-${J}-${W}`),vt=document.getElementById(`thanks-${W}`);ct&&dt&&(ct.onclick=()=>_(W,J,dt,ct,vt)),f(W,J,document.getElementById(`avg-${J}-${W}`))})})})}).catch(D=>{console.error("Error loading tile",O,D)}))}}return Ni.jsxs(Ni.Fragment,{children:[e&&Ni.jsx("div",{className:"loading-overlay",children:"Loading benches"}),Ni.jsx("div",{id:"map",style:{height:"600px",width:"100%"}})]})};function Ib(){return Ni.jsxs("div",{className:"app-container",children:[Ni.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Bench Rating Map"}),Ni.jsx(Tb,{})]})}Wf.createRoot(document.getElementById("root")).render(Ni.jsx(dP.StrictMode,{children:Ni.jsx(Ib,{})}));
